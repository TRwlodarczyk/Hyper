# Project A
{
  library(ggplot2)
  library(ggpubr)
  library(dplyr)
  library(data.table)
  library(reshape2)
  library(reshape)
  library("readxl")
  library(ggpubr)
  library(agricolae)
  library(tidyverse)
  library (readr) #to read URL
  library(stringr) # For str_replace_all
  library(psych)
  library(car)
  library(openxlsx)
  
}

setwd("C:/Users/twlodarczyk/OneDrive - University of Arizona/Desktop/All documents/1 PhD/CNRS + Synch/Hyperspectral Research/1_Experiment/2_Experiment_A/PLS")
dt <-read.delim("Project_A_PLS.txt")



columns_to_remove <- c("X1599", "X1600", "X1739", "X1601", "X1373", "X1738", "X1602", "X665", 
                       "X1603", "X1605", "X1737", "X1604", "X1606", "X1736", "X1607", "X1608", 
                       "X1735", "X1609", "X664", "X686", "X1611", "X1610", "X1372", "X1612", 
                       "X1613", "X1734", "X1614", "X1615", "X1733", "X1616", "X1732", "X663", 
                       "X1617", "X1731", "X1618", "X1371", "X1619", "X1620", "X1730", "X1621", 
                       "X1623", "X1622", "X1729", "X1624", "X1625", "X1626", "X662", "X1728", 
                       "X1726", "X1627", "X1727", "X1370", "X1725", "X1724", "X1628", "X1633", 
                       "X1631", "X1629", "X687", "X1632", "X1723", "X1630", "X1634", "X1635", 
                       "X1636", "X1722", "X1641", "X1642", "X1639", "X1640", "X1369", "X1643", 
                       "X1637", "X1638", "X661", "X1653", "X1652", "X1644", "X1721", "X1651", 
                       "X1654", "X1645", "X1646", "X1655", "X1650", "X1649", "X1720", "X1647", 
                       "X1648", "X1656", "X1718", "X1719", "X1659", "X1660", "X1717", "X1658", 
                       "X1657", "X1661", "X1716", "X1715", "X1667", "X1368", "X1666", "X1714", 
                       "X1668", "X1665", "X1662", "X1713", "X1669", "X1664", "X1712", "X1663", 
                       "X1670", "X1671", "X1672", "X660", "X1676", "X1673", "X1674", "X1711", 
                       "X1675", "X1677", "X1678", "X1710", "X1679", "X1367", "X1709", "X1684", 
                       "X1683", "X1682", "X1685", "X1680", "X1703", "X1681", "X1686", "X1702", 
                       "X1707", "X1706", "X1701", "X1687", "X1704", "X1705", "X1700", "X1708", 
                       "X1688", "X1689", "X659", "X1690", "X1699", "X1691", "X1697", "X1698", 
                       "X1692", "X1696", "X688", "X1693", "X1366", "X1694", "X1695", "X658", 
                       "X1365", "X1364", "X657", "X1363", "X1362", "X656", "X1361", "X655", 
                       "X1360", "X654", "X689", "X1359", "X653", "X405", "X1358", "X1357", 
                       "X652", "X1356", "X1355", "X651", "X1354", "X1353", "X650", "X1352", 
                       "X1351", "X1350", "X649", "X1349", "X424", "X404", "X690", "X425", 
                       "X1348", "X409", "X406", "X1347", "X648", "X1346", "X1345", "X426", 
                       "X1344", "X401", "X420", "X647", "X403", "X1343", "X414", "X402", 
                       "X1342", "X419", "X1341", "X415", "X408", "X413", "X423", "X1340", 
                       "X646", "X1339", "X400", "X1338", "X1337", "X421", "X410", "X427", 
                       "X1336", "X429", "X430", "X691", "X645", "X1335", "X1334", "X416", 
                       "X422", "X407", "X1333", "X1332", "X644", "X1331", "X418")

dt <- dt[, !(colnames(dt) %in% columns_to_remove)]



#write.xlsx(dt, "Project_A_PLS-R2.xlsx")





columns_to_remove <- c("X1772", "X1557", "X1771", "X1558", "X1770", "X1769", "X1767", "X1559", 
                       "X1768", "X1766", "X1380", "X1560", "X1561", "X1765", "X1562", "X1764", 
                       "X1563", "X1564", "X1763", "X1565", "X1762", "X1566", "X1379", "X1761", 
                       "X1567", "X1760", "X1568", "X1569", "X1759", "X1570", "X1758", "X1378", 
                       "X1571", "X1572", "X1757", "X1573", "X1756", "X1574", "X1755", "X1575", 
                       "X1754", "X1576", "X1753", "X1377", "X1577", "X1752", "X1578", "X1751", 
                       "X679", "X676", "X1579", "X678", "X677", "X680", "X675", "X674", "X1580", 
                       "X1750", "X1581", "X673", "X681", "X1582", "X1749", "X1376", "X1583", 
                       "X672", "X682", "X1584", "X1748", "X671", "X1585", "X1586", "X1747", 
                       "X670", "X1587", "X683", "X1588", "X1589", "X669", "X1375", "X1590", 
                       "X1746", "X1591", "X668", "X684", "X1592", "X1745", "X1744", "X1593", 
                       "X1743", "X1594", "X667", "X1742", "X1374", "X1595", "X1741", "X1596", 
                       "X685", "X666", "X1597", "X1740", "X1598", "X1330", "X438", "X1329", 
                       "X439", "X428", "X442", "X417", "X1328", "X437", "X440", "X443", "X643", 
                       "X1327", "X433", "X441", "X432", "X434", "X412", "X448", "X1326", "X431", 
                       "X436", "X435", "X1325", "X1324", "X444", "X445", "X447", "X1323", "X642", 
                       "X1322", "X446", "X1321", "X1320", "X692", "X1319", "X1318", "X641", 
                       "X1317", "X449", "X452", "X1316", "X453", "X1315", "X1314", "X1313", 
                       "X467", "X466", "X1312", "X451", "X1311", "X454", "X640", "X1310", "X458", 
                       "X450", "X1309", "X1308", "X455", "X1307", "X1306", "X465", "X1305", 
                       "X1304", "X459", "X411", "X639", "X1303", "X1302", "X468", "X1301", 
                       "X1300", "X471", "X474", "X464", "X477", "X473", "X1299", "X456", "X470", 
                       "X469", "X457", "X1298", "X463", "X472", "X1297", "X1296", "X478", 
                       "X476", "X1295", "X1294", "X638", "X1293", "X1292", "X475", "X1291", 
                       "X484", "X1290", "X485", "X1163", "X1165", "X1164", "X1162", "X1289", 
                       "X1166", "X1161", "X1160", "X481", "X1159", "X1167", "X1288", "X1168", 
                       "X1158", "X1169", "X1287", "X1171", "X1170", "X1285", "X1157", "X1172", 
                       "X1286", "X1284", "X1156", "X1173", "X483", "X1174", "X1155", "X479", 
                       "X1283", "X462", "X1175", "X480", "X1282", "X637", "X1154", "X1281", 
                       "X1178", "X1176", "X1180", "X1179", "X1177", "X1181", "X1280", "X1153", 
                       "X482", "X1279", "X1278", "X1277", "X1182", "X460", "X1276", "X1152", 
                       "X1183", "X1184", "X1275", "X1185", "X1274", "X1186", "X1151", "X1187", 
                       "X1188", "X1189", "X1190", "X1191", "X1273", "X1192", "X1193", "X693", 
                       "X1272", "X1271", "X1194", "X1150", "X1270", "X1197", "X1195", "X1198", 
                       "X486", "X1199", "X1196", "X1200", "X1149", "X1269", "X1201", "X1203", 
                       "X1205", "X1202", "X1204", "X636", "X1268", "X1206", "X1267", "X1260", 
                       "X1259", "X1256", "X1261", "X1262", "X1255", "X1207", "X1258", "X1257", 
                       "X1263", "X1266", "X1148", "X1264", "X1254", "X1265", "X1250", "X1208", 
                       "X1253", "X1249", "X1252", "X1251", "X1246", "X1248", "X1245", "X1247", 
                       "X1209", "X1244", "X1216", "X1215", "X1224", "X1243", "X1217", "X1214", 
                       "X1225", "X1236", "X1213", "X1233", "X1210", "X1237", "X1232", "X488", 
                       "X1238", "X1235", "X1239", "X1234", "X1223", "X1211", "X1222", "X1231", 
                       "X1240", "X1218", "X1212", "X1230", "X1242", "X1219", "X1221", "X1226", 
                       "X1229", "X1220", "X1228", "X1241", "X1227", "X1147", "X635", "X487", 
                       "X1146", "X1145", "X1144", "X634", "X489")

# Remove specified columns from the dataset
dt <- dt[, !(colnames(dt) %in% columns_to_remove)]



#write.xlsx(dt, "Project_A_PLS-R3.xlsx")






columns_to_remove <- c("X1796", "X1540", "X1795", "X1794", "X1541", "X1793", "X1792", "X1542", 
                       "X1791", "X1790", "X1788", "X1543", "X1789", "X1787", "X1383", "X1786", 
                       "X1544", "X1785", "X1784", "X1545", "X1783", "X1546", "X1782", "X1781", 
                       "X1547", "X1780", "X1548", "X1779", "X1549", "X1778", "X1382", "X1550", 
                       "X1777", "X1551", "X1776", "X1552", "X1775", "X1553", "X1774", "X1554", 
                       "X1555", "X1773", "X1381", "X1556", "X1143", "X1142", "X490", "X491", 
                       "X461", "X1141", "X633", "X492", "X1140", "X1139", "X632", "X1138", 
                       "X631", "X1137", "X1136", "X630", "X1135", "X629", "X1134", "X1133", 
                       "X628", "X1132", "X493", "X1131", "X627", "X1130", "X1129", "X1128", 
                       "X1127", "X1126", "X626", "X1125", "X1124", "X1123", "X1001", "X972", 
                       "X975", "X1002", "X1122", "X625", "X1003", "X974", "X971", "X1121", 
                       "X1120", "X978", "X967", "X1004", "X964", "X973", "X1119", "X983", 
                       "X968", "X966", "X970", "X1118", "X977", "X963", "X965", "X961", 
                       "X969", "X1117", "X979", "X984", "X495", "X962", "X1111", "X982", 
                       "X1005", "X1010", "X1110", "X1112", "X985", "X986", "X987", "X976", 
                       "X1008", "X1116", "X960", "X1011", "X1113", "X1009", "X1114", "X1007", 
                       "X1115", "X980", "X494", "X1013", "X981", "X1012", "X1006", "X1109", 
                       "X1014", "X1015", "X959", "X1016", "X988", "X1108", "X1017", "X994", 
                       "X496", "X1018", "X958", "X1107", "X624", "X1105", "X1104", "X1106", 
                       "X1103", "X989", "X1019", "X1097", "X1096", "X1102", "X995", "X993", 
                       "X996", "X1026", "X957", "X997", "X991", "X1020", "X1095", "X1025", 
                       "X1098", "X990", "X1099", "X1101", "X1100", "X1027", "X992", "X956", 
                       "X1024", "X1094", "X1023", "X1028", "X1021", "X998", "X1022", "X1093", 
                       "X1029", "X1090", "X955", "X1092", "X1089", "X1091", "X1000", "X999", 
                       "X1084", "X1034", "X1088", "X1030", "X1035", "X1083", "X1087", "X1032", 
                       "X1033", "X1086", "X1031", "X1036", "X1085", "X954", "X1075", "X1037", 
                       "X1068", "X1069", "X1067", "X1074", "X1076", "X1066", "X1073", "X1044", 
                       "X1072", "X1052", "X1051", "X623", "X953", "X1082", "X1038", "X1063", 
                       "X1053", "X1043", "X1054", "X1042", "X1062", "X1077", "X1045", "X1041", 
                       "X1039", "X1046", "X1081", "X1055", "X1070", "X1065", "X1050", "X1071", 
                       "X1061")

# Remove specified columns from the dataset
dt <- dt[, !(colnames(dt) %in% columns_to_remove)]




#write.xlsx(dt, "Project_A_PLS-R4.xlsx")



columns_to_remove <- c("X1823", "X1829", "X1828", "X1488", "X1827", "X1826", "X1489", 
                       "X1825", "X1822", "X1490", "X1491", "X1391", "X1821", "X1815", 
                       "X1492", "X1816", "X1817", "X1814", "X1812", "X1813", "X1820", 
                       "X1819", "X1493", "X1818", "X1494", "X1811", "X1810", "X1809", 
                       "X1495", "X1806", "X1808", "X1496", "X1805", "X1497", "X1807", 
                       "X1390", "X1498", "X1499", "X1804", "X1500", "X1801", "X1803", 
                       "X1501", "X1802", "X1502", "X1389", "X1503", "X1504", "X1505", 
                       "X1506", "X1507", "X1508", "X1509", "X1388", "X1510", "X1511", 
                       "X1512", "X1513", "X1514", "X1515", "X1516", "X1387", "X1517", 
                       "X1518", "X1519", "X1520", "X1521", "X1522", "X1386", "X1523", 
                       "X1524", "X1525", "X1526", "X1527", "X1528", "X1529", "X1385", 
                       "X1530", "X1531", "X1532", "X1533", "X1534", "X1535", "X1536", 
                       "X1384", "X1537", "X1800", "X1799", "X1798", "X1538", "X1797", 
                       "X1539", "X1048", "X1047", "X1064", "X1049", "X1078", "X1056", 
                       "X1040", "X1060", "X1057", "X1080", "X952", "X1059", "X1058", 
                       "X1079", "X694", "X951", "X622", "X950", "X497", "X949", "X948", 
                       "X947", "X946", "X945", "X944", "X621", "X943", "X942", "X941", 
                       "X940", "X939", "X938", "X937", "X936", "X935", "X934", "X933", 
                       "X931", "X932", "X930", "X620", "X929", "X498", "X928", "X927", 
                       "X926", "X924", "X925", "X923", "X922", "X619", "X921", "X911", 
                       "X912", "X920", "X918", "X909", "X908", "X919", "X914", "X913", 
                       "X910", "X901", "X915", "X900", "X902", "X899", "X907", "X917", 
                       "X903", "X916", "X889", "X904", "X906", "X905", "X898", "X890", 
                       "X894", "X895", "X893", "X888", "X886", "X891", "X887", "X897", 
                       "X896", "X883", "X892", "X884", "X882", "X881", "X885", "X880", 
                       "X875", "X876", "X874", "X878", "X879", "X877", "X867", "X868", 
                       "X866", "X873", "X871", "X869", "X870", "X865", "X872", "X863", 
                       "X864", "X862", "X857", "X858", "X859", "X860", "X856", "X861", 
                       "X618", "X855", "X854", "X850", "X853", "X851", "X852", "X849", 
                       "X848", "X847", "X846", "X845", "X844", "X843", "X840", "X839", 
                       "X842", "X841", "X838", "X836", "X837", "X835", "X833", "X834", 
                       "X832", "X830", "X831", "X769", "X768", "X829", "X770", "X773", 
                       "X772", "X767", "X771", "X774", "X499", "X776", "X775", "X766", 
                       "X828", "X777", "X765", "X778", "X764", "X779", "X763", "X827", 
                       "X780", "X762", "X781", "X826", "X823", "X782", "X824", "X785", 
                       "X820", "X825", "X791", "X792", "X819", "X786", "X784", "X783", 
                       "X822", "X821", "X818", "X790", "X793", "X817", "X816", "X761", 
                       "X801", "X787", "X802", "X794", "X800", "X789", "X815", "X788", 
                       "X795", "X805", "X799", "X803", "X804", "X617", "X806", "X813", 
                       "X814", "X810", "X811")

# Remove specified columns from the dataset
dt <- dt[, !(colnames(dt) %in% columns_to_remove)]



#write.xlsx(dt, "Project_A_PLS-R5.xlsx")





# List of columns to remove
columns_to_remove <- c("X1914", "X1469", "X1468", "X1952", "X1470", "X1843", "X1471", "X1951", 
                       "X1915", "X1472", "X1948", "X1947", "X1473", "X1950", "X1842", "X1949", 
                       "X1394", "X1916", "X1946", "X1474", "X1841", "X1945", "X1840", "X1839", 
                       "X1475", "X1917", "X1476", "X1925", "X1838", "X1918", "X1477", "X1924", 
                       "X1926", "X1919", "X1920", "X1921", "X1927", "X1922", "X1923", "X1928", 
                       "X1944", "X1941", "X1478", "X1934", "X1943", "X1929", "X1935", "X1942", 
                       "X1940", "X1933", "X1393", "X1930", "X1479", "X1837", "X1937", "X1931", 
                       "X1936", "X1480", "X1932", "X1938", "X1939", "X1836", "X1481", "X1482", 
                       "X1483", "X1484", "X1835", "X1833", "X1831", "X1392", "X1834", "X1485", 
                       "X1832", "X1830", "X1486", "X1824", "X1487", "X796", "X812", "X798", 
                       "X797", "X809", "X807", "X760", "X808", "X759", "X758", "X757", "X756", 
                       "X755", "X754", "X616", "X753", "X752", "X751", "X500", "X615", "X750", 
                       "X749", "X614", "X748", "X695", "X747", "X501", "X613", "X746", "X745", 
                       "X612", "X744", "X611", "X502", "X743", "X610", "X742", "X609", "X741", 
                       "X503", "X608", "X740", "X607", "X739", "X606", "X504", "X738", "X605", 
                       "X696", "X737", "X604", "X736", "X505", "X603", "X602", "X735", "X506", 
                       "X601", "X734", "X733")

# Remove the columns from the dataset
dt <- dt %>% select(-all_of(columns_to_remove))




#write.xlsx(dt, "Project_A_PLS-R6.xlsx")




# List of columns to remove
columns_to_remove <- c("X2109", "X2201", "X2199", "X2161", "X2111", "X2416", "X1860", "X2205", 
                       "X2110", "X2191", "X2200", "X2045", "X2175", "X2173", "X1423", "X2165", 
                       "X1898", "X2107", "X2113", "X2117", "X2056", "X2126", "X2174", "X2190", 
                       "X2134", "X2164", "X2116", "X2189", "X1405", "X2176", "X2046", "X2115", 
                       "X2101", "X2104", "X2204", "X2160", "X2154", "X2127", "X2102", "X2055", 
                       "X2169", "X2044", "X2188", "X1424", "X2145", "X2172", "X2162", "X2100", 
                       "X2057", "X2114", "X2168", "X2123", "X2149", "X2092", "X2071", "X2103", 
                       "X2446", "X2128", "X2158", "X2099", "X2171", "X2150", "X2187", "X2163", 
                       "X2118", "X1425", "X2153", "X1404", "X2155", "X2081", "X2030", "X2043", 
                       "X2042", "X2070", "X2170", "X2148", "X2122", "X2082", "X1899", "X2029", 
                       "X2159", "X2147", "X2093", "X2053", "X2146", "X2054", "X2129", "X2038", 
                       "X2080", "X2133", "X2152", "X2119", "X2186", "X2031", "X2121", "X2091", 
                       "X2049", "X1426", "X2065", "X2064", "X2026", "X2090", "X2060", "X2151", 
                       "X2039", "X2415", "X2079", "X2028", "X2185", "X2073", "X2027", "X2050", 
                       "X2061", "X2166", "X2083", "X1858", "X2120", "X2132", "X2098", "X1859", 
                       "X2058", "X1857", "X2084", "X2025", "X2157", "X2177", "X2063", "X2034", 
                       "X2041", "X2077", "X2131", "X2072", "X2037", "X2078", "X2062", "X2032", 
                       "X2035", "X2074", "X2033", "X2130", "X2052", "X2167", "X1427", "X2089", 
                       "X2076", "X2085", "X2040", "X2036", "X2059", "X2075", "X1403", "X2018", 
                       "X2181", "X2184", "X2068", "X1428", "X2069", "X2086", "X2088", "X2182", 
                       "X2178", "X2156", "X2087", "X2051", "X2019", "X2179", "X2017", "X2180", 
                       "X1429", "X2067", "X2183", "X2066", "X2047", "X1430", "X2024", "X2023", 
                       "X2048", "X2020", "X1856", "X2022", "X1431", "X2097", "X2021", "X1432", 
                       "X2094", "X2096", "X2016", "X1402", "X1900", "X1433", "X2095", "X2015", 
                       "X2010", "X2011", "X2014", "X1855", "X1434", "X2004", "X2013", "X2003", 
                       "X2002", "X2430", "X2005", "X2012", "X2009", "X2001", "X1435", "X1901", 
                       "X1997", "X1401", "X1998", "X2006", "X2008", "X1436", "X2007", "X1996", 
                       "X2447", "X1854", "X1437", "X1999", "X2000", "X1995", "X1438", "X1902", 
                       "X1400", "X1439", "X1992", "X1440", "X1989", "X1991", "X1988", "X1994", 
                       "X1441", "X1993", "X1442", "X1853", "X1990", "X1987", "X1399", "X1985", 
                       "X1903", "X1443", "X1986", "X1984", "X1983", "X1982", "X1444", "X1981", 
                       "X1980", "X1445", "X1904", "X1976", "X1905", "X1446", "X1398", "X1447", 
                       "X1975", "X1979", "X1852", "X1977", "X1448", "X1978", "X1449", "X1906", 
                       "X1450", "X1969", "X1974", "X1970", "X1973", "X1451", "X1851", "X1972", 
                       "X1452", "X1453", "X1850", "X1397", "X1454", "X1971", "X1907", "X1455", 
                       "X1968", "X1456", "X1849", "X1457", "X1967", "X1908", "X1458", "X1966", 
                       "X1848", "X1909", "X1459", "X1460", "X1396", "X1461", "X1910", "X1847", 
                       "X1462", "X1463", "X1912", "X1965", "X1911", "X1464", "X1963", "X1961", 
                       "X1964", "X1960", "X1962", "X1846", "X1959", "X1958", "X1465", "X1913", 
                       "X1845", "X1957", "X1466", "X1956", "X1395", "X1954", "X1955", "X1467", 
                       "X1844", "X1953", "X507", "X600", "X697", "X599", "X732", "X508", "X598", 
                       "X731", "X597", "X596", "X509", "X595")

# Remove the columns from the dataset
dt <- dt %>% select(-all_of(columns_to_remove))



#write.xlsx(dt, "Project_A_PLS-R7.xlsx")



# List of columns to remove
columns_to_remove <- c("X2275", "X2235", "X1869", "X1868", "X2273", "X2388", "X2433", "X2387", 
                       "X2274", "X1891", "X2444", "X1867", "X2234", "X2402", "X2233", "X2230", 
                       "X2435", "X2232", "X1892", "X2229", "X2231", "X2401", "X2226", "X2228", 
                       "X2443", "X2227", "X2225", "X2219", "X1866", "X2436", "X2418", "X2220", 
                       "X1893", "X2218", "X1865", "X2213", "X2222", "X2221", "X1864", "X2217", 
                       "X2214", "X2224", "X2216", "X2215", "X1894", "X2223", "X2212", "X2209", 
                       "X1863", "X2441", "X2445", "X2137", "X2138", "X2417", "X1895", "X2210", 
                       "X2208", "X1414", "X2211", "X2427", "X1413", "X1415", "X2140", "X1412", 
                       "X1411", "X2139", "X1862", "X1410", "X1861", "X2207", "X1896", "X2206", 
                       "X2136", "X1416", "X2141", "X1417", "X1409", "X2202", "X2448", "X1418", 
                       "X1408", "X2203", "X2196", "X2197", "X1419", "X1420", "X2143", "X2428", 
                       "X2125", "X2142", "X1407", "X2124", "X2144", "X1421", "X2195", "X2194", 
                       "X2193", "X1897", "X2135", "X2442", "X2105", "X2198", "X2106", "X2112", 
                       "X2429", "X1422", "X2192", "X2108", "X1406", "X730", "X594", "X729", 
                       "X698", "X510", "X590", "X589", "X591", "X588", "X593", "X728", "X587", 
                       "X592", "X586", "X585", "X511", "X584", "X727", "X583", "X512", "X582", 
                       "X581", "X580", "X726", "X699", "X579", "X578")

# Remove the columns from the dataset
dt <- dt %>% select(-all_of(columns_to_remove))



#write.xlsx(dt, "Project_A_PLS-R8.xlsx")




# List of columns to remove
columns_to_remove <- c("X2373", "X2371", "X2307", "X2384", "X2393", "X2251", "X2355", "X2254", 
                       "X2255", "X2333", "X2301", "X2316", "X1884", "X1874", "X2263", "X2247", 
                       "X2438", "X2376", "X2395", "X2298", "X2334", "X2331", "X2394", "X2297", 
                       "X2315", "X2256", "X2286", "X2392", "X2246", "X2411", "X2314", "X2262", 
                       "X2250", "X1885", "X2363", "X1873", "X2412", "X2404", "X2296", "X2264", 
                       "X2285", "X2335", "X2265", "X2287", "X2295", "X2386", "X2391", "X2364", 
                       "X2432", "X2385", "X1886", "X2362", "X2257", "X2269", "X2244", "X2288", 
                       "X2367", "X2434", "X2382", "X2381", "X1872", "X2245", "X2300", "X2294", 
                       "X2240", "X2339", "X1887", "X2369", "X2437", "X2299", "X2293", "X2258", 
                       "X2368", "X2289", "X1871", "X2259", "X2424", "X2292", "X2290", "X2403", 
                       "X2291", "X2241", "X2248", "X2239", "X1888", "X2284", "X2338", "X2279", 
                       "X2270", "X2249", "X2280", "X2361", "X2268", "X2243", "X2271", "X2266", 
                       "X2423", "X2283", "X2336", "X2421", "X2282", "X2449", "X2337", "X1870", 
                       "X2272", "X2414", "X2370", "X2267", "X1889", "X2238", "X2422", "X2431", 
                       "X2281", "X2278", "X2242", "X2236", "X2260", "X2261", "X2277", "X2237", 
                       "X2276", "X1890", "X513", "X725", "X577", "X514", "X576")

# Remove the columns from the dataset
dt <- dt %>% select(-all_of(columns_to_remove))




#write.xlsx(dt, "Project_A_PLS-R9.xlsx")



# List of columns to remove
columns_to_remove <- c("X2345", "X2348", "X2349", "X2407", "X2360", "X2344", "X2358", 
                       "X2321", "X2450", "X2341", "X2366", "X2380", "X2357", "X1880", 
                       "X2305", "X1881", "X1879", "X2320", "X2399", "X2329", "X2372", 
                       "X2383", "X1878", "X2365", "X2390", "X2397", "X2343", "X2304", 
                       "X2410", "X2356", "X2389", "X2342", "X2398", "X2340", "X1882", 
                       "X2252", "X2308", "X2303", "X2309", "X1877", "X2253", "X2375", 
                       "X2396", "X2312", "X2317", "X1883", "X2313", "X1875", "X2413", 
                       "X2310", "X1876", "X2440", "X2302", "X2332", "X2306", "X2330", 
                       "X2400", "X2311", "X724", "X575", "X515")

# Remove the columns from the dataset
dt <- dt %>% select(-all_of(columns_to_remove))




#write.xlsx(dt, "Project_A_PLS-R10.xlsx")










######
######
#### Checking best dataset for normalized index and R squared with Zn


dt <-read.delim("Project_A_PLS-R9.txt")

colnames(dt[37])



###### NORMALIZED INDEX##########
relevant_columns <- names(dt)[37:210]


calculate_index <- function(col1, col2) {
  (dt[[col1]] - dt[[col2]]) / (dt[[col1]] + dt[[col2]])
}

results <- data.frame(Index = character(), R_squared = numeric(), stringsAsFactors = FALSE)


for (i in 1:(length(relevant_columns) - 1)) {
  for (j in (i + 1):length(relevant_columns)) {
    col1 <- relevant_columns[i]
    col2 <- relevant_columns[j]
    new_col_name <- paste(col1, col2, sep = "_")
    dt[[new_col_name]] <- calculate_index(col1, col2)
    
    # Calculate the R-squared value
    model <- lm(dt[[new_col_name]] ~ dt$Zn, data = dt)
    r_squared <- summary(model)$r.squared
    
    # Add the result to the results dataframe
    results <- rbind(results, data.frame(Index = new_col_name, R_squared = r_squared))
  }
}

# View the results dataframe
print(results)

write.xlsx(results, "Project_A_PLS-R9-normalized_index.xlsx")





###### DIFFERENCE INDEX##########
relevant_columns <- names(dt)[37:210]


calculate_index <- function(col1, col2) {
  (dt[[col1]] - dt[[col2]])
}

results <- data.frame(Index = character(), R_squared = numeric(), stringsAsFactors = FALSE)


for (i in 1:(length(relevant_columns) - 1)) {
  for (j in (i + 1):length(relevant_columns)) {
    col1 <- relevant_columns[i]
    col2 <- relevant_columns[j]
    new_col_name <- paste(col1, col2, sep = "_")
    dt[[new_col_name]] <- calculate_index(col1, col2)
    
    # Calculate the R-squared value
    model <- lm(dt[[new_col_name]] ~ dt$Zn, data = dt)
    r_squared <- summary(model)$r.squared
    
    # Add the result to the results dataframe
    results <- rbind(results, data.frame(Index = new_col_name, R_squared = r_squared))
  }
}

# View the results dataframe
print(results)

write.xlsx(results, "Project_A_PLS-R9-difference_index.xlsx")




###### Ratio INDEX##########
relevant_columns <- names(dt)[37:210]


calculate_index <- function(col1, col2) {
  (dt[[col1]]/dt[[col2]])
}

results <- data.frame(Index = character(), R_squared = numeric(), stringsAsFactors = FALSE)


for (i in 1:(length(relevant_columns) - 1)) {
  for (j in (i + 1):length(relevant_columns)) {
    col1 <- relevant_columns[i]
    col2 <- relevant_columns[j]
    new_col_name <- paste(col1, col2, sep = "_")
    dt[[new_col_name]] <- calculate_index(col1, col2)
    
    # Calculate the R-squared value
    model <- lm(dt[[new_col_name]] ~ dt$Zn, data = dt)
    r_squared <- summary(model)$r.squared
    
    # Add the result to the results dataframe
    results <- rbind(results, data.frame(Index = new_col_name, R_squared = r_squared))
  }
}

# View the results dataframe
print(results)

write.xlsx(results, "Project_A_PLS-R9-ratio_index.xlsx")




###

model <- lm(dt$X700 ~ dt$Zn, data = dt)
summary(model) # R-sq = 0.156


model <- lm(dt$X2420 ~ dt$Zn, data = dt)
summary(model) # R-sq = 0.177


dt <- dt %>%
  mutate(VI700_2420 = (X700)/(X2420))

model <- lm(dt$VI700_2420 ~ dt$Zn, data = dt)
summary(model) # R-sq = 0.399


ggplot(dt, aes(x = VI700_2420, y = Zn, color=Treatment)) + 
  geom_point(size=3) +  # adds the scatter plot points
  theme_minimal() + 
  labs(title = "ddd",
       x = "VI700_2420",
       y = "Zn")



dt <- dt %>%
  mutate(VI701_X2347 = (X701)-(X2347))

model <- lm(dt$VI701_X2347 ~ dt$Zn, data = dt)
summary(model) # R-sq = 0.3492


ggplot(dt, aes(x = Zn, y = VI701_X2347, color=Treatment)) + 
  geom_point(size=3) +  # adds the scatter plot points
  theme_minimal() + 
  labs(title = "ddd",
       x = "Zn",
       y = "VI701_X2347")




dt <-read.delim("Project_A_PLS.txt")

dt <- dt %>%
  mutate(VI494_X517 = ((X497)-(X517))/((X497)+(X517)))

model <- lm(dt$VI494_X517 ~ dt$Zn, data = dt)
summary(model) # R-sq = 0.181


ggplot(dt, aes(x = Zn, y = VI494_X517, color=Treatment)) + 
  geom_point(size=3) +  # adds the scatter plot points
  theme_minimal() + 
  labs(title = "ddd",
       x = "Zn",
       y = "VI494_X517")



