
#libraries
{
  library(ggplot2)
  library(ggpubr)
  library(dplyr)
  library(data.table)
  library(reshape2)
  library(reshape)
  library("readxl")
  library(ggpubr)
  library(agricolae)
  library(tidyverse)
  library (readr) #to read URL
  library(stringr) # For str_replace_all
  library(psych)
  library(car)
  library(openxlsx)
  
}

setwd("C:/Users/twlodarczyk/OneDrive - University of Arizona/Desktop/All documents/1 PhD/CNRS + Synch/Hyperspectral Research/1_Experiment/1_Experiment_P/Spreadsheet/PLS")
dt <-read.delim("Project_P_pXRF_HP_Hyper.txt")

dt <- dt %>% 
  filter(Hyperspectral_measured == "Yes" &
           Leaf_Type == "pxrf")




#PLS- ALL
{

#PLS-R
columns_to_remove <- c(
  "X2189", "X1697", "X1645", "X2326", "X1472", "X485", "X1345", "X1384", "X786", "X1473",
  "X1644", "X1297", "X2266", "X2099", "X1474", "X785", "X1711", "X1346", "X1383", "X1698",
  "X2325", "X2188", "X1643", "X784", "X1347", "X1475", "X1348", "X1710", "X1382", "X1476",
  "X1349", "X783", "X1296", "X2100", "X1699", "X1642", "X1350", "X1381", "X1477", "X2187",
  "X1086", "X1085", "X2324", "X1709", "X1084", "X2267", "X1351", "X1093", "X1700", "X1083",
  "X1089", "X1478", "X1090", "X1087", "X1092", "X782", "X1091", "X1094", "X1088", "X1380",
  "X1095", "X1641", "X1096", "X1097", "X1082", "X2101", "X1479", "X1352", "X1295", "X1708",
  "X1701", "X1379", "X1081", "X1098", "X2323", "X1480", "X781", "X1099", "X2186", "X1080",
  "X1100", "X1640", "X1353", "X1702", "X1378", "X1079", "X1101", "X1481", "X1294", "X1707",
  "X2102", "X1354"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(columns_to_remove))

#write.xlsx(dt, "Project_P_PLS-R.xlsx")




#PLS-R2

# Vector of columns to remove with "X" prefix
columns_to_remove <- c(
  "X2335", "X2090", "X974", "X1435", "X1327", "X827", "X1662", "X1436", "X1689", "X1397",
  "X1308", "X1782", "X1328", "X975", "X1437", "X1661", "X2198", "X1438", "X1329", "X826",
  "X1396", "X1781", "X1660", "X1439", "X2091", "X979", "X1307", "X1728", "X1729", "X2334",
  "X1727", "X1780", "X1440", "X1730", "X825", "X1659", "X1330", "X1690", "X978", "X1441",
  "X2261", "X1779", "X976", "X1722", "X1395", "X1658", "X1726", "X824", "X1724", "X1331",
  "X1778", "X1723", "X1306", "X1721", "X1442", "X1725", "X977", "X1733", "X2197", "X1443",
  "X980", "X1731", "X1332", "X2333", "X2092", "X981", "X1657", "X1735", "X982", "X1777",
  "X1734", "X1720", "X1732", "X1444", "X823", "X1776", "X1394", "X1445", "X1736", "X1333",
  "X1691", "X1305", "X1446", "X2332", "X1719", "X1656", "X1447", "X1448", "X983", "X2093",
  "X1334", "X1449", "X2196", "X1304", "X1393", "X1775", "X822", "X1451", "X1655", "X1450",
  "X1737", "X1718", "X1452", "X1692", "X2094", "X1453", "X1774", "X1335", "X1654", "X1454",
  "X1392", "X821", "X2262", "X1738", "X1773", "X1303", "X2329", "X1455", "X1717", "X2331",
  "X984", "X2195", "X1456", "X1336", "X1772", "X1653", "X1458", "X820", "X1739", "X1771",
  "X1457", "X819", "X1693", "X2095", "X1459", "X1391", "X1770", "X987", "X1716", "X1652",
  "X985", "X2328", "X1460", "X986", "X1337", "X1740", "X988", "X1302", "X2194", "X2330",
  "X1769", "X1461", "X818", "X1390", "X1651", "X1462", "X1741", "X2193", "X1768", "X1715",
  "X1694", "X989", "X1338", "X1463", "X816", "X2263", "X1464", "X1767", "X817", "X1301",
  "X1742", "X1765", "X1766", "X1389", "X2096", "X2192", "X1764", "X990", "X1763", "X1339",
  "X1650", "X991", "X1465", "X1714", "X815", "X1762", "X1466", "X994", "X1695", "X2264",
  "X1388", "X1743", "X2191", "X1467", "X1761", "X1340", "X1747", "X814", "X1300", "X1649",
  "X1748", "X1744", "X1760", "X1749", "X2097", "X995", "X1468", "X1745", "X813", "X1746",
  "X1759", "X1713", "X1750", "X1387", "X992", "X993", "X2327", "X1751", "X1758", "X1752",
  "X1341", "X1753", "X996", "X2190", "X1469", "X1757", "X1754", "X799", "X1755", "X1756",
  "X1648", "X798", "X1696", "X800", "X801", "X792", "X810", "X795", "X797", "X794", "X796",
  "X1470", "X793", "X809", "X802", "X1386", "X997", "X812", "X1342", "X1299", "X808", "X811",
  "X2098", "X791", "X805", "X804", "X2265", "X1647", "X807", "X1471", "X789", "X790", "X803",
  "X1646", "X998", "X806", "X1712", "X999", "X1343", "X1385", "X788", "X1344", "X1000", "X1298",
  "X787", "X2322", "X1703", "X1482", "X2185", "X1639", "X1706", "X1377", "X1704", "X1705",
  "X2103", "X1638", "X1483", "X1376", "X1355", "X1078", "X780", "X1102", "X2268", "X1077",
  "X1375", "X1356", "X2184", "X1103", "X2321", "X1484", "X1637", "X1076", "X2104", "X1374",
  "X1293", "X1104", "X1357", "X1485", "X1075", "X1373", "X2183", "X2320", "X779", "X1105",
  "X1636", "X1074", "X2105", "X1106", "X1486", "X1358", "X1372", "X2182", "X486", "X1073",
  "X1487", "X2319", "X1371", "X1107", "X1359", "X1292", "X1635", "X1360", "X1370", "X1488",
  "X1108", "X1072", "X1361", "X1369", "X1363", "X2318", "X2181", "X1364", "X1362", "X2317",
  "X1368", "X1366", "X1365", "X1367", "X1489", "X778", "X2106", "X1109", "X2302", "X2269",
  "X2303", "X1634", "X1291", "X1490", "X2301", "X1071", "X2180", "X1110", "X2316", "X2304",
  "X1491", "X2107", "X1633", "X1070", "X1290", "X1111", "X1492", "X2179", "X1069", "X2270",
  "X777", "X1493", "X2300", "X1067", "X1112", "X1632", "X1068", "X1001", "X2108", "X2178",
  "X1289", "X1494", "X1113", "X1066", "X2305", "X2299", "X2307", "X1495", "X1114", "X2306",
  "X1002", "X1631", "X1004", "X1003", "X2177", "X2310", "X1115", "X2315", "X1496", "X1005",
  "X1288", "X1006", "X2109", "X2311", "X1007", "X2308", "X2176", "X1497", "X1116", "X2309",
  "X1630", "X2298", "X1065", "X2314", "X2296", "X1008", "X1498", "X2313", "X776", "X2271",
  "X2297", "X1009", "X1010", "X1287", "X2175", "X1117", "X1629", "X2110", "X2312", "X1011",
  "X1064", "X1012", "X1499", "X2273", "X2111", "X2295", "X1013", "X1063", "X1015", "X1118",
  "X1014", "X1500", "X1628", "X1286", "X1016", "X2272", "X1062", "X1501", "X2174", "X1119",
  "X2112", "X1061", "X1060"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(columns_to_remove))

#write.xlsx(dt, "Project_P_PLS-R2.xlsx")





# Load necessary libraries
library(dplyr)

# Vector of columns to remove with "X" prefix
columns_to_remove <- c(
  "X1907", "X1969", "X1970", "X1906", "X1971", "X1972", "X450", "X1905", "X1973", "X1974",
  "X415", "X1975", "X1904", "X1976", "X1977", "X414", "X1978", "X1979", "X1903", "X1980",
  "X1981", "X1982", "X1983", "X1902", "X1984", "X451", "X1985", "X1986", "X1901", "X413",
  "X1987", "X1988", "X1989", "X1900", "X1990", "X410", "X1991", "X1992", "X452", "X1993",
  "X1899", "X1994", "X409", "X1995", "X1996", "X412", "X1997", "X1898", "X453", "X1998",
  "X1999", "X2000", "X2001", "X1897", "X2002", "X411", "X2003", "X2004", "X454", "X2005",
  "X2006", "X1896", "X2007", "X407", "X2008", "X2009", "X455", "X2010", "X408", "X1895",
  "X2011", "X2012", "X406", "X2013", "X456", "X2014", "X1894", "X2015", "X457", "X2449",
  "X2016", "X2448", "X2017", "X2446", "X2447", "X2018", "X2445", "X2440", "X1893", "X2019",
  "X2441", "X2443", "X2439", "X2444", "X458", "X2442", "X2020", "X2021", "X2438", "X2022",
  "X2436", "X2437", "X459", "X2023", "X1892", "X2024", "X2435", "X2025", "X2429", "X2432",
  "X2430", "X460", "X2026", "X2431", "X405", "X2433", "X2027", "X2426", "X1891", "X461",
  "X2425", "X2028", "X2424", "X2434", "X2428", "X2423", "X462", "X2029", "X2427", "X2030",
  "X1890", "X463", "X2031", "X472", "X2032", "X2033", "X2422", "X2034", "X464", "X1889",
  "X2035", "X401", "X468", "X471", "X2421", "X2414", "X473", "X2036", "X2415", "X2416",
  "X2413", "X2420", "X467", "X469", "X465", "X2417", "X2037", "X470", "X2419", "X2418",
  "X1888", "X466", "X2038", "X402", "X2410", "X2412", "X2404", "X2409", "X2403", "X2039",
  "X2411", "X2408", "X2407", "X2406", "X2040", "X2405", "X2402", "X2041", "X1887", "X2400",
  "X2401", "X475", "X2042", "X474", "X2399", "X2043", "X1886", "X2044", "X2398", "X404",
  "X403", "X2045", "X2397", "X863", "X864", "X868", "X867", "X862", "X2396", "X861", "X866",
  "X865", "X869", "X1885", "X2046", "X860", "X476", "X870", "X858", "X859", "X872", "X871",
  "X857", "X2394", "X873", "X856", "X2393", "X874", "X2395", "X855", "X2047", "X875", "X853",
  "X854", "X852", "X876", "X878", "X879", "X877", "X880", "X851", "X850", "X881", "X2392",
  "X2048", "X849", "X2390", "X848", "X847", "X882", "X883", "X884", "X2391", "X1884", "X885",
  "X2389", "X886", "X887", "X846", "X888", "X2049", "X845", "X889", "X844", "X843", "X2050",
  "X890", "X842", "X891", "X841", "X1883", "X892", "X840", "X2388", "X2051", "X893", "X839",
  "X896", "X894", "X477", "X895", "X2386", "X2387", "X897", "X838", "X2384", "X1882", "X2385",
  "X898", "X837", "X2052", "X899", "X900", "X2383", "X836", "X901", "X400", "X902", "X478",
  "X903", "X835", "X2053", "X1881", "X834", "X904", "X907", "X906", "X905", "X908", "X909",
  "X2054", "X833", "X910", "X2380", "X2382", "X832", "X912", "X911", "X913", "X831", "X1880",
  "X830", "X2379", "X915", "X916", "X829", "X2381", "X479", "X914", "X2055", "X917", "X918",
  "X828", "X919", "X920", "X1879", "X2056", "X922", "X921", "X923", "X2378", "X924", "X480",
  "X925", "X926", "X2377", "X2057", "X927", "X1878", "X928", "X2058", "X929", "X481", "X930",
  "X932", "X931", "X2376", "X933", "X2059", "X1877", "X934", "X2373", "X1876", "X937", "X936",
  "X935", "X1875", "X2060", "X938", "X2375", "X1874", "X2374", "X939", "X1873", "X942", "X2061",
  "X941", "X940", "X1872", "X943", "X947", "X2372", "X944", "X945", "X2062", "X946", "X1871",
  "X948", "X1870", "X2063", "X949", "X1869", "X950", "X1868", "X951", "X1867", "X1866", "X952",
  "X2369", "X2370", "X953", "X1865", "X956", "X2064", "X957", "X954", "X1864", "X955", "X2371",
  "X958", "X1863", "X2367", "X2368", "X959", "X962", "X2065", "X1862", "X960", "X961", "X2366",
  "X963", "X1861", "X2066", "X1860", "X965", "X484", "X964", "X1859", "X1858", "X966", "X1857",
  "X967", "X482", "X968", "X969", "X1856", "X2067", "X483", "X970", "X971", "X2365", "X972",
  "X1855", "X2363", "X2068", "X2364", "X2362", "X973", "X1854", "X2069", "X1853", "X1852",
  "X1851", "X1850", "X2361", "X2070", "X1849", "X2359", "X775", "X2360", "X1848", "X2071",
  "X1847", "X2358", "X2072", "X774", "X1846", "X1845", "X2073", "X1844", "X1843", "X2357",
  "X1842", "X2074", "X1841", "X773", "X2356", "X1840", "X2355", "X2075", "X1839", "X2354",
  "X1838", "X772", "X2076", "X1837", "X2077", "X2353", "X1836", "X1835", "X2241", "X2240",
  "X2352", "X2078", "X1834", "X2351", "X1833", "X2246", "X771", "X2242", "X2243", "X2239",
  "X2244", "X2247", "X2245", "X2350", "X1832", "X2079", "X2248", "X1831", "X2238", "X2349",
  "X2237", "X2249", "X2234", "X1830", "X2080", "X2348", "X2233", "X2236", "X770", "X1829",
  "X2235", "X2347", "X2250", "X1828", "X2081", "X2252", "X2251", "X2230", "X2232", "X1827",
  "X2228", "X2231", "X2229", "X2227", "X2346", "X1826", "X2253", "X2082", "X1825", "X2226",
  "X2224", "X1824", "X2223", "X2254", "X2225", "X2345", "X2222", "X1823", "X769", "X2221",
  "X2344", "X2083", "X1822", "X2343", "X2255", "X1821", "X2220", "X1819", "X1820", "X1818",
  "X2084", "X2219", "X1817", "X2218", "X2342", "X1816", "X2085", "X1815", "X2217", "X1059",
  "X2256", "X1311", "X1312", "X2216", "X1310", "X2341", "X1814", "X1309", "X1058", "X768",
  "X1313", "X2215", "X1813", "X1314", "X1413", "X1315", "X1412", "X2086", "X1416", "X1411",
  "X1417", "X1415", "X1414", "X1316", "X1418", "X2214", "X1812", "X1410", "X1057", "X2213",
  "X1317", "X1419", "X1409", "X2340", "X1318", "X1408", "X1056", "X1811", "X2212", "X1319",
  "X1420", "X1407", "X1810", "X2087", "X1055", "X2257", "X2339", "X1320", "X1421", "X2211",
  "X1809", "X1406", "X2088", "X1054", "X1120", "X1321", "X1422", "X2210", "X1808", "X1405",
  "X1053", "X1423", "X1322", "X1121", "X1807", "X1052", "X2209", "X1424", "X1800", "X1404",
  "X2338", "X1425", "X1017", "X1051", "X1122", "X2208", "X1806", "X1403", "X1799", "X1323",
  "X1018", "X1426", "X2207", "X2089", "X1022", "X2258", "X1021", "X1427", "X1050", "X1019",
  "X1402", "X1023", "X1020", "X1123", "X1798", "X1428", "X1805", "X1024", "X2337", "X1324",
  "X1049", "X1025", "X1037", "X487", "X1038", "X1028", "X1039", "X767", "X2206", "X1036",
  "X1029", "X1429", "X1401", "X1048", "X1027", "X1797", "X1124", "X1046", "X1026", "X1325",
  "X1047", "X1045", "X1030", "X1042", "X1040", "X1043", "X1031", "X1044", "X1804", "X1035",
  "X1430", "X2336", "X1032", "X1034", "X1041", "X1400", "X1033", "X1431", "X1326", "X1796",
  "X1803", "X1125", "X1432", "X2259", "X1399", "X1433", "X2205", "X1795", "X1802", "X1126",
  "X1434", "X2204", "X1801", "X1794", "X1398", "X2203", "X1127", "X2201", "X2202", "X1793",
  "X1128", "X2200", "X1792", "X1129", "X2260", "X1791", "X2199", "X1130", "X1790", "X1131",
  "X1789", "X766", "X1788", "X1132", "X1787", "X1676", "X1677", "X1675", "X1674", "X1678",
  "X1133", "X1673", "X1679", "X1786", "X1672", "X1671", "X1680", "X1670", "X1681", "X1785",
  "X1134", "X1682", "X1669", "X1683", "X1668", "X1784", "X1135", "X1684", "X1667", "X1685",
  "X1783", "X1666", "X1136", "X1686", "X1665", "X765", "X1137", "X1664", "X1687", "X1663",
  "X1138", "X1688", "X1139", "X1140", "X488", "X1141", "X1285", "X1142", "X1284", "X1143",
  "X1283", "X1144", "X1282", "X764", "X1145", "X1281", "X1280", "X1146", "X1279", "X1278",
  "X1147", "X1277", "X1148", "X1276", "X1275", "X1149", "X1274", "X1273", "X1272"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(columns_to_remove))

# View the updated dataframe
glimpse(dt)

#write.xlsx(dt, "Project_P_PLS-R3.xlsx")




# Load necessary libraries
library(dplyr)

# Vector of columns to remove with "X" prefix
columns_to_remove <- c(
  "X1920", "X1946", "X1919", "X1947", "X1948", "X1918", "X425", "X421", "X1949", "X1917",
  "X420", "X1950", "X1916", "X1915", "X1951", "X1952", "X1953", "X1954", "X1955", "X1914",
  "X1956", "X448", "X1913", "X1957", "X419", "X1912", "X1958", "X1959", "X1911", "X1960",
  "X1961", "X1962", "X1910", "X417", "X1963", "X449", "X1909", "X1964", "X1965", "X1908",
  "X1966", "X416", "X418", "X1967", "X1968", "X1150", "X1271", "X1270", "X1151", "X1269",
  "X1268", "X1152", "X1267", "X1266", "X1265", "X1153", "X1264", "X1263", "X1262", "X1154",
  "X489", "X1261", "X1260", "X1155", "X763", "X1259", "X1156", "X1258", "X1157", "X1257",
  "X1158", "X1159", "X1256", "X1160", "X1255", "X1254", "X2113", "X1161", "X1253", "X1162",
  "X2294", "X1252", "X2274", "X1502", "X2114", "X1163", "X1251", "X2293", "X1250", "X1503",
  "X1164", "X1249", "X1504", "X1165", "X2115", "X1248", "X2173", "X2292", "X1505", "X1247",
  "X1166", "X2172", "X2290", "X1246", "X2275", "X1167", "X2291", "X1506", "X2116", "X2289",
  "X1507", "X1245", "X2171", "X2281", "X1508", "X1168", "X2288", "X2276", "X2280", "X2282",
  "X1244", "X2117", "X1509", "X2279", "X2170", "X1169", "X1243", "X2118", "X2287", "X1510",
  "X2277", "X2169", "X1511", "X2283", "X2278", "X2119", "X1242", "X2120", "X1170", "X2284",
  "X1512", "X762", "X2121", "X1513", "X2168", "X1241", "X2286", "X1171", "X2285", "X1514",
  "X2122", "X1240", "X1515", "X1172", "X2123", "X1516", "X2167", "X1239", "X1517", "X1173",
  "X2124", "X1518", "X1238", "X2166", "X1174", "X1519", "X490", "X1237", "X2125", "X2165",
  "X1520", "X1236", "X1175", "X2163", "X2164", "X1521", "X1627", "X1235", "X2162", "X2126",
  "X1522", "X1176", "X1234", "X1626", "X1523", "X2127", "X2161", "X1524", "X2160", "X1233",
  "X2130", "X2159", "X1525", "X1177", "X1625", "X2131", "X2128", "X2132", "X1526", "X2158",
  "X2133", "X1232", "X2129", "X2134", "X1624", "X1527", "X2157", "X1178", "X2156", "X2135",
  "X1231", "X1528", "X2155", "X1623", "X1529", "X2136", "X1179", "X2154", "X1230", "X1530",
  "X2137", "X2153", "X2152", "X1229", "X2138", "X2151", "X1531", "X1180", "X1622", "X2150",
  "X1532", "X1228", "X2139", "X2147", "X2146", "X2148", "X2149", "X2145", "X2143", "X1533",
  "X2144", "X1621", "X1181", "X2140", "X2142", "X2141", "X1227", "X1534", "X1535", "X1620",
  "X761", "X1536", "X1182", "X1226", "X1537", "X1619", "X1538", "X1183", "X1225", "X1539",
  "X1618", "X1540", "X1224", "X1184", "X1617", "X1541", "X1542", "X1223", "X1185", "X1616",
  "X1543", "X1222", "X1544", "X1186", "X1615", "X1545", "X1221", "X1546", "X1614", "X1187",
  "X1547", "X1220", "X1548", "X1613", "X1188", "X1549", "X1219", "X1550", "X1612", "X1189",
  "X1218", "X1551", "X1217", "X1552", "X1611", "X1190", "X1216", "X1553", "X1610", "X1215",
  "X1191", "X1554", "X1192", "X1214", "X1555", "X1609", "X1193", "X1213", "X1556", "X1212",
  "X1194", "X1211", "X1608", "X1195", "X1557", "X1210", "X1209", "X1196", "X1558", "X1607",
  "X760", "X1559", "X1208", "X1197", "X1207", "X1560", "X1606", "X1206", "X1198", "X1199",
  "X1205", "X1200", "X1561", "X1204", "X1203", "X1201", "X1202", "X491", "X1605", "X1562",
  "X1604", "X1563", "X1603", "X1564", "X1602", "X1565", "X1601", "X1566", "X1600", "X1567",
  "X1599", "X1568", "X1569", "X1598", "X1570", "X1597", "X1571", "X1572", "X1596", "X1573",
  "X1574", "X1595", "X1575", "X1594", "X1576", "X1593", "X1592", "X1577", "X1591", "X1590",
  "X1578", "X1589", "X1588", "X1587", "X1579", "X1581", "X1582", "X1584", "X1583", "X1580",
  "X1586", "X1585", "X759", "X758", "X492", "X757", "X493", "X756", "X494", "X755", "X754",
  "X672", "X671", "X673", "X670", "X674", "X495", "X669", "X753", "X675", "X668", "X676",
  "X752", "X667", "X496", "X677", "X751", "X666", "X678", "X497", "X750", "X665", "X679",
  "X498", "X664"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(columns_to_remove))

# View the updated dataframe
glimpse(dt)

#write.xlsx(dt, "Project_P_PLS-R4.xlsx")




# Load necessary libraries
library(dplyr)

# Vector of columns to remove with "X" prefix
columns_to_remove <- c(
  "X1933", "X1931", "X1935", "X1928", "X1927", "X1930", "X1926", "X1929", "X447", "X1936",
  "X1925", "X1924", "X1937", "X1938", "X1940", "X1939", "X1923", "X1941", "X1942", "X1922",
  "X1943", "X1921", "X1944", "X1945", "X435", "X436", "X441", "X440", "X438", "X439", "X437",
  "X442", "X434", "X433", "X443", "X432", "X430", "X431", "X429", "X444", "X427", "X423", 
  "X428", "X424", "X445", "X446", "X422", "X426", "X1932", "X749", "X680", "X663", "X748", 
  "X499", "X681", "X662", "X747", "X500", "X661", "X682", "X746", "X660", "X501", "X659", 
  "X683", "X745", "X658", "X657", "X502", "X656", "X684", "X744", "X655", "X654", "X653", 
  "X503", "X652", "X743", "X651", "X685", "X650", "X504", "X649", "X742", "X648", "X686", 
  "X505", "X647", "X741", "X646", "X506", "X645", "X687", "X740", "X644", "X507", "X643", 
  "X739", "X688", "X642", "X508", "X641", "X640", "X738", "X509", "X639", "X689", "X638", 
  "X637", "X510", "X636", "X737", "X635", "X634", "X690", "X633", "X632", "X511", "X631", 
  "X630", "X629", "X628", "X627", "X626", "X625", "X736", "X624", "X623", "X622", "X512", 
  "X621", "X691", "X620", "X619", "X618", "X513", "X617", "X1934"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(columns_to_remove))

# View the updated dataframe
glimpse(dt)



#write.xlsx(dt, "Project_P_PLS-R5.xlsx")


#Create index 553 - 735 / 553 + 735

dt <- dt %>%
  mutate(VI553_735 = (X553 - X735) / (X553 + X735))

corr.test(dt$VI553_735, dt$Zn_PXRF_mean)



dt$Measure2 <- factor(dt$Measure2, levels = paste0("T", 0:10))

# Create the plot
ggplot(dt, aes(x = Zn_PXRF_mean, y = VI553_735, color = Measure2)) + 
  geom_point(size=3) +  # adds the scatter plot points
  theme_minimal() + 
  scale_color_manual(values = colorRampPalette(c("lightgrey", "black"))(length(levels(dt$Measure2)))) +
  labs(title = "ddd",
       x = "Zn conc in leaf",
       y = "VI553_735")



# Create the plot
ggplot(dt, aes(x = Zn_PXRF_mean, y = VI553_735, color = Status)) + 
  geom_point(size=3) +  # adds the scatter plot points
  theme_minimal() + 
  labs(title = "ddd",
       x = "Zn conc in leaf",
       y = "VI553_735")

colnames(dt)[149] #here the hyper cols starts 

##


### Compute the indicies nornalized index!




relevant_columns <- names(dt)[149:296]

calculate_index <- function(col1, col2) {
  (dt[[col1]] - dt[[col2]]) / (dt[[col1]] + dt[[col2]])
}


results <- data.frame(Index = character(), R_squared = numeric(), stringsAsFactors = FALSE)


for (i in 1:(length(relevant_columns) - 1)) {
  for (j in (i + 1):length(relevant_columns)) {
    col1 <- relevant_columns[i]
    col2 <- relevant_columns[j]
    new_col_name <- paste(col1, col2, sep = "_")
    dt[[new_col_name]] <- calculate_index(col1, col2)
    

    model <- lm(dt[[new_col_name]] ~ dt$Zn_PXRF_mean, data = dt)
    r_squared <- summary(model)$r.squared
    
    results <- rbind(results, data.frame(Index = new_col_name, R_squared = r_squared))
  }
}

# View the results dataframe
print(results)

write.xlsx(results, "Project_P_R-Squared_from_PLS-bands_normalized_index.xlsx")






relevant_columns <- names(dt)[149:296]

calculate_index <- function(col1, col2) {
  (dt[[col1]] - dt[[col2]]) / (dt[[col1]] + dt[[col2]])
}


results <- data.frame(Index = character(), R_squared = numeric(), stringsAsFactors = FALSE)


for (i in 1:(length(relevant_columns) - 1)) {
  for (j in (i + 1):length(relevant_columns)) {
    col1 <- relevant_columns[i]
    col2 <- relevant_columns[j]
    new_col_name <- paste(col1, col2, sep = "_")
    dt[[new_col_name]] <- calculate_index(col1, col2)
    
    
    model <- lm(dt[[new_col_name]] ~ dt$Zn_PXRF_mean, data = dt)
    r_squared <- summary(model)$r.squared
    
    results <- rbind(results, data.frame(Index = new_col_name, R_squared = r_squared))
  }
}

# View the results dataframe
print(results)

write.xlsx(results, "Project_P_R-Squared_from_PLS-bands_normalized_index.xlsx")






}



#Green onlu
{
##################################
##################################
###### One more time but for Green (G)######
###################################

setwd("C:/Users/twlodarczyk/OneDrive - University of Arizona/Desktop/All documents/1 PhD/CNRS + Synch/Hyperspectral Research/1_Experiment/1_Experiment_P/Spreadsheet/PLS")
dt <-read.delim("Project_P_pXRF_HP_Hyper.txt")

dt <- dt %>% 
  filter(Hyperspectral_measured == "Yes" &
           Leaf_Type == "pxrf")

#PLS-G1

columns_to_remove <- c(
  "X421", "X448", "X411", "X410", "X418", "X413", "X415", "X416", "X447", "X420", "X419", 
  "X427", "X424", "X417", "X422", "X426", "X446", "X423", "X428", "X425", "X414", "X445", 
  "X431", "X429", "X430", "X444", "X438", "X439", "X432", "X443", "X437", "X442", "X440", 
  "X433", "X441", "X436", "X434", "X435"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(columns_to_remove))



write.xlsx(dt, "Project_P_PLS-G-1.xlsx")




#PLS-G-2
# Vector of columns to remove
columns_to_remove <- c(
  "X412", "X449", "X450", "X451", "X401", "X409", "X402", "X404", "X403", "X452", "X453", "X454",
  "X400", "X407", "X455", "X406", "X405", "X456", "X459", "X408", "X460", "X457", "X458", "X461",
  "X464", "X1935", "X1933", "X1934", "X1932", "X1936", "X463", "X1931", "X1926", "X1085", "X1086",
  "X1084", "X469", "X1937", "X1083", "X1087", "X1082", "X1081", "X1080", "X1078", "X1088", "X1079",
  "X1928", "X1927", "X1089", "X1930", "X1925", "X1077", "X1075", "X470", "X1076", "X1090", "X1929",
  "X1074", "X1924", "X1938", "X1091", "X1940", "X1073", "X1939", "X1092", "X462", "X467", "X1941",
  "X1072", "X466", "X1093", "X472", "X1942", "X465", "X1094", "X1922", "X1923", "X1921", "X1095",
  "X1071", "X1096", "X1943", "X1944", "X1920", "X1945", "X1097", "X1070", "X1069", "X473", "X1098",
  "X1068", "X1067", "X468", "X1919", "X1066", "X1099", "X1946", "X1100", "X1947", "X1918", "X1065",
  "X1101", "X471", "X1102", "X1064", "X1103", "X1948", "X1063", "X1917", "X1104", "X1062", "X1105",
  "X1061", "X1060", "X1916", "X1949", "X474", "X1106", "X475", "X1059", "X1950", "X1107", "X1058",
  "X1108", "X1951", "X1915", "X1952", "X1109", "X1057", "X1953", "X1110", "X1056", "X1954", "X476",
  "X1914", "X1111", "X1955", "X1055", "X1112", "X1054", "X1113", "X1913", "X1053", "X1114", "X1956",
  "X1115", "X1052", "X1912", "X1116", "X1051", "X1957", "X1117", "X1958", "X1050", "X1118", "X480",
  "X477", "X481", "X1049", "X1119", "X1048", "X1911", "X1959", "X1047", "X1120", "X1960", "X1046",
  "X1121", "X1045", "X479", "X1961", "X1044", "X1122", "X1910", "X1962", "X1043", "X1039", "X1042",
  "X1040", "X1038", "X1123", "X1041", "X1963", "X1037", "X1036", "X1124", "X1964", "X1035", "X483",
  "X478", "X484", "X1034", "X1125", "X1909", "X1033", "X482", "X1965", "X1032", "X1966", "X1031",
  "X1126", "X1029", "X1030", "X1028", "X1027", "X1026", "X1127", "X1025", "X1967", "X1022", "X1024",
  "X1023", "X1908", "X1021", "X1128", "X1020", "X1019", "X1968", "X1129", "X1018", "X1017", "X1016",
  "X1015", "X1907", "X1130", "X1014", "X1969", "X1013", "X1012", "X1970", "X1010", "X1011", "X1131",
  "X1009", "X485", "X1906", "X1971", "X1008", "X1007", "X1972", "X486", "X1006", "X1132", "X1973",
  "X1004", "X1005", "X1003", "X1001", "X1002", "X1974", "X1133", "X1905", "X487", "X1134", "X1975",
  "X1135", "X1976", "X1904", "X1977", "X1136", "X1978", "X1979", "X1137", "X1980", "X1903", "X488",
  "X1981", "X1138", "X1982", "X1983", "X1139", "X489", "X1984", "X1902", "X1140", "X1985", "X1986",
  "X490", "X1141", "X1987", "X1988", "X1901", "X1142", "X1989", "X1143", "X872", "X1990", "X873",
  "X888", "X491", "X878", "X871", "X884", "X885", "X889", "X880", "X875", "X887", "X870", "X881",
  "X879", "X869", "X886", "X874", "X883", "X877", "X867", "X890", "X868", "X876", "X866", "X882",
  "X897", "X896", "X1144", "X865", "X1900", "X898", "X891", "X895", "X864", "X894", "X899", "X893",
  "X908", "X902", "X907", "X863", "X1991", "X892", "X862", "X903", "X901", "X861", "X906", "X909",
  "X900", "X860", "X1992", "X905", "X918", "X859", "X904", "X919", "X913", "X910", "X917", "X912",
  "X916", "X915", "X914", "X920", "X858", "X1993", "X911", "X1145", "X922", "X921", "X857", "X856",
  "X1994", "X923", "X855", "X926", "X925", "X927", "X854", "X853", "X1995", "X928", "X924", "X1146",
  "X852", "X929", "X1996", "X851", "X1899", "X930", "X850", "X849", "X932", "X931", "X933", "X1147",
  "X1997", "X848", "X847", "X492", "X1998", "X1999", "X934", "X846", "X2000", "X936", "X1148", "X845",
  "X937", "X935", "X844", "X938", "X843", "X939", "X2001", "X940", "X842", "X1149", "X941", "X1898",
  "X841", "X942", "X2002", "X1299", "X1300", "X1298", "X1297", "X840", "X1301", "X1150", "X1296",
  "X943", "X1303", "X1302", "X839", "X944", "X2003", "X1304", "X1295", "X1305", "X1294", "X945",
  "X838", "X2004", "X1293", "X1306", "X493", "X1151", "X1292", "X1307", "X837", "X946", "X2005",
  "X947", "X1291", "X1897", "X836", "X1308", "X1290", "X2006", "X1289", "X1309", "X1152", "X835",
  "X1288", "X948", "X1287", "X1310", "X1286", "X2007", "X834", "X949", "X950", "X1153", "X1285",
  "X1311"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(columns_to_remove))

write.xlsx(dt, "Project_P_PLS-G-2.xlsx")





###
#PLS-G-3

# Vector of columns to remove
columns_to_remove <- c(
  "X833", "X1284", "X1283", "X951", "X1312", "X2008", "X1154", "X1282", "X832", "X1281", 
  "X952", "X1280", "X831", "X1279", "X830", "X1313", "X1277", "X1278", "X1276", "X953", 
  "X1155", "X2009", "X1275", "X829", "X1274", "X1273", "X954", "X1272", "X1271", "X1270", 
  "X1896", "X2010", "X1314", "X1269", "X1265", "X828", "X1264", "X1156", "X1262", "X1263", 
  "X1266", "X1268", "X1267", "X1261", "X955", "X827", "X2011", "X1260", "X494", "X1315", 
  "X1259", "X1157", "X826", "X956", "X957", "X1258", "X825", "X2012", "X1257", "X1158", 
  "X824", "X1256", "X1316", "X997", "X823", "X1255", "X1159", "X958", "X1254", "X822", 
  "X2013", "X1253", "X1252", "X1160", "X1251", "X821", "X996", "X1317", "X962", "X998", 
  "X1250", "X959", "X999", "X820", "X2014", "X1161", "X963", "X1249", "X1248", "X1000", 
  "X1247", "X960", "X1162", "X819", "X1246", "X2015", "X961", "X1163", "X990", "X1318", 
  "X1245", "X818", "X1895", "X964", "X987", "X2016", "X968", "X994", "X967", "X817", 
  "X965", "X966", "X816", "X1244", "X984", "X1164", "X982", "X969", "X991", "X989", 
  "X995", "X975", "X815", "X974", "X1243", "X988", "X972", "X2017", "X985", "X983", 
  "X1242", "X814", "X1165", "X970", "X973", "X986", "X971", "X1241", "X1319", "X1166", 
  "X813", "X981", "X993", "X979", "X1240", "X978", "X1167", "X992", "X812", "X1168", 
  "X2018", "X1169", "X1239", "X811", "X808", "X977", "X976", "X1170", "X799", "X809", 
  "X810", "X807", "X1238", "X800", "X798", "X796", "X795", "X1237", "X805", "X801", 
  "X797", "X1171", "X802", "X794", "X804", "X806", "X1236", "X1320", "X980", "X789", 
  "X790", "X793", "X803", "X1172", "X791", "X1235", "X2019", "X792", "X788", "X1173", 
  "X1234", "X787", "X1233", "X1174", "X2020", "X1321", "X786", "X1232", "X1175", "X785", 
  "X1231", "X784", "X1176", "X2021", "X1894", "X1230", "X783", "X1177", "X1322", "X1229", 
  "X782", "X2022", "X1178", "X2023", "X1228", "X781", "X1227", "X2024", "X1179", "X1226", 
  "X780", "X2025", "X1180", "X1225", "X1224", "X1323", "X1181", "X1223", "X495", "X779", 
  "X1222", "X1182", "X2026", "X1221", "X1183", "X1220", "X1324", "X1219", "X1184", "X778", 
  "X1218", "X1185", "X1186", "X1217", "X2027", "X1893", "X1216", "X1187", "X1215", "X1188", 
  "X1325", "X777", "X1214", "X2028", "X1189", "X1213", "X1212", "X1211", "X1210", "X1209", 
  "X2029", "X1190", "X1192", "X1191", "X1193", "X1208", "X1194", "X1195", "X776", "X1196", 
  "X1207", "X1326", "X1206", "X1197", "X1204", "X2030", "X1203", "X1205", "X1198", "X1202", 
  "X1201", "X1199", "X1200", "X775", "X2449", "X2031", "X1327", "X2032", "X774", "X2033", 
  "X1892", "X1328", "X2034", "X2444", "X773", "X671", "X2443", "X672", "X670", "X2035", 
  "X2036", "X1329", "X2037", "X669", "X2440", "X2038", "X673", "X1330", "X772", "X2439", 
  "X2445", "X2039", "X2441", "X2442", "X2040", "X496", "X1891", "X1331", "X2446", "X771", 
  "X2041", "X2438", "X668", "X1332", "X2042", "X2448", "X2043", "X770", "X2447", "X1333", 
  "X674", "X2044", "X1890", "X2047", "X2437", "X1334", "X2045", "X769", "X2048", "X2046", 
  "X2433", "X667", "X2429", "X2432", "X2436", "X1335", "X2049", "X2435", "X2430", "X2050", 
  "X2434", "X1889", "X2051", "X1336", "X2431", "X768", "X2052", "X1337", "X2053", "X2420", 
  "X2054", "X675", "X2428", "X2427", "X2423", "X2413", "X2422", "X2414", "X1338", "X767", 
  "X2055", "X2421", "X497", "X1888", "X2424", "X666", "X2419", "X2056", "X1339", "X2057", 
  "X2058", "X2426", "X2059", "X1340", "X2425", "X2060", "X766", "X1887", "X1341", "X2061", 
  "X2405", "X676", "X2412", "X2406", "X2062", "X2415", "X2063", "X1342", "X2416", "X1808", 
  "X1807", "X1806", "X2064", "X1886", "X1809", "X1805", "X1810", "X1811", "X1812", "X1813", 
  "X1801", "X1814", "X1343", "X1815", "X1816", "X2065", "X765", "X1817", "X1802", "X1818", 
  "X1821", "X1819", "X1822", "X1804", "X1820", "X2407", "X2400", "X2066", "X1803", "X2411", 
  "X1823", "X2404", "X1830", "X1829", "X1721", "X1824", "X1722", "X1344", "X2399", "X1831", 
  "X1828", "X2067", "X1720", "X1827", "X1723", "X1832", "X1833", "X1834", "X1825", "X1724", 
  "X1885", "X1826", "X1719", "X1835", "X2408", "X665", "X1718", "X1727", "X1725", "X1728", 
  "X1836", "X2068", "X1717", "X1726", "X1729", "X1837", "X1841", "X1838", "X1345", "X2069", 
  "X2417", "X1840", "X1716", "X1839", "X2070", "X2418", "X1842", "X1730", "X1715", "X2403", 
  "X1847", "X1843", "X1848", "X1714", "X2071", "X1731", "X1849", "X1844", "X1845", "X1846", 
  "X1732", "X1713", "X1346", "X1884", "X2072", "X1850", "X1733", "X764"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(columns_to_remove))

write.xlsx(dt, "Project_P_PLS-G-3.xlsx")



#PLS-G-4

# Vector of columns to remove
columns_to_remove <- c(
  "X1851", "X1734", "X1677", "X2402", "X1676", "X2073", "X1678", "X1712", "X1679", "X2401", 
  "X1682", "X1683", "X1680", "X1735", "X1681", "X1684", "X1347", "X1675", "X2398", "X1852", 
  "X2074", "X1685", "X2393", "X1711", "X2394", "X1674", "X1686", "X1673", "X1687", "X1854", 
  "X1688", "X1736", "X1689", "X2410", "X1672", "X1855", "X1853", "X1883", "X1690", "X1856", 
  "X1710", "X1691", "X1671", "X2397", "X1692", "X1737", "X677", "X1670", "X1693", "X1857", 
  "X1348", "X2409", "X1694", "X498", "X2396", "X1669", "X2075", "X1858", "X2077", "X1882", 
  "X1695", "X1709", "X1738", "X1668", "X2392", "X2395", "X2076", "X1667", "X1696", "X1708", 
  "X1859", "X2078", "X1739", "X1349", "X1697", "X1666", "X1860", "X1861", "X1698", "X1862", 
  "X1707", "X1699", "X1740", "X1700", "X2079", "X1881", "X1665", "X1701", "X1863", "X1350", 
  "X1706", "X2080", "X763", "X1741", "X2247", "X1702", "X1864", "X1664", "X1705", "X2246", 
  "X1703", "X2081", "X1704", "X1663", "X2391", "X1865", "X1742", "X1662", "X2082", "X2248", 
  "X2083", "X1661", "X2084", "X2252", "X2249", "X1880", "X1351", "X1866", "X1660", "X1743", 
  "X2253", "X1867", "X1659", "X2250", "X1658", "X1657", "X664", "X2251", "X1868", "X1744", 
  "X2240", "X1656", "X2245", "X2241", "X1879", "X2085", "X1655", "X1869", "X1352", "X2239", 
  "X1745", "X2243", "X2244", "X1654", "X2390", "X2242", "X2086", "X1878", "X2254", "X2087", 
  "X1746", "X1653", "X1870", "X1871", "X2088", "X1652", "X2238", "X1747", "X1877", "X1872", 
  "X2255", "X1875", "X1651", "X1874", "X2256", "X1876", "X1353", "X1748", "X1873", "X2237", 
  "X2089", "X1650", "X1749", "X1649", "X2236", "X1648", "X2389", "X1750", "X2257", "X2235", 
  "X1647", "X762", "X1354", "X1751", "X2090", "X2234", "X1752", "X1646", "X2092", "X2091", 
  "X1753", "X2094", "X1645", "X2383", "X2093", "X2384", "X2233", "X1644", "X1754", "X2095", 
  "X2258", "X1642", "X1643", "X1755", "X1355", "X2385", "X1756", "X1641", "X2382", "X2228", 
  "X2230", "X1757", "X2227", "X2229", "X1758", "X1640", "X1759", "X2232", "X2231", "X2259", 
  "X2378", "X1639", "X2219", "X2386", "X2226", "X2381", "X1356", "X2218", "X2379", "X2220", 
  "X2380", "X1764", "X1760", "X1638", "X2217", "X1762", "X2222", "X2221", "X1761", "X1763", 
  "X2225", "X1765", "X2216", "X2096", "X1637", "X2223", "X1636", "X2224", "X2377", "X2215", 
  "X678", "X1635", "X2098", "X2214", "X2097", "X2099", "X1766", "X2209", "X1634", "X1800", 
  "X2208", "X1798", "X1799", "X1357", "X1797", "X1767", "X2207", "X1770", "X1771", "X1633", 
  "X2213", "X1796", "X2206", "X2210", "X2388", "X2211", "X2203", "X1768", "X1795", "X2212", 
  "X1774", "X2260", "X1772", "X1773", "X2202", "X1769", "X1775", "X1776", "X1784", "X1794", 
  "X1783", "X2100", "X2201", "X1632", "X1793", "X1785", "X2205", "X2200", "X2204", "X2101", 
  "X1786", "X1777", "X1792", "X1782", "X1631", "X1791", "X1781", "X2372", "X1790", "X1787", 
  "X1630", "X1789", "X2102", "X1778", "X1779", "X1780", "X1358", "X1788", "X2199", "X499", 
  "X1629", "X2375", "X2376", "X2373", "X1628", "X2198", "X2261", "X2387", "X1627", "X2197", 
  "X761", "X2103", "X2374", "X2105", "X2363", "X1359", "X1626", "X2104", "X663", "X2196", 
  "X2370", "X1625", "X2371", "X1624", "X2262", "X2369", "X2106", "X2195", "X1623", "X2362", 
  "X1473", "X1472", "X1360", "X1474", "X1471", "X1470", "X1622", "X2194", "X1469", "X1468", 
  "X2366", "X1456", "X1475", "X2263", "X1464", "X1466", "X1457", "X1460", "X1458", "X1467", 
  "X1462", "X1621", "X1461", "X1620", "X2109", "X1455", "X1465", "X1476", "X1481", "X1482", 
  "X2107", "X1463", "X1459", "X2193", "X1454", "X1619", "X1480", "X1477", "X1479", "X1478", 
  "X2108", "X1483", "X1618", "X2110", "X1361", "X1484", "X2192", "X2264", "X1453", "X1617", 
  "X1485", "X1451", "X1452", "X1450", "X1491", "X1487", "X1449", "X1488", "X1486", "X1490", 
  "X2191", "X1489", "X2111", "X1492", "X2266", "X2359", "X1448", "X1493", "X2367", "X1447", 
  "X2368", "X1446", "X1494", "X1362", "X1443", "X1445", "X2265", "X1444", "X1616", "X2360", 
  "X1442", "X2190", "X2267", "X1441", "X2112", "X1495", "X1614", "X1497", "X1440", "X2188", 
  "X1615", "X1496", "X2358", "X1498", "X2361", "X2189", "X2364", "X2365", "X2357", "X1613", 
  "X1439", "X1499", "X1500", "X1501", "X2187", "X1612", "X1438", "X2113", "X1436", "X1435", 
  "X1437", "X1363", "X1502", "X1434", "X1433", "X2182", "X1611", "X1432", "X1503", "X2268", 
  "X1504", "X2181", "X2115", "X1429", "X1431", "X1505", "X2114", "X2116", "X2186", "X1430", 
  "X1428", "X2117", "X1506", "X1507", "X1610", "X2118", "X1508", "X2185", "X1427", "X1364", 
  "X1509", "X1426", "X1513", "X1511", "X1609", "X2119", "X1510", "X2356", "X1512", "X1514", 
  "X1425", "X2180", "X1523", "X1520", "X1521", "X1424", "X1519", "X1522", "X1515", "X1423", 
  "X1524", "X1608", "X1517", "X1516", "X1518", "X2124", "X2183", "X2122", "X2121", "X2184", 
  "X2120", "X1422", "X2179", "X2125", "X1607", "X2269", "X1525", "X2123", "X1526", "X1604", 
  "X1606", "X1421", "X2353", "X1603", "X1605", "X1529", "X1530", "X1531", "X1527", "X2354", 
  "X1365", "X1532", "X1420", "X1528", "X1602", "X1540", "X1541", "X1551", "X1550", "X1539", 
  "X1549", "X1552", "X2178", "X1533", "X1542", "X1548", "X1601", "X1419", "X1538", "X1534", 
  "X1553", "X1547"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(columns_to_remove))

write.xlsx(dt, "Project_P_PLS-G-4.xlsx")



#PLS-G-5



# Vector of columns to remove
columns_to_remove <- c(
  "X2126", "X1537", "X2175", "X1554", "X2176", "X1543", "X1535", "X760", "X1555", "X1536", 
  "X1544", "X1546", "X1545", "X1600", "X2174", "X1418", "X2177", "X1556", "X2355", "X1599", 
  "X1557", "X1598", "X2130", "X2173", "X2127", "X1558", "X1366", "X2131", "X1561", "X1562", 
  "X1597", "X2172", "X1417", "X1563", "X2171", "X1564", "X1559", "X2134", "X1560", "X2170", 
  "X1596", "X2133", "X1565", "X2128", "X2132", "X2270", "X1592", "X1595", "X1591", "X1594", 
  "X1567", "X1566", "X2129", "X2135", "X1416", "X2169", "X1593", "X1568", "X2352", "X1590", 
  "X679", "X1569", "X1571", "X1589", "X1570", "X2136", "X1415", "X2168", "X1573", "X1572", 
  "X1574", "X1588", "X2350", "X1577", "X1578", "X1575", "X1587", "X2163", "X2137", "X1576", 
  "X1367", "X1579", "X1580", "X2351", "X1581", "X1584", "X1582", "X1586", "X1583", "X2162", 
  "X1585", "X1414", "X2165", "X2271", "X2138", "X2167", "X2166", "X2164", "X2347", "X1413", 
  "X2155", "X2154", "X2141", "X2139", "X2142", "X2349", "X2272", "X1412", "X1368", "X2147", 
  "X2140", "X2161", "X2143", "X2148", "X2156", "X2273", "X2346", "X662", "X2157", "X2159", 
  "X2160", "X2158", "X2144", "X2348", "X2150", "X2151", "X2153", "X2149", "X1411", "X2274", 
  "X2152", "X2277", "X2146", "X2275", "X2145", "X2276", "X1369", "X2278", "X1410", "X2281", 
  "X1370", "X1409", "X2279", "X2339", "X2280", "X2282", "X2343", "X2345", "X1371", "X1408", 
  "X2342", "X2338", "X2341", "X2344", "X2340", "X2283", "X2327", "X2284", "X2337", "X2326", 
  "X1407", "X2332", "X2336", "X1372", "X2331", "X2330", "X2333", "X2288", "X2295", "X2296", 
  "X2287", "X2302", "X2335", "X759", "X2328", "X2303", "X2334", "X1373", "X1406", "X2301", 
  "X2289", "X2325", "X2329", "X2324", "X2290", "X2299", "X2304", "X2300", "X2285", "X2294", 
  "X2305", "X2298", "X2297", "X1405", "X1374", "X2306", "X2293", "X2286", "X2291", "X2292", 
  "X1375", "X1404", "X2321", "X2320", "X2323", "X1403", "X1376", "X500", "X2307", "X2317", 
  "X2322", "X2316", "X1402", "X2314", "X2313", "X2310", "X1377", "X2312", "X2315", "X2311", 
  "X2319", "X2308"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(columns_to_remove))


write.xlsx(dt, "Project_P_PLS-G-5.xlsx")




#PLS-G-6

# Vector of columns to remove
columns_to_remove <- c(
  "X2318", "X1401", "X1378", "X1400", "X1399", "X1379", "X1398", "X661", "X1380", "X1397", 
  "X680", "X1381", "X1396", "X1382", "X758", "X1383", "X1395", "X1384", "X1394", "X1393", 
  "X1385", "X1392", "X1386", "X1391", "X1387", "X1390", "X1388", "X660", "X757", "X501", 
  "X681", "X659", "X756", "X658", "X502", "X657", "X755", "X682", "X656", "X655", "X754", 
  "X654", "X503", "X653", "X652", "X683", "X753", "X651", "X650", "X504", "X752", "X684", 
  "X649", "X648", "X505", "X751", "X647", "X685", "X646", "X506", "X750", "X645", "X686", 
  "X644", "X749", "X507", "X643", "X642", "X687", "X748", "X508", "X641", "X640", "X509", 
  "X747", "X688", "X639", "X638", "X510", "X637", "X636", "X746", "X635", "X689", "X634", 
  "X633", "X632", "X631", "X511", "X629", "X630", "X628", "X627", "X626", "X625", "X624", 
  "X623", "X745", "X622", "X690", "X621", "X512", "X620", "X619", "X618", "X617", "X513", 
  "X691", "X616", "X744", "X615", "X614", "X514", "X613", "X612", "X692", "X611", "X610", 
  "X743", "X515", "X609", "X608", "X693", "X607", "X606", "X516", "X605", "X604", "X603", 
  "X602", "X742", "X601", "X600", "X694", "X599", "X598", "X597", "X596", "X595", "X594", 
  "X518", "X593", "X695", "X592", "X591", "X741", "X590", "X589", "X519", "X588", "X696", 
  "X587", "X586", "X520", "X585", "X697", "X584", "X740", "X583", "X521", "X582", "X581", 
  "X698", "X580", "X522", "X579", "X699", "X578", "X523", "X739", "X577", "X700", "X576", 
  "X524", "X575", "X701", "X574", "X525", "X702", "X573", "X738", "X526", "X703", "X572", 
  "X527", "X571", "X704", "X570", "X528", "X705", "X737", "X569", "X706", "X529", "X707", 
  "X568", "X530", "X531", "X708", "X567", "X532", "X709", "X566", "X736", "X533", "X710", 
  "X565", "X534", "X711", "X564", "X535", "X712", "X536", "X563", "X537", "X735", "X713", 
  "X562", "X538", "X539", "X561", "X540", "X714", "X560", "X541", "X542", "X543", "X544", 
  "X559", "X715", "X545", "X558", "X546", "X547", "X557", "X734", "X548", "X556", "X716", 
  "X555", "X549", "X550", "X551", "X554", "X552", "X717", "X718", "X733", "X719", "X720", 
  "X732", "X721", "X722", "X731", "X723", "X730", "X724", "X725", "X729", "X726", "X728"
)


# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(columns_to_remove))

write.xlsx(dt, "Project_P_PLS-G-6.xlsx")






dt <- dt %>%
  mutate(VI727_517 = (X727 - X517) / (X727 + X517))

dt1 <- subset(dt, Status=="G")
corr.test(dt$VI727_517, dt$Zn_PXRF_mean) # -0.54
corr.test(dt1$VI727_517, dt1$Zn_PXRF_mean) # -0.5





dt$Measure2 <- factor(dt$Measure2, levels = paste0("T", 0:10))

# Create the plot
ggplot(dt, aes(x = Zn_PXRF_mean, y = VI727_517, color = Measure2)) + 
  geom_point(size=3) +  # adds the scatter plot points
  theme_minimal() + 
  scale_color_manual(values = colorRampPalette(c("lightgrey", "black"))(length(levels(dt$Measure2)))) +
  labs(title = "ddd",
       x = "Zn conc in leaf",
       y = "VI553_735")

ggplot(dt, aes(x = Zn_PXRF_mean, y = VI727_517, color = Status)) + 
  geom_point(size=3) +  # adds the scatter plot points
  theme_minimal() + 
  labs(title = "ddd",
       x = "Zn conc in leaf",
       y = "VI727_517")


}


#CV 10% only
{
#########
#########
#########
#only 10% CV



setwd("C:/Users/twlodarczyk/OneDrive - University of Arizona/Desktop/All documents/1 PhD/CNRS + Synch/Hyperspectral Research/1_Experiment/1_Experiment_P/Spreadsheet/PLS")
dt <-read.delim("Project_P_pXRF_HP_Hyper_cv10.txt")

dt <- dt %>% 
  filter(Hyperspectral_measured == "Yes" &
           Leaf_Type == "pxrf")



# Vector of columns to remove
columns_to_remove <- c(
  "X1156", "X1157", "X1161", "X1158", "X1689", "X1162", "X1230", "X476", "X1650", "X1163", 
  "X2065", "X1165", "X1229", "X1164", "X1166", "X1344", "X1649", "X1167", "X1690", "X773", 
  "X1228", "X1168", "X2066", "X2367", "X1648", "X2368", "X1227", "X1345", "X1169", "X405", 
  "X403", "X1170", "X1647", "X1691", "X1226", "X1646", "X1171", "X2067", "X1346", "X1172", 
  "X2369", "X1225", "X1173", "X1645", "X1174", "X1886", "X1850", "X1175", "X1849", "X1224", 
  "X1851", "X772", "X1644", "X1347", "X1176", "X2068", "X1848", "X1852", "X1692", "X1223", 
  "X1853", "X1177", "X1847", "X1856", "X1643", "X1843", "X1842", "X1841", "X1854", "X1844", 
  "X1857", "X478", "X404", "X1178", "X1348", "X1840", "X1222", "X1855", "X2372", "X1846", 
  "X1221", "X1179", "X477", "X1845", "X1839", "X1642", "X2069", "X1180", "X1858", "X1220", 
  "X1693", "X1838", "X1181", "X1349", "X1219", "X1837", "X1182", "X1859", "X1218", "X1641", 
  "X1836", "X1885", "X2366", "X1183", "X1217", "X2370", "X2070", "X771", "X1694", "X1350", 
  "X1835", "X1860", "X1184", "X1834", "X1216", "X1640", "X1832", "X1833", "X1831", "X1185", 
  "X1830", "X1215", "X1351", "X1639", "X1695", "X1861", "X2071", "X1829", "X479", "X1884", 
  "X1186", "X1638", "X1214", "X1828", "X1187", "X1188", "X1213", "X1352", "X1862", "X1637", 
  "X1827", "X1696", "X1212", "X1826", "X1189", "X1824", "X1211", "X1825", "X1210", "X1636", 
  "X770", "X1209", "X1863", "X2072", "X1353", "X1190", "X1208", "X1883", "X1823", "X1819", 
  "X2365", "X1818", "X2371", "X1865", "X1821", "X1822", "X1192", "X1207", "X1697", "X1864", 
  "X1191", "X1635", "X1193", "X1206", "X1820", "X1194", "X1720", "X1721", "X2364", "X1205", 
  "X1722", "X1866", "X1817", "X1195", "X2073", "X1719", "X1196", "X1204", "X480", "X1723", 
  "X1203", "X1816", "X1354", "X1200", "X1724", "X1815", "X1199", "X1202", "X1201", "X1197", 
  "X2363", "X1814", "X1718", "X1198", "X1882", "X1725", "X1867", "X1727", "X1634", "X1726", 
  "X1813", "X1698", "X1728", "X1729", "X1717", "X2074", "X1355", "X1812", "X1868", "X1730", 
  "X1633", "X1716", "X769", "X1699", "X1632", "X1881", "X1715", "X2362", "X1869", "X1811", 
  "X2075", "X1714", "X1356", "X1810", "X1631", "X1731", "X1713", "X1809", "X1700", "X1806", 
  "X1732", "X1630", "X1733", "X481", "X1808", "X2076", "X1712", "X1805", "X1807", "X1735", 
  "X1734", "X1870", "X1629", "X1701", "X1357", "X1880", "X2077", "X2359", "X1736", "X1711", 
  "X1872", "X1804", "X1871", "X2358", "X1702", "X2361", "X1628", "X1803", "X2240", "X2241", 
  "X2360", "X1873", "X1710", "X768", "X2078", "X1703", "X1358", "X1879", "X1709", "X1737", 
  "X1627", "X1874", "X1704", "X2357", "X2239", "X1708", "X1875", "X1802", "X1626", "X1705", 
  "X1878", "X1738", "X1359", "X1707", "X1706", "X2242", "X2238", "X2079", "X1876", "X1877", 
  "X1801", "X1739", "X2237", "X1625", "X1800", "X2234", "X1360", "X2243", "X1799", "X1740", 
  "X1624", "X2233", "X2244", "X1798", "X2080", "X1741", "X2236", "X2246", "X2245", "X1361", 
  "X2248", "X1797", "X2235", "X2247", "X1742", "X1623", "X1796", "X2081", "X2230", "X1362", 
  "X767", "X2249", "X1795", "X1743", "X2229", "X1622", "X1363", "X2228", "X1744", "X2222", 
  "X2227", "X482", "X1794", "X2221", "X2356", "X2082", "X1621", "X1745", "X1364", "X1793", 
  "X2232", "X2231", "X1746", "X1747", "X2223", "X1792", "X1620", "X2250", "X2220", "X1790", 
  "X1791", "X1748", "X2224", "X2219", "X1365", "X1789", "X2215", "X1788", "X2216", "X1749", 
  "X1619", "X1787", "X2214", "X1786", "X2251", "X2083", "X2226", "X2252", "X1750", "X1366", 
  "X483", "X2354", "X2218", "X1618", "X1785", "X2225", "X1751", "X2351", "X1752", "X2355", 
  "X2213", "X2217", "X1753", "X2350", "X1367", "X2084", "X2253", "X1617", "X766", "X2212", 
  "X1754", "X1784", "X400", "X1755", "X1616", "X1756", "X1783", "X1368", "X2085", "X2209", 
  "X1757", "X2211", "X2254", "X1758", "X2352", "X484", "X2210", "X1759", "X1615", "X2208", 
  "X2349", "X2207", "X1760", "X1780", "X1762", "X1761", "X1369", "X2353", "X1776", "X1782", 
  "X1779", "X1763", "X1774", "X2086", "X1770", "X1775", "X1777", "X1614", "X1778", "X1781", 
  "X1771", "X1764", "X2348", "X1773", "X1765", "X1769", "X1772", "X1768", "X1766", "X1767", 
  "X2255", "X1370", "X2206", "X1613", "X2087", "X2088", "X2347", "X1371", "X2346", "X1612", 
  "X2345", "X765", "X2089", "X1372", "X2344", "X2256", "X1611", "X2343", "X1373", "X1610", 
  "X2205", "X2201", "X2200", "X1374", "X1609", "X2203", "X2342", "X2204", "X2090", "X2257", 
  "X2202", "X1608", "X2199", "X1375", "X2091", "X1607", "X2198", "X764", "X2341", "X1606", 
  "X1377", "X2258", "X2339", "X2094", "X2196", "X2093", "X1604", "X2340", "X2095", "X1378", 
  "X1603", "X2195", "X2338", "X2096", "X1602", "X2259", "X2194", "X1601", "X1379", "X2097", 
  "X1600", "X2193", "X1599", "X2192"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(columns_to_remove))


write.xlsx(dt, "Project_P_PLS-cv10-2.xlsx")





# Load necessary libraries
library(dplyr)

# Vector of columns to remove
columns_to_remove <- c(
  "X435", "X441", "X436", "X440", "X439", "X437", "X438", "X442", "X434", "X433", "X432", "X443", 
  "X430", "X429", "X431", "X444", "X427", "X428", "X423", "X424", "X420", "X445", "X446", "X422", 
  "X426", "X447", "X421", "X419", "X425", "X1932", "X1934", "X1935", "X1933", "X1930", "X1931", 
  "X1936", "X1937", "X1942", "X1941", "X1929", "X1938", "X1944", "X1940", "X1928", "X1943", "X1939", 
  "X1927", "X1926", "X1945", "X1925", "X448", "X1946", "X1948", "X1947", "X1924", "X1949", "X1923", 
  "X1950", "X1922", "X1921", "X1953", "X1952", "X1951", "X1955", "X1920", "X1954", "X1919", "X1956", 
  "X1918", "X449", "X1957", "X1917", "X417", "X1916", "X1958", "X1959", "X1960", "X1915", "X1961", 
  "X1962", "X1963", "X418", "X1914", "X1964", "X414", "X1913", "X1965", "X450", "X1966", "X1967", 
  "X1968", "X1912", "X1969", "X1970", "X1911", "X1971", "X416", "X1910", "X1972", "X1973", "X1974", 
  "X1909", "X1975", "X1908", "X1977", "X1976", "X1978", "X1979", "X1980", "X1907", "X413", "X415", 
  "X451", "X1981", "X1906", "X1982", "X1983", "X1984", "X1985", "X1905", "X410", "X1986", "X1987", 
  "X1988", "X1904", "X409", "X1989", "X1990", "X1903", "X1991", "X452", "X1992", "X1993", "X412", 
  "X411", "X1994", "X453", "X1902", "X1995", "X1996", "X454", "X1997", "X1999", "X1998", "X1901", 
  "X2000", "X408", "X2001", "X2447", "X2002", "X2003", "X1900", "X2004", "X2005", "X2006", "X2007", 
  "X455", "X2446", "X2449", "X2008", "X2448", "X2009", "X863", "X867", "X864", "X2443", "X868", 
  "X862", "X866", "X865", "X869", "X873", "X861", "X874", "X872", "X871", "X870", "X1899", "X2442", 
  "X875", "X880", "X879", "X2010", "X878", "X860", "X876", "X857", "X877", "X2011", "X858", "X2439", 
  "X881", "X859", "X856", "X2441", "X407", "X853", "X855", "X885", "X884", "X854", "X882", "X886", 
  "X883", "X887", "X2440", "X852", "X888", "X2444", "X889", "X851", "X456", "X850", "X890", "X849", 
  "X891", "X892", "X848", "X2445", "X2012", "X847", "X896", "X893", "X897", "X2438", "X895", "X894", 
  "X846", "X898", "X901", "X2013", "X902", "X900", "X845", "X899", "X844", "X903", "X907", "X843", 
  "X908", "X906", "X904", "X457", "X842", "X459", "X905", "X2014", "X909", "X841", "X1898", "X840", 
  "X910", "X839", "X913", "X912", "X2015", "X911", "X458", "X838", "X916", "X915", "X917", "X2436", 
  "X914", "X837", "X918", "X2437", "X919", "X920", "X2016", "X836", "X922", "X923", "X921", "X924", 
  "X925", "X835", "X2017", "X926", "X927", "X834", "X928", "X929", "X833", "X1897", "X930", "X460", 
  "X2018", "X932", "X933", "X931", "X832", "X934", "X2019", "X831", "X830", "X935", "X936", "X2432", 
  "X2429", "X937", "X829", "X828", "X938", "X2020", "X827", "X2426", "X941", "X939", "X940", "X942", 
  "X2425", "X826", "X2021", "X825", "X943", "X824", "X823", "X944", "X2022", "X945", "X2023", "X822", 
  "X947", "X946", "X821", "X1896", "X2430", "X820", "X2435", "X2024", "X948", "X819", "X2431", "X2433", 
  "X818", "X949", "X816", "X950", "X817", "X461", "X2025", "X1083", "X1084", "X951", "X815", "X462", 
  "X1085", "X952", "X1082", "X814", "X2424", "X2423", "X1086", "X1081", "X2026", "X1080", "X792", 
  "X1089", "X813", "X1090", "X953", "X798", "X810", "X795", "X1091", "X1093", "X1092", "X1079", "X789", 
  "X797", "X794", "X1087", "X791", "X799", "X800", "X801", "X793", "X809", "X1078", "X1088", "X796", 
  "X1094", "X808", "X811", "X802", "X790", "X788", "X812", "X804", "X1095", "X807", "X805", "X803", 
  "X1077", "X1096", "X1076", "X954", "X806", "X787", "X1097", "X1073", "X786", "X1075", "X955", "X1100", 
  "X1074", "X1098", "X1072", "X785", "X1099", "X956", "X2427", "X1101", "X406", "X2428", "X2027", "X784", 
  "X957", "X1071", "X1070", "X1102", "X783", "X1069", "X1103", "X463", "X1895", "X782", "X1067", "X1068", 
  "X958", "X1104", "X1066", "X2028", "X959", "X781", "X2422", "X1105", "X1106", "X472", "X960", "X1107", 
  "X1065", "X780", "X962", "X1108", "X1064", "X963", "X961", "X1063", "X1109", "X471", "X1062", "X779", 
  "X969", "X1110", "X1061", "X968", "X2029", "X1059", "X964", "X1060", "X965", "X1111", "X2030", "X1058", 
  "X967", "X970", "X966", "X778", "X974", "X972", "X973", "X470", "X997", "X1057", "X1112", "X971", "X975", 
  "X401", "X1113", "X1056", "X996", "X990", "X1114", "X986", "X982", "X1055", "X987", "X994", "X1115", 
  "X998", "X999", "X981", "X2414", "X983", "X979", "X1054", "X2434", "X2031", "X777", "X978", "X980", 
  "X469", "X1116", "X1000", "X995", "X989", "X1053", "X1117", "X977", "X976", "X464", "X991", "X1052", 
  "X985", "X2415", "X2421", "X988", "X1118", "X993", "X2413", "X1051", "X468", "X2032", "X984", "X473", 
  "X465", "X992", "X1119", "X402", "X776", "X2416", "X1894", "X1050", "X1120", "X2410", "X1049", "X2033", 
  "X1121", "X775", "X1046", "X1042", "X1045", "X1043", "X2419", "X1048", "X1039", "X1044", "X1040", 
  "X1038", "X2420", "X1047", "X1041", "X1122", "X1037", "X2034", "X1036", "X1123", "X2409", "X1035", 
  "X1022", "X1016", "X1028"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(columns_to_remove))





write.xlsx(dt, "Project_P_PLS-cv10-3.xlsx")





# Vector of columns to remove
columns_to_remove <- c(
  "X1029", "X2035", "X466", "X1021", "X1015", "X467", "X1034", "X1124", "X1023", "X1025", 
  "X1017", "X774", "X1027", "X1033", "X1018", "X1020", "X1024", "X1026", "X1019", "X1032", 
  "X1030", "X1031", "X1014", "X1013", "X1125", "X1012", "X1011", "X1009", "X1010", "X2412", 
  "X1008", "X1007", "X2418", "X2408", "X1006", "X1005", "X1004", "X1126", "X2036", "X2411", 
  "X2417", "X1001", "X1003", "X2404", "X2407", "X1002", "X1127", "X2037", "X2403", "X474", 
  "X1128", "X1129", "X1893", "X475", "X1130", "X2038", "X1131", "X1132", "X2039", "X2040", 
  "X1133", "X2406", "X2041", "X1134", "X2405", "X2402", "X1135", "X2400", "X2042", "X2401", 
  "X1136", "X1892", "X2043", "X2399", "X2398", "X1137", "X2392", "X2391", "X2044", "X2397", 
  "X1138", "X1304", "X1303", "X1305", "X1302", "X1306", "X1301", "X1307", "X1300", "X1308", 
  "X1309", "X1299", "X2393", "X1310", "X1139", "X1298", "X1297", "X2045", "X1311", "X1296", 
  "X2394", "X1312", "X1295", "X1140", "X1294", "X1313", "X2046", "X1293", "X2047", "X1314", 
  "X1891", "X1292", "X1141", "X1315", "X1291", "X1290", "X1316", "X2048", "X1289", "X1142", 
  "X1288", "X1287", "X1317", "X1286", "X1143", "X1285", "X2390", "X1318", "X1284", "X2049", 
  "X1283", "X1282", "X1281", "X1319", "X1280", "X1279", "X1144", "X1277", "X1278", "X1276", 
  "X2050", "X1275", "X1274", "X1320", "X2051", "X1273", "X1145", "X1271", "X1272", "X1270", 
  "X1269", "X1268", "X1890", "X1321", "X1267", "X1266", "X2396", "X1265", "X1264", "X1263", 
  "X1262", "X2386", "X2395", "X2389", "X1146", "X1261", "X1322", "X1260", "X2052", "X2385", 
  "X1259", "X1258", "X1147", "X1257", "X1323", "X1256", "X2053", "X2388", "X1255", "X2384", 
  "X1254", "X2387", "X1148", "X1253", "X1252", "X1324", "X1251", "X2054", "X1250", "X1249", 
  "X1149", "X2383", "X1889", "X1248", "X1325", "X1247", "X1150", "X1246", "X1245", "X1326", 
  "X1244", "X2055", "X1151", "X1243", "X1242", "X1241", "X1327", "X2056", "X1152", "X1240", 
  "X2380", "X1239", "X1328", "X2379", "X1238", "X1153", "X2057", "X1237", "X1236", "X1888", 
  "X1329", "X1235", "X1154", "X2382", "X1234", "X2058", "X1233", "X1330", "X1155", "X1232", 
  "X2378", "X2381", "X2059", "X2377", "X1331", "X1231", "X1159", "X2060", "X1160", "X1332", 
  "X2061", "X1887", "X2376", "X2062", "X1333", "X2375", "X2374", "X2373", "X2063", "X1334", 
  "X1335", "X763", "X2064"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(columns_to_remove))




write.xlsx(dt, "Project_P_PLS-cv10-4.xlsx")




# Vector of columns to remove
columns_to_remove <- c(
  "X1336", "X1337", "X1338", "X485", "X1339", "X762", "X1340", "X1341", 
  "X1676", "X1675", "X1674", "X1677", "X1671", "X1673", "X1672", "X1670", 
  "X1669", "X1668", "X1678", "X1342", "X1667", "X1679", "X1666", "X1665", 
  "X1343", "X1680", "X1664", "X1681", "X1682", "X486", "X1663", "X1683", 
  "X1662", "X761", "X1661", "X1684", "X1660", "X1659", "X1658", "X1685", 
  "X1657", "X1656", "X1655", "X1654", "X1686", "X1653", "X1652", "X1687", 
  "X1651", "X1688", "X760", "X487", "X759", "X488", "X2092", "X758", 
  "X2337", "X2336", "X2098", "X2197", "X2335", "X489", "X2099", "X2100", 
  "X2334", "X2101", "X2333", "X2332", "X2102", "X2260", "X2331", "X2329", 
  "X2191", "X2103", "X2190", "X2328", "X2330", "X2104", "X2261", "X757", 
  "X2189", "X490", "X2105", "X1605", "X2188", "X2262", "X2106", "X1376", 
  "X2107", "X2187", "X2327", "X2264", "X2263", "X2186", "X2108", "X2325", 
  "X2265", "X2326", "X2185", "X2324", "X2109", "X2266", "X1598", "X2184", 
  "X2111", "X2110", "X1597", "X2183", "X2323", "X2267", "X1596", "X2112", 
  "X1380", "X2182", "X1595", "X2322", "X1594", "X2321", "X1593", "X2180", 
  "X1592", "X2181", "X1381", "X1591", "X2179", "X1590", "X2113", "X2115", 
  "X2320", "X1589", "X2114", "X2319", "X1382", "X1588", "X2116", "X2268", 
  "X2318", "X1587", "X2178", "X1383", "X756", "X2317", "X2117", "X1586", 
  "X1585", "X2176", "X2177", "X1538", "X1537", "X1536", "X2118", "X1584", 
  "X1535", "X1539", "X1549", "X1540", "X1550", "X1551", "X1583", "X2175", 
  "X1546", "X1548", "X1384", "X1552", "X1547", "X1534", "X1545", "X1541", 
  "X1532", "X1533", "X1582", "X1542", "X1531", "X1518", "X2119", "X1543", 
  "X1525", "X1544", "X1526", "X1524", "X1517", "X1523", "X1520", "X1519", 
  "X1530", "X1529", "X1581", "X1521", "X1522", "X1527", "X1528", "X1553", 
  "X491", "X1576", "X1562", "X1575", "X1561", "X1516", "X1554"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(columns_to_remove))




write.xlsx(dt, "Project_P_PLS-cv10-5.xlsx")

# Load necessary libraries
library(dplyr)

# Vector of columns to remove
columns_to_remove <- c(
  "X1563", "X2316", "X1574", "X1555", "X1580", "X1564", "X1557", "X1558", "X1515", "X1514", 
  "X1556", "X1573", "X1577", "X1579", "X1567", "X2174", "X1568", "X1578", "X1559", "X1560", 
  "X1513", "X1565", "X1566", "X1512", "X1569", "X1385", "X1570", "X1511", "X1572", "X1571", 
  "X2173", "X1500", "X1501", "X2172", "X1502", "X2269", "X2120", "X1499", "X1508", "X1507", 
  "X1503", "X1504", "X1510", "X1505", "X1506", "X1509", "X2122", "X1498", "X2171", "X1497", 
  "X2123", "X2121", "X1496", "X1494", "X1493", "X1386", "X1482", "X1495", "X1481", "X2170", 
  "X1488", "X2124", "X1487", "X1490", "X1489", "X1492", "X1491", "X1483", "X1480", "X1484", 
  "X2169", "X1486", "X1485", "X1479", "X2125", "X2168", "X1478", "X2270", "X1477", "X2126", 
  "X2315", "X1476", "X1474", "X1387", "X1475", "X1473", "X2301", "X2127", "X1468", "X2300", 
  "X2302", "X1472", "X1470", "X1469", "X1471", "X1467", "X2297", "X2167", "X2298", "X1464", 
  "X2296", "X2299", "X1466", "X1465", "X2314", "X1388", "X1462", "X2130", "X1461", "X2304", 
  "X2166", "X1463", "X2295", "X2128", "X2131", "X2310", "X2311", "X2165", "X1459", "X1460", 
  "X2129", "X2273", "X2305", "X2294", "X2303", "X1458", "X2313", "X2164", "X1389", "X2271", 
  "X2132", "X2133", "X2293", "X2309", "X2307", "X2274", "X2308", "X1390", "X2312", "X2134", 
  "X2272", "X1457", "X1456", "X2163", "X2135", "X1455", "X2137", "X1391", "X2306", "X2161", 
  "X2162", "X2136", "X1454", "X1453", "X2160", "X2159", "X1452", "X2138", "X2158", "X1392", 
  "X2275", "X2292", "X1451", "X1393", "X2155", "X2157", "X2276", "X2154", "X1450", "X1449", 
  "X2156", "X2139", "X1394", "X2281", "X2291", "X2290", "X2150", "X1448", "X2147", "X2282", 
  "X2153", "X2280", "X2148", "X2151", "X2149", "X2152", "X2146", "X2140", "X2279", "X2144", 
  "X2143", "X1395", "X2145", "X1447", "X1446", "X2283", "X1396", "X1397", "X2289", "X2277", 
  "X1445", "X2141", "X1398", "X2142", "X2278", "X2284", "X1444", "X1399", "X1443", "X1400", 
  "X1442", "X1441", "X1401", "X755", "X1440", "X1402"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(columns_to_remove))

# View the updated dataframe
glimpse(dt)




write.xlsx(dt, "Project_P_PLS-cv10-6.xlsx")





# Vector of columns to remove
additional_columns_to_remove <- c(
  "X1403", "X1405", "X1407", "X1409", "X1411", "X1413", "X1415", "X1417", 
  "X1419", "X1421", "X1423", "X1425", "X1427", "X1429", "X1431", "X1433", 
  "X1435", "X1437", "X1439", "X2286", "X2288", "X493", "X495", "X497", 
  "X499", "X501", "X503", "X505", "X507", "X509", "X511", "X513", "X515", 
  "X517", "X519", "X521", "X523", "X525", "X527", "X529", "X531", "X533", 
  "X535", "X537", "X539", "X541", "X543", "X545", "X547", "X549", "X551", 
  "X553", "X555", "X557", "X559", "X561", "X563", "X565", "X567", "X569", 
  "X571", "X573", "X575", "X577", "X579", "X581", "X583", "X585", "X587", 
  "X589", "X591", "X593", "X595", "X597", "X599", "X601", "X603", "X605", 
  "X607", "X609", "X611", "X613", "X615", "X617", "X619", "X621", "X623", 
  "X625", "X627", "X629", "X631", "X633", "X635", "X637", "X639", "X641", 
  "X643", "X645", "X647", "X649", "X651", "X653", "X655", "X657", "X659", 
  "X661", "X663", "X665", "X667", "X669", "X671", "X673", "X675", "X677", 
  "X679", "X681", "X683", "X685", "X687", "X689", "X691", "X693", "X695", 
  "X697", "X699", "X701", "X703", "X705", "X707", "X709", "X711", "X713", 
  "X715", "X717", "X719", "X721", "X723", "X725", "X727", "X729", "X731", 
  "X733", "X735", "X737", "X739", "X741", "X743", "X745", "X747", "X749", 
  "X751", "X753"
)

# Remove the additional specified columns from the dataset
dt <- dt %>%
  select(-all_of(additional_columns_to_remove))



write.xlsx(dt, "Project_P_PLS-cv10-7.xlsx")











# Vector of additional columns to remove
more_columns_to_remove <- c(
  "X1438", "X1404", "X2285", "X2287", "X1406", "X1436", "X1408", "X1434", 
  "X1432", "X1410", "X1430", "X1416", "X1418", "X1412", "X1428", "X1414", 
  "X1426", "X1424", "X1420", "X1422", "X492", "X754", "X494", "X752", 
  "X750", "X672", "X670", "X496", "X668", "X674", "X666", "X676", "X748", 
  "X498", "X664", "X678", "X746", "X662", "X500", "X680", "X660", "X744", 
  "X658", "X502", "X656", "X682", "X654", "X652", "X742", "X650", "X504", 
  "X648", "X684", "X646", "X506", "X740", "X644", "X686", "X642", "X508", 
  "X738", "X640", "X510", "X638", "X688", "X636", "X634", "X632", "X736", 
  "X630", "X628", "X626", "X512", "X624", "X622", "X620", "X618", "X690", 
  "X616", "X514", "X614", "X612", "X610", "X734", "X608", "X606", "X516", 
  "X604", "X602", "X600", "X692", "X598", "X596", "X594", "X518", "X592", 
  "X590", "X732", "X588", "X586", "X520", "X584", "X694", "X582", "X580", 
  "X522", "X578", "X576", "X730", "X524", "X574", "X696"
)

# Remove the additional specified columns from the dataset
dt <- dt %>%
  select(-all_of(more_columns_to_remove))


write.xlsx(dt, "Project_P_PLS-cv10-8.xlsx")



dt_final_cv10 <- dt


colnames(dt)[150] #here the hyper cols starts 

library(dplyr)

# Get column names for the relevant columns (149 to 296)
relevant_columns <- names(dt)[150:189]

# Function to calculate the index for a pair of columns
calculate_index <- function(col1, col2) {
  (dt[[col1]] - dt[[col2]]) / (dt[[col1]] + dt[[col2]])
}

# Create a dataframe to hold the names of new indices and their R-squared values
results <- data.frame(Index = character(), R_squared = numeric(), stringsAsFactors = FALSE)

# Iterate over the pairs of columns to create new indices and calculate R-squared values
for (i in 1:(length(relevant_columns) - 1)) {
  for (j in (i + 1):length(relevant_columns)) {
    col1 <- relevant_columns[i]
    col2 <- relevant_columns[j]
    new_col_name <- paste(col1, col2, sep = "_")
    dt[[new_col_name]] <- calculate_index(col1, col2)
    
    # Calculate the R-squared value
    model <- lm(dt[[new_col_name]] ~ dt$Zn_PXRF_mean, data = dt)
    r_squared <- summary(model)$r.squared
    
    # Add the result to the results dataframe
    results <- rbind(results, data.frame(Index = new_col_name, R_squared = r_squared))
  }
}

# View the results dataframe
print(results)

write.xlsx(results, "Project_P_R-Squared_from_PLS-bands_normalized_index_cv10.xlsx")







dt <- dt %>%
  mutate(VI550_728 = (X550 - X728) / (X550 + X728))

dt1 <- subset(dt, Zn_CV_filter=="Yes")
corr.test(dt1$VI550_728, dt1$Zn_PXRF_mean) # 






dt$Measure2 <- factor(dt$Measure2, levels = paste0("T", 0:10))

# Create the plot

ggplot(dt1, aes(x = Zn_PXRF_mean, y = VI550_728, color = Status)) + 
  geom_point(size=3) +  # adds the scatter plot points
  theme_minimal() + 
  labs(title = "ddd",
       x = "Zn conc in leaf",
       y = "VI550_728")




}


#Correlation filtered <0.999
{

setwd("C:/Users/twlodarczyk/OneDrive - University of Arizona/Desktop/All documents/1 PhD/CNRS + Synch/Hyperspectral Research/1_Experiment/1_Experiment_P/Spreadsheet/PLS")
dt <-read.delim("Project_P_pXRF_HP_Hyper.txt")


colnames(dt)[149] #here the hyper cols starts 




# List of columns to keep from 149 to 2198
columns_to_keep <- c("X400", "X407", "X418", "X435", "X482", "X490", "X494", "X497", "X500", "X503", 
                     "X506", "X510", "X517", "X669", "X681", "X683", "X685", "X700", "X715", "X723", 
                     "X727", "X730", "X732", "X734", "X736", "X738", "X740", "X742", "X745", "X750", 
                     "X762", "X945", "X1001", "X1147", "X1188", "X1324", "X1337", "X1350", "X1366", 
                     "X1377", "X1385", "X1392", "X1401", "X1421", "X1569", "X1639", "X1884", "X1892", 
                     "X1899", "X1908")

# Select columns from 1 to 148 and specified columns
dt_reduced <- dt %>%
  select(1:148, all_of(columns_to_keep))

# View the reduced dataframe
print(dt_reduced)


write.xlsx(dt_reduced, "Project_P_PLS-corr_filtered.xlsx")



# List of columns to remove
columns_to_remove <- c("X435", "X1908", "X418", "X1899", "X407", "X1892", 
                       "X1884", "X400", "X945", "X482", "X1421")

# Remove the specified columns from the dataset
dt_reduced <- dt_reduced %>%
  select(-all_of(columns_to_remove))

# View the reduced dataframe
print(dt_reduced)




write.xlsx(dt_reduced, "Project_P_PLS-corr_filtered2.xlsx")



# List of columns to remove
columns_to_remove <- c("X1001", "X1324", "X1401", "X1392", "X1337", "X1385", 
                       "X1147", "X1350", "X1377", "X1639", "X1366", "X762", 
                       "X490", "X1188", "X1569", "X494", "X669")

# Remove the specified columns from the dataset
dt_reduced <- dt_reduced %>%
  select(-all_of(columns_to_remove))

# View the reduced dataframe
print(dt_reduced)

write.xlsx(dt_reduced, "Project_P_PLS-corr_filtered3.xlsx")





dt <- dt_reduced

# Get column names for the relevant columns (149 to 296)
relevant_columns <- names(dt)[149:170]

# Function to calculate the index for a pair of columns
calculate_index <- function(col1, col2) {
  (dt[[col1]] - dt[[col2]]) / (dt[[col1]] + dt[[col2]])
}

# Create a dataframe to hold the names of new indices and their R-squared values
results <- data.frame(Index = character(), R_squared = numeric(), stringsAsFactors = FALSE)

# Iterate over the pairs of columns to create new indices and calculate R-squared values
for (i in 1:(length(relevant_columns) - 1)) {
  for (j in (i + 1):length(relevant_columns)) {
    col1 <- relevant_columns[i]
    col2 <- relevant_columns[j]
    new_col_name <- paste(col1, col2, sep = "_")
    dt[[new_col_name]] <- calculate_index(col1, col2)
    
    # Calculate the R-squared value
    model <- lm(dt[[new_col_name]] ~ dt$Zn_PXRF_mean, data = dt)
    r_squared <- summary(model)$r.squared
    
    # Add the result to the results dataframe
    results <- rbind(results, data.frame(Index = new_col_name, R_squared = r_squared))
  }
}

# View the results dataframe
print(results)

write.xlsx(results, "Project_P_R-Squared_from_PLS-bands_normalized_index_corrfiltered.xlsx")





dt <- dt %>%
  mutate(VI497_517 = (X497 - X517) / (X497 + X517))

dt1 <- subset(dt, Zn_CV_filter=="Yes")
corr.test(dt$VI497_517, dt$Zn_PXRF_mean) # 






# Create the plot

ggplot(dt, aes(x = Zn_PXRF_mean, y = VI497_517, color = Status)) + 
  geom_point(size=3) +  # adds the scatter plot points
  theme_minimal() + 
  labs(title = "ddd",
       x = "Zn conc in leaf",
       y = "VI497_517")



}





############ From the PLS cv10, two better bands 526 and 728


dt <- dt %>%
  mutate(VI728_526 = (X728 - X526) / (X728 + X526))


corr.test(dt$VI728_526, dt$Zn_PXRF_mean) #









# Create the plot
ggplot(dt, aes(x = Zn_PXRF_mean, y = VI728_526, color = Status)) + 
  geom_point(size=3) +  # adds the scatter plot points
  theme_minimal() + 
  labs(title = "ddd",
       x = "Zn conc in leaf",
       y = "VI728_526")






ggplot(dt, aes(x = X526, y = Zn_PXRF_mean, color = Status)) + 
  geom_point(size=3) +  # adds the scatter plot points
  theme_minimal() + 
  labs(title = "ddd",
       x = "X526",
       y = "Zn_PXRF_mean")

corr.test(dt$X526, dt$Zn_PXRF_mean) #0.61


ggplot(dt, aes(x = X728, y = Zn_PXRF_mean, color = Status)) + 
  geom_point(size=3) +  # adds the scatter plot points
  theme_minimal() + 
  labs(title = "ddd",
       x = "X728",
       y = "Zn_PXRF_mean")


corr.test(dt$X728, dt$Zn_PXRF_mean) #0.6


corr.test(dt$X550, dt$Zn_PXRF_mean) #0.59
corr.test(dt$X600, dt$Zn_PXRF_mean) #0.53
corr.test(dt$X716, dt$Zn_PXRF_mean) #0.6
corr.test(dt$X1950, dt$Zn_PXRF_mean) #-0.01






#PLS cv < 20%
{
##############
########### it was create before status update, but it doesn't matter
###### PLS cv < 20%
##############


setwd("C:/Users/twlodarczyk/OneDrive - University of Arizona/Desktop/All documents/1 PhD/CNRS + Synch/Hyperspectral Research/1_Experiment/1_Experiment_P/Spreadsheet/PLS")
dt <-read.delim("Project_P_pXRF_HP_Hyper.txt")


dt <- dt %>%
  filter(Zn_PXRF_cv < 0.2)




write.xlsx(dt, "Project_P_PLS-cv20.xlsx")



# List of columns to remove
columns_to_remove <- c(
  "X794", "X796", "X977", "X799", "X2355", "X813", "X791", "X793", "X801",
  "X1673", "X800", "X802", "X980", "X789", "X1830", "X1680", "X1672", "X790",
  "X810", "X2354", "X1682", "X788", "X809", "X1681", "X1671", "X808", "X805",
  "X804", "X807", "X811", "X803", "X812", "X1683", "X2078", "X987", "X806",
  "X1829", "X787", "X1670", "X984", "X786", "X1669", "X1828", "X1684", "X986",
  "X2241", "X785", "X988", "X2240", "X985", "X1668", "X1827", "X784", "X479",
  "X1685", "X2246", "X1826", "X989", "X783", "X2079", "X2244", "X1667", "X990",
  "X403", "X2245", "X2247", "X2243", "X2242", "X994", "X991", "X1825", "X2239",
  "X2353", "X1686", "X1666", "X1824", "X782", "X995", "X996", "X2080", "X2248",
  "X480", "X1665", "X997", "X1687", "X1823", "X993", "X781", "X1800", "X2352",
  "X992", "X2351", "X1312", "X999", "X1311", "X2238", "X1310", "X2234", "X1315",
  "X1316", "X1309", "X1313", "X1822", "X1664", "X1314", "X1799", "X2237", "X1317",
  "X2249", "X1821", "X1688", "X1318", "X998", "X1319", "X481", "X1000", "X2233",
  "X1819", "X1820", "X780", "X2350", "X2081", "X1818", "X1320", "X1308", "X1663",
  "X1321", "X1798", "X1817", "X2236", "X2235", "X1689", "X1816", "X1322", "X1307",
  "X1797", "X1662", "X2349", "X1815", "X779", "X2250", "X2082", "X2348", "X400",
  "X1661", "X1306", "X1323", "X1084", "X1796", "X1814", "X1083", "X1690", "X1085",
  "X1086", "X2232", "X2251", "X1660", "X2252", "X2347", "X1813", "X1305", "X1082",
  "X2231", "X2228", "X1089", "X1090", "X1091", "X1795", "X1092", "X1093", "X778",
  "X1659", "X2230", "X1324", "X1304", "X1087", "X2227", "X1081", "X1812", "X1088",
  "X1094", "X1691", "X1658", "X1080", "X1095", "X1096", "X2229", "X1097", "X2253",
  "X1325", "X1794", "X1303", "X1079", "X1729", "X1811", "X1728", "X1727", "X1810",
  "X1722", "X1098", "X2346", "X1657", "X1730", "X1721", "X1078", "X1099", "X2083",
  "X1100", "X1723", "X1724", "X1720", "X1326", "X1809", "X1726", "X2254", "X1725",
  "X1793", "X1302", "X1101", "X1077", "X1692", "X1656", "X1076", "X2226", "X777",
  "X1719", "X2224", "X2222", "X1102", "X1731", "X1808", "X2223", "X1655", "X1327",
  "X1732", "X1301", "X2345", "X2221", "X1733", "X2225", "X1103", "X1075", "X1792",
  "X1654", "X2084", "X1807", "X1074", "X1734", "X1735", "X2344", "X1718", "X1693",
  "X1073", "X1791", "X1328", "X1790", "X1104", "X1806", "X2255", "X1653", "X1736",
  "X404", "X1789", "X1300", "X1717", "X1105", "X1072", "X2085", "X1329", "X1788",
  "X2220", "X2343", "X1652", "X1106", "X1787", "X1737", "X1694", "X776", "X1107",
  "X1716", "X2219", "X1805", "X1330", "X1299", "X2218", "X1071", "X1651", "X1108",
  "X1786", "X1738", "X1070", "X2086", "X2217", "X2216", "X1331", "X1715", "X1109",
  "X1069", "X2215", "X1804", "X1298", "X2342", "X1739", "X1695", "X1067", "X1068",
  "X1785", "X1650", "X1110", "X1332", "X1803", "X2214", "X1066", "X1714", "X2256",
  "X775", "X1111", "X1297", "X1740", "X2087", "X1333", "X1649", "X1784", "X2213",
  "X1696", "X2088", "X1112", "X1802", "X1713", "X1648", "X1113", "X1334", "X2341",
  "X1741", "X1065", "X1296", "X1783", "X1114", "X2212", "X1801", "X1647", "X2339",
  "X1115", "X1064", "X1697", "X1335", "X1001", "X2340", "X1742", "X1063", "X1646",
  "X1712", "X1005", "X1006", "X2257", "X1116", "X1004", "X774", "X1002", "X1007",
  "X1062", "X1295", "X1003", "X1782", "X2211", "X2209", "X1008", "X1645", "X1336",
  "X1009", "X1061", "X2089", "X2210", "X1060", "X1117", "X1059", "X1010", "X1743",
  "X1781", "X1698", "X1294", "X1711", "X1780", "X1011", "X2208", "X1015", "X1644",
  "X1016", "X1779", "X1012", "X1118", "X1744", "X1058", "X1337", "X1778", "X1747",
  "X1013", "X1745", "X1014", "X2207", "X2338", "X1776", "X1746", "X1017", "X1777",
  "X1710", "X1699", "X1643", "X1748", "X1293", "X1119", "X1057", "X1018", "X482",
  "X1056", "X1775", "X2258", "X1749", "X1022", "X1021", "X1774", "X1019", "X1055",
  "X1338", "X1020", "X1120", "X2206", "X1750", "X1642", "X1709", "X1700", "X1773",
  "X484", "X1771", "X773", "X1023", "X1770", "X1054", "X1751", "X1772", "X483",
  "X1292", "X1752", "X2090", "X1769", "X1753", "X1121", "X1053", "X1024", "X1768",
  "X1701", "X1339", "X1641", "X1028", "X1025", "X1029", "X1754", "X1708", "X1763",
  "X1762", "X1052", "X1765", "X1764", "X1767", "X1038", "X1755", "X1291", "X1039",
  "X1122", "X1761", "X1766", "X2337", "X1027", "X1760", "X1026", "X1037", "X1759",
  "X1756", "X1702", "X1758", "X1036", "X1051", "X1757", "X1030", "X1340", "X1123",
  "X1640", "X2091", "X2259", "X1040", "X1707", "X1031", "X1703", "X1050", "X1290",
  "X1035", "X2336", "X1032", "X1042", "X1706", "X1033", "X1034", "X1704", "X1124",
  "X1049", "X1705", "X1041", "X2205", "X1341", "X1043", "X1639", "X2203", "X1044",
  "X2092", "X1046", "X1289", "X1125", "X1045", "X1048", "X772", "X2335", "X2202",
  "X1047", "X1342", "X2204", "X2201", "X1638", "X1126", "X2093", "X2200", "X1288",
  "X1343", "X1637", "X1287", "X2260", "X1127", "X2094", "X2199", "X1344", "X2334",
  "X1636", "X1128", "X1286", "X1129", "X1345", "X2095", "X2198", "X1635", "X1285",
  "X1130", "X771", "X2333", "X1131", "X1346", "X2096", "X2332", "X1132", "X1284",
  "X1634", "X2261", "X1347", "X1133", "X2197", "X1348", "X1283", "X2329", "X2331",
  "X2097", "X1633", "X1349", "X1282", "X1134", "X2196", "X2328", "X1281", "X1632",
  "X1350", "X1135", "X2330", "X1280", "X2098", "X2195", "X1279", "X1351", "X770",
  "X1631", "X1136", "X1278", "X1277", "X2262", "X1630", "X2194", "X2099", "X1137",
  "X1276", "X1352", "X1275", "X1274", "X2193", "X1629", "X1273", "X1138", "X1353",
  "X1272", "X1271", "X2100", "X2192", "X1139", "X1628", "X1270", "X1269", "X2263",
  "X1140", "X1354", "X2327", "X2191", "X1268", "X1141", "X1142", "X485", "X1627",
  "X1143", "X2264", "X1267", "X1266", "X1355", "X1265", "X2101", "X1264", "X1263",
  "X1144", "X1418", "X1626", "X1417", "X769", "X1416", "X1419", "X1262", "X2190",
  "X2326", "X1145", "X1356", "X1415", "X2325", "X1261", "X1420", "X1414", "X1146",
  "X2102", "X1413", "X1421", "X1412", "X1260", "X1422", "X1411", "X1625", "X1147",
  "X1410", "X2265", "X1423", "X1409", "X1424", "X2189", "X1357", "X1408", "X1259",
  "X1407", "X1425", "X1426", "X1148", "X1427", "X1428", "X2324", "X1406", "X2103",
  "X2266", "X1429", "X1149", "X1624", "X1258", "X1430", "X1150", "X1431", "X1432",
  "X2188", "X1405", "X1358", "X1433", "X1151", "X1257", "X1434", "X1404", "X1435",
  "X1359", "X1436", "X1152", "X2104", "X1256", "X1623", "X1458", "X1451", "X1437",
  "X1452", "X1453", "X1403", "X1438", "X1440", "X1459", "X1454", "X1439", "X1360",
  "X1441", "X1449", "X1455", "X1456", "X1255", "X2187", "X1153", "X1402", "X1460",
  "X1448", "X1450", "X1446", "X1457", "X1442", "X1447", "X1443", "X1444", "X1445",
  "X1401", "X2267", "X1461", "X1254", "X1400", "X1462", "X1399", "X1361", "X1154",
  "X2323", "X1253", "X1464"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(columns_to_remove))


write.xlsx(dt, "Project_P_PLS-cv20-1.xlsx")






# List of columns to remove
columns_to_remove <- c(
  "X435", "X436", "X441", "X440", "X438", "X439", "X442", "X437", "X434", "X433", "X443", "X432", "X430", 
  "X429", "X444", "X431", "X423", "X428", "X427", "X424", "X446", "X445", "X1932", "X1931", "X422", "X1933", 
  "X1934", "X1935", "X1930", "X1928", "X1929", "X1927", "X1936", "X1926", "X1942", "X1940", "X1937", "X1941", 
  "X1938", "X1925", "X447", "X1939", "X1943", "X1924", "X1923", "X1944", "X1922", "X1945", "X1921", "X1946", 
  "X1947", "X1920", "X1948", "X426", "X1949", "X1919", "X1918", "X1950", "X1917", "X420", "X1916", "X1951", 
  "X1953", "X1952", "X1954", "X1915", "X1955", "X421", "X1956", "X1914", "X1957", "X425", "X1913", "X1958", 
  "X1959", "X1960", "X448", "X1912", "X1961", "X1962", "X1911", "X1963", "X419", "X1964", "X1910", "X1965", 
  "X1966", "X1909", "X1967", "X449", "X1968", "X1908", "X1969", "X417", "X1970", "X1907", "X1971", "X1972", 
  "X1906", "X1973", "X416", "X1974", "X1975", "X1905", "X450", "X1977", "X1976", "X1978", "X1979", "X1904", 
  "X1980", "X418", "X1981", "X1982", "X1903", "X1983", "X415", "X1984", "X414", "X1985", "X1986", "X1902", 
  "X1987", "X451", "X1988", "X1989", "X1901", "X1990", "X413", "X1991", "X1992", "X1993", "X1900", "X1994", 
  "X452", "X1995", "X1996", "X1997", "X1899", "X1998", "X1999", "X2000", "X410", "X409", "X2001", "X453", 
  "X412", "X1898", "X2002", "X2003", "X2004", "X2005", "X2006", "X1897", "X2007", "X454", "X2008", "X2009", 
  "X2010", "X2011", "X1896", "X2012", "X2447", "X408", "X2013", "X2446", "X411", "X2440", "X2014", "X2448", 
  "X2441", "X2449", "X455", "X2439", "X2015", "X1895", "X2438", "X2442", "X2016", "X2445", "X2443", "X2017", 
  "X456", "X2437", "X2436", "X2444", "X2018", "X407", "X2019", "X1894", "X2020", "X457", "X2021", "X2435", 
  "X2022", "X2429", "X2023", "X2430", "X2024", "X2432", "X2431", "X2426", "X2425", "X1893", "X2025", "X2433", 
  "X458", "X2026", "X2424", "X459", "X2423", "X406", "X2027", "X2434", "X2428", "X2427", "X460", "X2028", 
  "X862", "X863", "X868", "X867", "X864", "X861", "X866", "X865", "X869", "X1892", "X860", "X858", "X857", 
  "X872", "X870", "X859", "X873", "X871", "X856", "X874", "X853", "X2029", "X855", "X875", "X854", "X852", 
  "X876", "X878", "X851", "X2030", "X879", "X877", "X880", "X850", "X881", "X849", "X848", "X2422", "X847", 
  "X461", "X2031", "X884", "X883", "X882", "X885", "X2414", "X462", "X886", "X887", "X2413", "X846", "X2032", 
  "X888", "X2415", "X845", "X889", "X844", "X843", "X2033", "X1891", "X890", "X842", "X891", "X2416", "X841", 
  "X892", "X840", "X2034", "X2421", "X893", "X839", "X896", "X463", "X894", "X897", "X895", "X838", "X2035", 
  "X898", "X837", "X2412", "X899", "X2420", "X900", "X901", "X836", "X902", "X2419", "X472", "X2036", "X835", 
  "X903", "X2410", "X2411", "X1890", "X2417", "X2404", "X834", "X906", "X904", "X907", "X905", "X908", "X2037", 
  "X2403", "X2418", "X909", "X833", "X2409", "X910", "X832", "X2038", "X464", "X912", "X911", "X913", "X831", 
  "X830", "X2408", "X2402", "X915", "X916", "X829", "X2039", "X914", "X2407", "X2406", "X917", "X2405", "X918", 
  "X919", "X828", "X471", "X473", "X1889", "X920", "X2040", "X827", "X2401", "X468", "X405", "X469", "X921", 
  "X922", "X826", "X923", "X470", "X825", "X2400", "X2041", "X824", "X924", "X925", "X926", "X823", "X465", 
  "X927", "X467", "X2042", "X928", "X822", "X2399", "X929", "X821", "X820", "X466", "X930", "X2043", "X819", 
  "X931", "X932", "X1888", "X933", "X818", "X934", "X817", "X816", "X2398", "X815", "X2044", "X814", "X935", 
  "X792", "X401", "X936", "X795", "X797", "X798", "X937", "X2392", "X938", "X2397", "X2391", "X939", "X941", 
  "X942", "X475", "X2045", "X940", "X2393", "X474", "X402", "X2394", "X943", "X944", "X1887", "X2046", "X2396", 
  "X947", "X945", "X2395", "X2390", "X2047", "X946"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(columns_to_remove))


write.xlsx(dt, "Project_P_PLS-cv20-2.xlsx")




# List of columns to remove
columns_to_remove <- c(
  "X948", "X2048", "X2389", "X949", "X950", "X951", "X952", "X2049", "X2386", "X953", "X2385", "X2388", "X476",
  "X2050", "X1886", "X954", "X2387", "X955", "X956", "X957", "X2384", "X2051", "X958", "X962", "X959", "X960",
  "X963", "X961", "X2383", "X2052", "X1885", "X965", "X964", "X966", "X2053", "X968", "X967", "X969", "X970",
  "X971", "X477", "X972", "X2054", "X973", "X2380", "X1884", "X974", "X2382", "X975", "X2379", "X979", "X982",
  "X2381", "X2055", "X978", "X976", "X478", "X981", "X983", "X1883", "X2378", "X2056", "X2377", "X1882", "X2057",
  "X2376", "X2058", "X1881", "X2059", "X2373", "X2375", "X2374", "X2060", "X1880", "X2061", "X2062", "X2372",
  "X1879", "X2063", "X2370", "X2369", "X1878", "X2064", "X2367", "X2368", "X2371", "X2065", "X768", "X1877",
  "X2366", "X2066", "X1875", "X1876", "X1874", "X1873", "X2067", "X1872", "X2364", "X2365", "X2363", "X2068",
  "X1871", "X767", "X2362", "X2069", "X1869", "X1870", "X1868", "X1867", "X1866", "X1865", "X2070", "X1864",
  "X2361", "X1863", "X1862", "X2071", "X1860", "X1861", "X1859", "X1858", "X1857", "X2360", "X2359", "X1856",
  "X2072", "X766", "X1855", "X2358", "X2073", "X1854", "X1853", "X1852", "X1851", "X1850", "X2074", "X1849",
  "X2357", "X1848", "X2075", "X1847", "X2356", "X1846", "X765", "X2076", "X1845", "X2077", "X1844", "X1843",
  "X1842", "X1841", "X1840", "X1839", "X1838", "X1837", "X1836", "X764", "X1835", "X1834", "X1833", "X1832",
  "X1831", "X486", "X1676", "X1677", "X1675", "X1678", "X1674", "X1679", "X763", "X762", "X487", "X1252", "X1155",
  "X1251", "X1250", "X1156", "X1249", "X1157", "X1248", "X1158", "X1159", "X1247", "X1160", "X1246", "X1161",
  "X1245", "X761", "X1162", "X1244", "X1243", "X1163", "X1242", "X1164", "X1165", "X1241", "X1166", "X1240",
  "X1167", "X1168", "X1239", "X1238", "X1169", "X1237", "X1170", "X1236", "X1171", "X1235", "X1172", "X1234",
  "X1173", "X1233", "X1174", "X1232", "X1175", "X488", "X1231", "X1176", "X1230", "X1177", "X1229", "X1178",
  "X1398", "X2105", "X1228", "X760", "X1179", "X1463", "X1397", "X1465", "X1227", "X1466", "X2322", "X1467",
  "X1180", "X1468", "X1469", "X1226", "X2106", "X1396", "X1470", "X1181", "X1471", "X1225", "X1472", "X1473",
  "X1182", "X1395", "X2321", "X2107", "X1474", "X2186", "X1475", "X1224", "X1183", "X1476", "X1394", "X2320",
  "X1477", "X2108", "X1223", "X2319", "X1184", "X2185", "X1478", "X1393", "X2268", "X1479", "X1222", "X1480",
  "X1185", "X2318", "X1481", "X2184", "X1221", "X1392", "X2109", "X1482", "X2317", "X1186", "X1220", "X2183",
  "X1391", "X2182", "X1483", "X2111", "X1219", "X2110", "X1187", "X1484", "X1218", "X2316", "X1390", "X2181",
  "X1188", "X1217", "X2302", "X1485", "X2303", "X1362", "X2112", "X1389", "X2301", "X1486", "X2269", "X1363",
  "X1487", "X2304", "X1189", "X1216", "X489", "X1488", "X1388", "X2180", "X1364", "X1489", "X2300", "X1215",
  "X1387", "X2315", "X1490", "X2179", "X1365", "X1386", "X2313", "X2305", "X1190", "X1491", "X2178", "X2113",
  "X1622", "X1214", "X2314", "X1366", "X2270", "X2299", "X1385", "X2306", "X2312", "X1492", "X2311", "X1213",
  "X2310", "X1191", "X1384", "X1367", "X2307", "X1192", "X2177", "X1493", "X1212", "X1621", "X1383", "X2298",
  "X1368", "X2114", "X2308", "X2309", "X1193", "X1369", "X2297", "X1211", "X1494", "X2296", "X1370", "X1371",
  "X1210", "X1382", "X2176", "X1372", "X1194", "X1620", "X1209", "X1495", "X1381", "X1373", "X2115", "X759",
  "X1374", "X1195", "X1208", "X1380", "X1496", "X1497", "X1375", "X2295", "X1378", "X2175", "X1376", "X1379",
  "X1377", "X1207", "X1196", "X1498", "X1619", "X1206", "X2271", "X2116", "X2294", "X1205", "X1499", "X2273",
  "X1199", "X1197", "X1200", "X2117", "X1500", "X1204", "X1201", "X1198", "X1202", "X2118", "X1618", "X1203",
  "X2293", "X1501", "X2272", "X2174", "X2119", "X1502", "X2274", "X1617", "X1503", "X2173", "X2172", "X2120",
  "X1504", "X2292", "X1616", "X1505", "X2171", "X2121", "X2122", "X1507", "X1506", "X2291", "X2290", "X1615",
  "X1508", "X2170", "X2123", "X1509", "X1614", "X2275", "X2280", "X2289", "X1510", "X1511", "X2279", "X2124",
  "X2169", "X2281", "X1512", "X2282", "X1513", "X2276", "X1613", "X2283", "X1514", "X1515", "X2125", "X2168",
  "X2284", "X1516", "X1517", "X2288", "X1518", "X2277", "X1612", "X2278", "X1519", "X2285", "X2287", "X2286",
  "X490", "X1520", "X2126", "X2167", "X1611", "X1521", "X1522", "X2166", "X2127", "X1523", "X1524", "X2165",
  "X2163", "X2130", "X1525", "X2131", "X1610", "X2164", "X1526", "X2162", "X2132", "X2128", "X1527", "X2133",
  "X2129"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(columns_to_remove))


write.xlsx(dt, "Project_P_PLS-cv20-3.xlsx")




# List of columns to remove
additional_columns_to_remove <- c(
  "X1528", "X2134", "X1529", "X1609", "X1530", "X2161", "X2135", "X1531", "X2160", "X1532", "X2159", "X2136", 
  "X2137", "X1608", "X1533", "X2158", "X1534", "X1535", "X2157", "X1536", "X2138", "X2156", "X1537", "X1607", 
  "X2155", "X1538", "X2154", "X1539", "X2153", "X1606", "X2152", "X1540", "X2151", "X2139", "X1541", "X1605", 
  "X2143", "X2140", "X758", "X2144", "X2150", "X1542", "X2141", "X2147"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(additional_columns_to_remove))

write.xlsx(dt, "Project_P_PLS-cv20-4.xlsx")




# List of additional columns to remove
additional_columns_to_remove <- c(
  "X2148", "X2145", "X2146", "X2149", "X2142", "X1604", "X1543", "X1544", "X1545", "X1546", "X1547", "X1603", 
  "X1548", "X1549", "X1550", "X1602", "X1551", "X1601", "X1552", "X1600", "X1553", "X1599", "X1554", "X1555", 
  "X1598", "X1556", "X1557", "X1558", "X1597", "X1559", "X1560", "X1561", "X1596", "X1562", "X1595", "X1563", 
  "X1594", "X1564", "X1593", "X1565", "X1592", "X1566", "X1591", "X1567", "X1590", "X1568", "X1589", "X1569", 
  "X1588", "X1570", "X1571", "X1573", "X1572", "X1587", "X1574", "X1575", "X1576", "X1586", "X1577", "X491", 
  "X1585", "X1584", "X1578", "X1583", "X1582", "X1581", "X1579", "X1580", "X757", "X756", "X492", "X755", 
  "X493", "X754", "X494", "X753", "X752", "X495", "X672", "X671", "X673", "X670", "X674", "X669", "X751", 
  "X675", "X496", "X668", "X676", "X750", "X667", "X497", "X677", "X666", "X749", "X678", "X498", "X665", 
  "X679", "X748", "X664", "X499", "X680", "X747", "X663", "X681", "X500", "X662", "X746", "X661", "X682", 
  "X501", "X745", "X660", "X659", "X683", "X502", "X658", "X744", "X657", "X656", "X503", "X655", "X684", 
  "X654", "X743", "X653", "X652", "X651", "X504", "X650", "X742", "X685", "X649", "X505", "X648", "X741", 
  "X647", "X686", "X506", "X646", "X740", "X645", "X507", "X687"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(additional_columns_to_remove))


write.xlsx(dt, "Project_P_PLS-cv20-5.xlsx")




# List of additional columns to remove
additional_columns_to_remove_2 <- c(
  "X644", "X643", "X739", "X508", "X642", "X688", "X641", "X509", "X738", "X640", "X639", "X510", "X638", 
  "X689", "X637", "X737", "X636", "X511", "X635", "X634", "X633", "X632", "X631", "X630", "X629", "X628", 
  "X627", "X512", "X626", "X625", "X624", "X690", "X623", "X736", "X622", "X621", "X620", "X513", "X619", 
  "X618", "X617", "X616", "X514", "X691", "X615", "X735", "X614", "X613", "X612", "X515", "X611", "X610", 
  "X692", "X609", "X608", "X516", "X607", "X734", "X606", "X605", "X604", "X603", "X602", "X601", "X517", 
  "X600", "X599", "X693", "X598", "X597", "X596", "X595", "X594", "X518", "X593", "X733", "X592", "X591", 
  "X694", "X590", "X519", "X589", "X588", "X587", "X586", "X520", "X585", "X695", "X732", "X584", "X583", "X521"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(additional_columns_to_remove_2))




write.xlsx(dt, "Project_P_PLS-cv20-6.xlsx")




# List of additional columns to remove
additional_columns_to_remove_3 <- c(
  "X582", "X581", "X696", "X580", "X522", "X579", "X731", "X578", "X523", "X697", "X577", "X576", "X524",
  "X575", "X698", "X574", "X525", "X730", "X573", "X699", "X572", "X526", "X571", "X700", "X527", "X570",
  "X729", "X701", "X528", "X569", "X529", "X702", "X568", "X530", "X567", "X703", "X531", "X728", "X566",
  "X704", "X532", "X565", "X533", "X705", "X564", "X534"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(additional_columns_to_remove_3))

write.xlsx(dt, "Project_P_PLS-cv20-7.xlsx")



# List of additional columns to remove
additional_columns_to_remove_4 <- c(
  "X563", "X535", "X706", "X727", "X536", "X562", "X537", "X707", "X561", "X538", "X560", "X539", "X540", 
  "X559", "X708", "X541", "X542", "X558", "X543", "X557", "X556", "X544", "X545", "X555", "X726"
)

# Remove the specified columns from the dataset
dt <- dt %>%
  select(-all_of(additional_columns_to_remove_4))

write.xlsx(dt, "Project_P_PLS-cv20-8.xlsx")





####
###Check infex



dt <- dt %>%
  mutate(VI553_735 = (X550 - X716) / (X550 + X717))




# Create the plot
ggplot(dt, aes(x = Zn_PXRF_mean, y = VI553_735, color = Status)) + 
  geom_point(size=3) +  # adds the scatter plot points
  theme_minimal() + 
  labs(title = "ddd",
       x = "Zn conc in leaf",
       y = "VI553_735")



setwd("C:/Users/twlodarczyk/OneDrive - University of Arizona/Desktop/All documents/1 PhD/CNRS + Synch/Hyperspectral Research/1_Experiment/1_Experiment_P/Spreadsheet/PLS/cv20")
dt <-read.delim("Project_P_PLS-cv20-8.txt")



colnames(dt)[149] #here the hyper cols starts 

# Get column names for the relevant columns (149 to 296)
relevant_columns <- names(dt)[149:174]

# Function to calculate the index for a pair of columns
calculate_index <- function(col1, col2) {
  (dt[[col1]] - dt[[col2]]) / (dt[[col1]] + dt[[col2]])
}

# Create a dataframe to hold the names of new indices and their R-squared values
results <- data.frame(Index = character(), R_squared = numeric(), stringsAsFactors = FALSE)

# Iterate over the pairs of columns to create new indices and calculate R-squared values
for (i in 1:(length(relevant_columns) - 1)) {
  for (j in (i + 1):length(relevant_columns)) {
    col1 <- relevant_columns[i]
    col2 <- relevant_columns[j]
    new_col_name <- paste(col1, col2, sep = "_")
    dt[[new_col_name]] <- calculate_index(col1, col2)
    
    # Calculate the R-squared value
    model <- lm(dt[[new_col_name]] ~ dt$Zn_PXRF_mean, data = dt)
    r_squared <- summary(model)$r.squared
    
    # Add the result to the results dataframe
    results <- rbind(results, data.frame(Index = new_col_name, R_squared = r_squared))
  }
}

# View the results dataframe
print(results)


write.xlsx(results, "Project_P_PLS-8-cv20_Normalized_Index.xlsx")


#############################these are yet to be analyzed below:

colnames(dt)[149] #here the hyper cols starts 

# Get column names for the relevant columns (149 to 296)
relevant_columns <- names(dt)[149:174]

# Function to calculate the index for a pair of columns
calculate_index <- function(col1, col2) {
  (dt[[col1]]) / (dt[[col2]])
}

# Create a dataframe to hold the names of new indices and their R-squared values
results <- data.frame(Index = character(), R_squared = numeric(), stringsAsFactors = FALSE)

# Iterate over the pairs of columns to create new indices and calculate R-squared values
for (i in 1:(length(relevant_columns) - 1)) {
  for (j in (i + 1):length(relevant_columns)) {
    col1 <- relevant_columns[i]
    col2 <- relevant_columns[j]
    new_col_name <- paste(col1, col2, sep = "_")
    dt[[new_col_name]] <- calculate_index(col1, col2)
    
    # Calculate the R-squared value
    model <- lm(dt[[new_col_name]] ~ dt$Zn_PXRF_mean, data = dt)
    r_squared <- summary(model)$r.squared
    
    # Add the result to the results dataframe
    results <- rbind(results, data.frame(Index = new_col_name, R_squared = r_squared))
  }
}

# View the results dataframe
print(results)


write.xlsx(results, "Project_P_PLS-8-cv20-Ratio_Index.xlsx")





colnames(dt)[149] #here the hyper cols starts 

# Get column names for the relevant columns (149 to 296)
relevant_columns <- names(dt)[149:174]

# Function to calculate the index for a pair of columns
calculate_index <- function(col1, col2) {
  (dt[[col1]]) - (dt[[col2]])
}

# Create a dataframe to hold the names of new indices and their R-squared values
results <- data.frame(Index = character(), R_squared = numeric(), stringsAsFactors = FALSE)

# Iterate over the pairs of columns to create new indices and calculate R-squared values
for (i in 1:(length(relevant_columns) - 1)) {
  for (j in (i + 1):length(relevant_columns)) {
    col1 <- relevant_columns[i]
    col2 <- relevant_columns[j]
    new_col_name <- paste(col1, col2, sep = "_")
    dt[[new_col_name]] <- calculate_index(col1, col2)
    
    # Calculate the R-squared value
    model <- lm(dt[[new_col_name]] ~ dt$Zn_PXRF_mean, data = dt)
    r_squared <- summary(model)$r.squared
    
    # Add the result to the results dataframe
    results <- rbind(results, data.frame(Index = new_col_name, R_squared = r_squared))
  }
}

# View the results dataframe
print(results)


write.xlsx(results, "Project_P_PLS-8-cv20-difference_Index.xlsx")






}




# PLS cv < 20% and A only

{
setwd("C:/Users/twlodarczyk/OneDrive - University of Arizona/Desktop/All documents/1 PhD/CNRS + Synch/Hyperspectral Research/1_Experiment/1_Experiment_P/Spreadsheet/PLS")
dt <-read.delim("Project_P_pXRF_HP_Hyper.txt")


dt <- dt %>%
  filter(Zn_PXRF_cv < 0.2)

dt <- dt %>%
  filter(Status == "A")


#write.xlsx(dt, "Project_P_PLS-cv20-A.xlsx")



# List of columns to remove
columns_to_remove <- c("X2373", "X1376", "X2377", "X2070", "X2378", "X2374", 
                       "X1375", "X2069", "X1881", "X2376", "X2068", "X2375", 
                       "X1374", "X2067", "X2379", "X1373", "X2066", "X2380", 
                       "X1372", "X2065", "X2063", "X2064", "X1882", "X2387", 
                       "X2388", "X2381", "X1371", "X2062", "X2389", "X1370", 
                       "X2382", "X2383", "X2061", "X2384", "X1369", "X2386", 
                       "X2060", "X2390", "X2059", "X2385", "X1368", "X2058", 
                       "X1883", "X1367", "X2057", "X2056", "X1366", "X2055", 
                       "X1365", "X2054", "X2391", "X2053", "X1364", "X2052", 
                       "X2051", "X2050", "X1884", "X1363", "X2401", "X2392", 
                       "X2049", "X2395", "X1362", "X2396", "X2048", "X1361", 
                       "X2394", "X2393", "X2402", "X2047", "X2398", "X2397", 
                       "X1360", "X2046", "X2400", "X2399", "X1885", "X1359", 
                       "X2045", "X1358", "X2044", "X1357", "X2043", "X2403", 
                       "X1356", "X2042", "X2404", "X1355", "X2407", "X2408", 
                       "X2041", "X1886", "X1354", "X2040", "X1353", "X2039", 
                       "X2405", "X2406", "X2413", "X2038", "X2037", "X1352", 
                       "X2036", "X2409", "X2410", "X2035", "X1351", "X2414", 
                       "X2034", "X2033", "X2411", "X2412", "X1350", "X2032", 
                       "X1887", "X1349", "X2031", "X1348", "X2030", "X2029", 
                       "X1347", "X2415", "X2028", "X1888", "X1346", "X2026", 
                       "X2027", "X2416", "X2025", "X2420", "X2421", "X1345", 
                       "X2422", "X2419", "X2425", "X2024", "X1344", "X2426", 
                       "X2023", "X1889", "X2423", "X1343", "X2022", "X2417", 
                       "X2424", "X2427", "X2021", "X1342", "X2418", "X2428", 
                       "X2020", "X2019", "X1341", "X2018", "X2435", "X2429", 
                       "X1340", "X2017", "X2436", "X1890", "X2434", "X2016", 
                       "X1339", "X2430", "X2015", "X2433", "X2431", "X1338", 
                       "X2014", "X2432", "X1337", "X2437", "X2439", "X2445", 
                       "X2013", "X2438", "X1891", "X2440", "X1336", "X2012", 
                       "X2011", "X1335", "X2009", "X2010", "X1334", "X2008", 
                       "X2441", "X2444", "X2442", "X1892", "X2443", "X2007", 
                       "X1333", "X2446", "X2006", "X1332", "X2005", "X1331", 
                       "X2004", "X1893", "X1330", "X2003", "X2002", "X1329", 
                       "X2001", "X2449", "X2000", "X1328", "X1999", "X1894", 
                       "X1327", "X1998", "X2447", "X1326", "X1997", "X1996", 
                       "X2448", "X1995", "X1325", "X1895", "X1994", "X1324", 
                       "X1993", "X1992", "X1323", "X1896", "X1322", "X1991", 
                       "X1990", "X1989", "X1321", "X1988", "X1320", "X1897", 
                       "X1987", "X1319", "X1986", "X1318", "X1898", "X1985", 
                       "X1984", "X1317", "X1983", "X1982", "X1316", "X1899", 
                       "X1981", "X1315", "X1980", "X1979", "X1978", "X1314", 
                       "X1900", "X1977", "X1313", "X1312", "X1976", "X1975", 
                       "X1311", "X1901", "X1974", "X1310", "X1973", "X1309", 
                       "X1972", "X1902", "X1971", "X1308", "X1970", "X1307", 
                       "X1969", "X1903", "X1967", "X1968", "X1966", "X1306", 
                       "X1965", "X1904", "X1305", "X1964", "X1905", "X1963", 
                       "X1304", "X1961", "X1962", "X1906", "X1303", "X1960", 
                       "X1302", "X1301", "X1959", "X1907", "X1185", "X1184", 
                       "X1300", "X1192", "X1193", "X1191", "X1190", "X1181", 
                       "X1183", "X1194", "X1182", "X1186", "X1189", "X1195", 
                       "X1188", "X1179", "X1196", "X1187", "X1180", "X1197", 
                       "X1178", "X1198", "X1199", "X1201", "X1200", "X1207", 
                       "X1202", "X1208", "X1958", "X1177", "X1203", "X1204", 
                       "X1205", "X1206", "X1176", "X1209", "X1957", "X1175", 
                       "X1299", "X1908", "X1174", "X1210", "X1173", "X1172", 
                       "X1211", "X1954", "X1298", "X1909", "X1171", "X1212", 
                       "X1213", "X1956", "X1953", "X1170", "X1297", "X1948", 
                       "X1214", "X1955", "X1215", "X1947", "X1169", "X1216", 
                       "X1952", "X1217", "X1949", "X1168", "X1296", "X1950")

# Remove the columns from the dataset
dt <- dt %>% select(-all_of(columns_to_remove))



#write.xlsx(dt, "Project_P_PLS-cv20-A2.xlsx")






# List of columns to remove
columns_to_remove <- c("X2174", "X2172", "X2171", "X2170", "X1500", "X2173", 
                       "X2169", "X2168", "X1499", "X2291", "X2167", "X1866", 
                       "X2293", "X2166", "X2163", "X2165", "X2292", "X2162", 
                       "X2164", "X1498", "X2294", "X2161", "X2160", "X2159", 
                       "X2157", "X1497", "X2158", "X2156", "X2295", "X1867", 
                       "X2296", "X2153", "X2155", "X2152", "X1496", "X2154", 
                       "X2151", "X2297", "X1495", "X2150", "X2148", "X2146", 
                       "X2149", "X2301", "X2147", "X1868", "X2145", "X2298", 
                       "X2302", "X1494", "X2300", "X2299", "X1493", "X2144", 
                       "X1492", "X2143", "X2142", "X2303", "X1869", "X2141", 
                       "X1491", "X2140", "X2138", "X1490", "X2139", "X2137", 
                       "X2304", "X2136", "X1489", "X2135", "X2134", "X1870", 
                       "X2305", "X2133", "X1488", "X2308", "X2132", "X2306", 
                       "X2307", "X2131", "X1487", "X2309", "X2130", "X1871", 
                       "X1486", "X2125", "X2126", "X2129", "X2127", "X2124", 
                       "X2128", "X1485", "X2310", "X1484", "X2123", "X2311", 
                       "X2122", "X1483", "X1872", "X2121", "X2312", "X1482", 
                       "X2120", "X2119", "X1481", "X2313", "X2118", "X1480", 
                       "X2314", "X2117", "X1479", "X1873", "X1478", "X2315", 
                       "X2318", "X2317", "X2316", "X2319", "X1477", "X2116", 
                       "X1476", "X2115", "X1401", "X2112", "X1402", "X1400", 
                       "X1475", "X2320", "X1399", "X1403", "X2114", "X2111", 
                       "X1404", "X2113", "X1398", "X1874", "X1405", "X2321", 
                       "X2322", "X1397", "X1406", "X1474", "X1407", "X2324", 
                       "X1396", "X2325", "X2323", "X1408", "X2110", "X1473", 
                       "X1409", "X2326", "X1472", "X2109", "X1395", "X2108", 
                       "X1410", "X1411", "X1412", "X1471", "X2107", "X1394", 
                       "X2327", "X1413", "X2328", "X1875", "X1470", "X2106", 
                       "X1414", "X2105", "X1469", "X1393", "X1415", "X2329", 
                       "X1468", "X2104", "X1416", "X1417", "X1467", "X1392", 
                       "X1466", "X1418", "X2103", "X1419", "X1465", "X2102", 
                       "X1420", "X2101", "X1421", "X1391", "X1876", "X1464", 
                       "X2330", "X1422", "X2100", "X1423", "X1463", "X2336", 
                       "X1462", "X1424", "X2099", "X2334", "X2337", "X1390", 
                       "X2331", "X2335", "X1425", "X2332", "X1461", "X1460", 
                       "X2333", "X2098", "X2097", "X1426", "X1459", "X1458", 
                       "X1427", "X1428", "X1457", "X1456", "X2338", "X1429", 
                       "X1455", "X1389", "X1454", "X2096", "X1430", "X1453", 
                       "X2339", "X1431", "X1432", "X1451", "X1433", "X2095", 
                       "X1452", "X1434", "X1435", "X1877", "X2340", "X1450", 
                       "X1440", "X1441", "X1439", "X1449", "X1438", "X1436", 
                       "X1446", "X1447", "X1437", "X1448", "X1445", "X1444", 
                       "X1443", "X1442", "X2094", "X1388", "X2341", "X2093", 
                       "X2092", "X2091", "X1387", "X2342", "X2090", "X1878", 
                       "X2343", "X2089", "X1386", "X2088", "X2087", "X2344", 
                       "X2346", "X2086", "X1385", "X2347", "X2345", "X2348", 
                       "X2085", "X2349", "X2084", "X1879", "X2353", "X2352", 
                       "X2083", "X2350", "X2351", "X1384", "X2354", "X2355", 
                       "X2082", "X2081", "X1383", "X2080", "X2079", "X2356", 
                       "X2358", "X2359", "X2078", "X1880", "X1382", "X2357", 
                       "X2077", "X2360", "X2076", "X2365", "X2075", "X2361", 
                       "X2366", "X1381", "X2074", "X2364", "X2362", "X2363", 
                       "X2073", "X2370", "X1380", "X2369", "X2072", "X2367", 
                       "X2371", "X2071", "X2368", "X1379", "X2372", "X1378", 
                       "X1377")

# Remove the columns from the dataset
dt <- dt %>% select(-all_of(columns_to_remove))







#write.xlsx(dt, "Project_P_PLS-cv20-A3.xlsx")




# List of columns to remove
columns_to_remove <- c("X1773", "X1691", "X1774", "X1690", "X1689", "X1775", 
                       "X1688", "X1776", "X1687", "X1777", "X1778", "X1779", 
                       "X1686", "X1780", "X1685", "X1781", "X1782", "X1684", 
                       "X1573", "X1574", "X1572", "X1571", "X1683", "X1575", 
                       "X1570", "X1783", "X1566", "X1564", "X1569", "X1576", 
                       "X1565", "X1563", "X1567", "X1568", "X1682", "X1562", 
                       "X1784", "X1577", "X1561", "X1785", "X1560", "X1578", 
                       "X1786", "X1787", "X1681", "X1559", "X1579", "X1581", 
                       "X1582", "X1788", "X1580", "X1789", "X1583", "X1585", 
                       "X1558", "X1584", "X1679", "X1680", "X1586", "X1587", 
                       "X1790", "X1588", "X1557", "X1678", "X1589", "X1556", 
                       "X1590", "X1591", "X1791", "X1555", "X1592", "X1677", 
                       "X1554", "X1792", "X1593", "X1553", "X1594", "X1676", 
                       "X1552", "X1595", "X1793", "X1551", "X1596", "X1675", 
                       "X1550", "X1673", "X1597", "X1794", "X1549", "X1674", 
                       "X1598", "X1599", "X1548", "X1672", "X1601", "X1600", 
                       "X1602", "X1547", "X1603", "X1795", "X1604", "X1671", 
                       "X1605", "X1796", "X1546", "X1606", "X1670", "X1797", 
                       "X1607", "X1608", "X1669", "X1798", "X1609", "X1545", 
                       "X1611", "X1610", "X1612", "X1799", "X1800", "X1668", 
                       "X1613", "X1667", "X1614", "X1544", "X1666", "X1615", 
                       "X1543", "X1617", "X1616", "X1619", "X1618", "X1620", 
                       "X1621", "X1665", "X1542", "X1622", "X1623", "X1624", 
                       "X1625", "X1626", "X1541", "X1627", "X1628", "X1540", 
                       "X1629", "X1664", "X1630", "X1539", "X1631", "X1632", 
                       "X1538", "X1663", "X1633", "X1654", "X1635", "X1634", 
                       "X1653", "X1801", "X1636", "X1655", "X1656", "X1807", 
                       "X1662", "X1637", "X1537", "X1657", "X1806", "X1638", 
                       "X1652", "X1639", "X1660", "X1659", "X1640", "X1658", 
                       "X1808", "X1641", "X1661", "X1642", "X1651", "X1803", 
                       "X1643", "X1802", "X1644", "X1650", "X1814", "X1804", 
                       "X1645", "X1536", "X1649", "X2248", "X1646", "X2249", 
                       "X1648", "X1647", "X1805", "X1815", "X1535", "X1813", 
                       "X1809", "X1816", "X1810", "X2252", "X1817", "X1534", 
                       "X1812", "X2255", "X2253", "X1811", "X2254", "X1533", 
                       "X2256", "X2251", "X2247", "X2250", "X1532", "X2245", 
                       "X1818", "X2246", "X1531", "X1819", "X1824", "X2244", 
                       "X2257", "X1821", "X1823", "X1830", "X1820", "X1829", 
                       "X1828", "X1530", "X1827", "X1831", "X1825", "X1822", 
                       "X1826", "X1832", "X2243", "X1529", "X1833", "X2242", 
                       "X2258", "X1834", "X2259", "X1528", "X1835", "X1527", 
                       "X2260", "X1836", "X2241", "X1838", "X1526", "X1839", 
                       "X1837", "X1840", "X1841", "X1525", "X1842", "X1843", 
                       "X2261", "X1845", "X1524", "X2240", "X1844", "X1846", 
                       "X2262", "X1847", "X1523", "X2263", "X2238", "X2239", 
                       "X1848", "X2237", "X1522", "X2236", "X1849", "X2235", 
                       "X1850", "X1521", "X2264", "X2234", "X1851", "X1520", 
                       "X2233", "X2266", "X1852", "X1519", "X2265", "X2267", 
                       "X2232", "X1518", "X1853", "X2231", "X2230", "X1517", 
                       "X2229", "X1854", "X2268", "X1855", "X2228", "X1516", 
                       "X1856", "X2227", "X2270", "X2269", "X1515", "X2222", 
                       "X1857", "X2226", "X2271", "X2221", "X2225", "X2272", 
                       "X2273", "X1514", "X2223", "X2224", "X1858", "X2220", 
                       "X2219", "X1513", "X2209", "X2274", "X2214", "X2215", 
                       "X2212", "X2211", "X2208", "X2210", "X2213", "X2216", 
                       "X1512", "X1859", "X2279", "X2280", "X2218", "X1511", 
                       "X1860", "X2217", "X1510", "X2207", "X2281", "X2277", 
                       "X2278", "X2206", "X1861", "X1509", "X2275", "X2203", 
                       "X2276", "X2202", "X2205", "X2282", "X2204", "X1508", 
                       "X2201", "X2199", "X2195", "X2200", "X2198", "X2196", 
                       "X2194", "X1862", "X2197", "X2193", "X2192", "X1507", 
                       "X2191", "X2283", "X1863", "X1506", "X2284", "X2190", 
                       "X2189", "X1505", "X2188", "X2285", "X2187", "X2287", 
                       "X2182", "X1864", "X2181", "X1504", "X2286", "X2186", 
                       "X2180", "X2288", "X2183", "X2185", "X2179", "X2184", 
                       "X1503", "X2178", "X2177", "X2289", "X1502", "X2176", 
                       "X2175", "X1865", "X1501", "X2290")

# Remove the columns from the dataset
dt <- dt %>% select(-all_of(columns_to_remove))





#write.xlsx(dt, "Project_P_PLS-cv20-A4.xlsx")




# List of columns to remove
columns_to_remove <- c("X1729", "X1721", "X1728", "X1722", "X1727", "X1730", 
                       "X1720", "X1719", "X1723", "X1718", "X1724", "X1717", 
                       "X1726", "X1731", "X1725", "X1716", "X1732", "X1733", 
                       "X1715", "X1734", "X1735", "X1736", "X1714", "X1737", 
                       "X1738", "X1713", "X1739", "X1740", "X1741", "X1742", 
                       "X1712", "X1743", "X1711", "X1744", "X1710", "X1745", 
                       "X1746", "X1747", "X1709", "X1748", "X1749", "X1750", 
                       "X1708", "X1751", "X1752", "X1753", "X1754", "X1755", 
                       "X1707", "X1756", "X1757", "X1706", "X1758", "X1759", 
                       "X1760", "X1705", "X1761", "X1762", "X1704", "X1763", 
                       "X1764", "X1703", "X1765", "X1702", "X1766", "X1701", 
                       "X1700", "X1699", "X1767", "X1698", "X1697", "X1768", 
                       "X1696", "X1695", "X1769", "X1694", "X1693", "X1770", 
                       "X1692", "X1771", "X1772", "X1910", "X1912", "X1911", 
                       "X1946", "X1951", "X1913", "X1914", "X1916", "X1945", 
                       "X1915", "X1944", "X1943", "X1917", "X1941", "X1940", 
                       "X1942", "X1918", "X1933", "X1919", "X1939", "X1937", 
                       "X1936", "X1931", "X1935", "X1925", "X1932", "X1920", 
                       "X1934", "X1927", "X1938", "X1929", "X1926", "X1928", 
                       "X1921", "X1930", "X1922", "X1924", "X1923", "X1218", 
                       "X1295", "X1219", "X1220", "X1167", "X1294", "X1221", 
                       "X1166", "X1222", "X1223", "X1293", "X1224", "X1165", 
                       "X1225", "X1226", "X1227", "X1292", "X1228", "X1164", 
                       "X1229", "X1291", "X1230", "X1231", "X1232", "X1163", 
                       "X1290", "X1233", "X1234", "X1235", "X1289", "X1236", 
                       "X1162", "X1237", "X1238", "X1288", "X1239", "X1287", 
                       "X1161", "X1286", "X1240", "X1285", "X1241", "X1242", 
                       "X1243", "X1284", "X1160", "X1245", "X1244", "X1283", 
                       "X1246", "X1282", "X1281", "X1247", "X1280", "X1279", 
                       "X1159", "X1248", "X1249", "X1278", "X1250", "X1251", 
                       "X1252", "X1253", "X1277", "X1254", "X1255", "X1256", 
                       "X1276", "X1257", "X1263", "X1264", "X1258", "X1259", 
                       "X1260", "X1158", "X1261", "X1271", "X1262", "X1265", 
                       "X1270", "X1272", "X1275", "X1273", "X1267", "X1266", 
                       "X1274", "X1269", "X1268", "X1157", "X1156", "X1155", 
                       "X1154", "X1153", "X1152", "X1151", "X971", "X972", 
                       "X967", "X966", "X974", "X975", "X973", "X970", "X968", 
                       "X979", "X978", "X1150", "X965", "X963", "X981", "X969", 
                       "X982", "X977", "X980", "X962", "X976", "X964", "X983", 
                       "X988", "X1149", "X984", "X987", "X960", "X961", "X986", 
                       "X985", "X959", "X442", "X991", "X989", "X992", "X437", 
                       "X958", "X436", "X1148", "X990", "X993", "X994", "X995", 
                       "X957", "X438", "X996", "X999", "X956", "X1147", "X998", 
                       "X443", "X997", "X955", "X435", "X1000", "X953", "X954", 
                       "X1146", "X431", "X952", "X432", "X430", "X439", "X441", 
                       "X1145", "X951", "X950", "X440", "X949", "X1144", "X429", 
                       "X948", "X947", "X433", "X444", "X782", "X781", "X779", 
                       "X780", "X783", "X778", "X786", "X946", "X777", "X1143")

# Remove the columns from the dataset
dt <- dt %>% select(-all_of(columns_to_remove))




#write.xlsx(dt, "Project_P_PLS-cv20-A5.xlsx")




# List of columns to remove
columns_to_remove <- c("X776", "X785", "X784", "X787", "X775", "X774", "X434", "X788", 
                       "X862", "X792", "X861", "X773", "X863", "X858", "X791", "X423", 
                       "X875", "X860", "X859", "X857", "X864", "X856", "X945", "X772", 
                       "X789", "X867", "X869", "X942", "X771", "X850", "X866", "X941", 
                       "X790", "X855", "X870", "X868", "X770", "X865", "X852", "X851", 
                       "X849", "X872", "X853", "X793", "X874", "X873", "X854", "X839", 
                       "X871", "X876", "X848", "X840", "X847", "X769", "X794", "X842", 
                       "X841", "X943", "X885", "X944", "X843", "X795", "X887", "X838", 
                       "X878", "X888", "X877", "X886", "X846", "X940", "X879", "X880", 
                       "X768", "X889", "X796", "X1142", "X844", "X845", "X428", "X884", 
                       "X881", "X890", "X797", "X837", "X898", "X897", "X798", "X836", 
                       "X893", "X891", "X883", "X835", "X937", "X938", "X882", "X834", 
                       "X799", "X448", "X800", "X896", "X767", "X894", "X899", "X939", 
                       "X801", "X892", "X833", "X895", "X936", "X804", "X805", "X832", 
                       "X802", "X831", "X932", "X928", "X418", "X933", "X830", "X803", 
                       "X934", "X931", "X935", "X927", "X902", "X766", "X903", "X906", 
                       "X422", "X929", "X900", "X930", "X926", "X829", "X901", "X924", 
                       "X925", "X806", "X905", "X921", "X919", "X445", "X918", "X920", 
                       "X807", "X424", "X824", "X823", "X808", "X828", "X923", "X912", 
                       "X913", "X904", "X825", "X1141", "X907", "X915", "X916", "X822", 
                       "X922", "X827", "X917", "X809", "X826", "X914", "X765", "X821", 
                       "X911", "X811", "X820", "X908", "X810", "X909", "X812", "X815", 
                       "X910", "X816", "X819", "X817", "X818", "X814", "X813", "X764", 
                       "X447", "X1140", "X763", "X427", "X446", "X419", "X762", "X1139", 
                       "X761", "X1138", "X760", "X1137", "X421", "X759", "X449", "X1136", 
                       "X1005", "X420", "X1002", "X1004", "X1003", "X1006", "X1135", 
                       "X1001", "X758", "X426", "X1007", "X414", "X425", "X1134", "X1008", 
                       "X757", "X454", "X1009", "X451", "X1133", "X1010", "X455", "X450", 
                       "X1013", "X1011", "X1132", "X1012", "X1014", "X453", "X1015", 
                       "X756", "X452", "X1131", "X1016", "X456", "X1130", "X1017", "X1018", 
                       "X1129", "X1128", "X755", "X1019", "X1127", "X1020", "X1021", 
                       "X1022", "X1126", "X1023", "X1125", "X1024", "X1124", "X415", 
                       "X1123", "X1122", "X1121", "X1025", "X1120", "X1119", "X754", 
                       "X413", "X417", "X1118", "X1117", "X1026", "X1116", "X1115", 
                       "X1028", "X1027", "X1114", "X1029", "X1030", "X457", "X1031", 
                       "X1113", "X1111")

# Remove the columns from the dataset
dt <- dt %>% select(-all_of(columns_to_remove))






#write.xlsx(dt, "Project_P_PLS-cv20-A6.xlsx")





# List of columns to remove
columns_to_remove <- c("X1112", "X1110", "X1109", "X1032", "X1108", "X1107", "X1105", 
                       "X1098", "X1106", "X1099", "X1104", "X1033", "X472", "X753", 
                       "X1097", "X1103", "X1034", "X1102", "X1096", "X1100", "X1035", 
                       "X1101", "X1036", "X1038", "X1037", "X1095", "X1039", "X405", 
                       "X1092", "X1091", "X1090", "X1093", "X1089", "X411", "X1094", 
                       "X1040", "X462", "X473", "X1041", "X1088", "X1087", "X1086", 
                       "X1042", "X1085", "X1084", "X410", "X1083", "X1082", "X1081", 
                       "X1043", "X463", "X460", "X1078", "X1077", "X471", "X1080", 
                       "X752", "X459", "X416", "X1079", "X1044", "X1076", "X412", 
                       "X1075", "X1074", "X409", "X1045", "X1073", "X1046", "X1072", 
                       "X458", "X465", "X461", "X1047", "X1071", "X404", "X1070", 
                       "X1055", "X1048", "X1051", "X1049", "X1054", "X1050", "X1052", 
                       "X1053", "X1056", "X1057", "X1067", "X1066", "X1069", "X400", 
                       "X468", "X1058", "X466", "X1060", "X1068", "X474", "X1059", 
                       "X1061", "X1062", "X1063", "X464")

# Remove the columns from the dataset
dt <- dt %>% select(-all_of(columns_to_remove))







#write.xlsx(dt, "Project_P_PLS-cv20-A7.xlsx")



# Additional columns to remove
additional_columns_to_remove <- c("X1065", "X1064", "X467", "X751", "X406", "X470", 
                                  "X408", "X403", "X475", "X469", "X476", "X479", 
                                  "X750", "X478", "X480", "X477", "X481", "X483", 
                                  "X407", "X484", "X482", "X749", "X402", "X485", 
                                  "X486", "X748", "X487", "X401", "X747", "X488", 
                                  "X673", "X674", "X672", "X671", "X489", "X675", 
                                  "X676", "X490", "X746", "X670", "X677", "X491", 
                                  "X669", "X678", "X745", "X679", "X668", "X680", 
                                  "X667", "X744", "X492", "X494", "X681", "X493", 
                                  "X666", "X682", "X743", "X495", "X665", "X683", 
                                  "X742", "X496", "X664", "X497", "X741", "X684", 
                                  "X663", "X498", "X740", "X685", "X662", "X499", 
                                  "X739", "X661", "X686", "X500", "X660", "X738", 
                                  "X501", "X659", "X737", "X502", "X658", "X687", 
                                  "X657", "X736", "X503", "X656", "X655", "X654", 
                                  "X653", "X735", "X688", "X504", "X652", "X651", 
                                  "X505", "X734", "X650", "X649", "X506", "X689", 
                                  "X733", "X648")

# Remove the additional columns from the dataset
dt <- dt %>% select(-all_of(additional_columns_to_remove))




#write.xlsx(dt, "Project_P_PLS-cv20-A8.xlsx")





# Additional columns to remove
additional_columns_to_remove <- c("X647", "X732", "X507", "X646", "X731", "X690", 
                                  "X508", "X645", "X644", "X730", "X509", "X643", 
                                  "X729", "X691", "X642", "X510", "X728", "X641", 
                                  "X640", "X511", "X727", "X639", "X692", "X726", 
                                  "X512", "X638", "X637", "X725", "X636", "X513", 
                                  "X635", "X724", "X634", "X633", "X632", "X631", 
                                  "X693", "X630", "X514", "X723", "X629", "X628", 
                                  "X627", "X626", "X625", "X624", "X722", "X623", 
                                  "X622")

# Remove the additional columns from the dataset
dt <- dt %>% select(-all_of(additional_columns_to_remove))





#write.xlsx(dt, "Project_P_PLS-cv20-A9.xlsx")




# Additional columns to remove
additional_columns_to_remove <- c("X515", "X721", "X621", "X620", "X619", "X694", 
                                  "X720", "X516", "X618", "X617", "X719", "X616", 
                                  "X615", "X517", "X718", "X614", "X717", "X613", 
                                  "X695", "X612", "X716", "X611", "X518", "X610", 
                                  "X715", "X609", "X607", "X606", "X608", "X600", 
                                  "X605", "X599", "X519", "X598", "X604", "X603", 
                                  "X601", "X602", "X714", "X597", "X596", "X552", 
                                  "X696", "X713", "X553", "X520", "X595", "X551", 
                                  "X555", "X554", "X556", "X594", "X557", "X550", 
                                  "X548", "X549", "X558", "X593", "X547", "X559", 
                                  "X592", "X712", "X546", "X560", "X545", "X544")

# Remove the additional columns from the dataset
dt <- dt %>% select(-all_of(additional_columns_to_remove))



#write.xlsx(dt, "Project_P_PLS-cv20-A10.xlsx")



# Additional columns to remove
additional_columns_to_remove <- c("X543", "X542", "X591", "X561", "X521", "X541", 
                                  "X711", "X590", "X540", "X562", "X539", "X589", 
                                  "X538", "X563", "X697", "X564", "X537", "X710", 
                                  "X588", "X565", "X522", "X536", "X535", "X523", 
                                  "X566", "X587", "X709", "X586", "X534")

# Remove the additional columns from the dataset
dt <- dt %>% select(-all_of(additional_columns_to_remove))



#write.xlsx(dt, "Project_P_PLS-cv20-A11.xlsx")






colnames(dt)[149] #here the hyper cols starts 

# Get column names for the relevant columns (149 to 296)
relevant_columns <- names(dt)[149:188]

# Function to calculate the index for a pair of columns
calculate_index <- function(col1, col2) {
  (dt[[col1]] - dt[[col2]]) / (dt[[col1]] + dt[[col2]])
}

# Create a dataframe to hold the names of new indices and their R-squared values
results <- data.frame(Index = character(), R_squared = numeric(), stringsAsFactors = FALSE)

# Iterate over the pairs of columns to create new indices and calculate R-squared values
for (i in 1:(length(relevant_columns) - 1)) {
  for (j in (i + 1):length(relevant_columns)) {
    col1 <- relevant_columns[i]
    col2 <- relevant_columns[j]
    new_col_name <- paste(col1, col2, sep = "_")
    dt[[new_col_name]] <- calculate_index(col1, col2)
    
    # Calculate the R-squared value
    model <- lm(dt[[new_col_name]] ~ dt$Zn_PXRF_mean, data = dt)
    r_squared <- summary(model)$r.squared
    
    # Add the result to the results dataframe
    results <- rbind(results, data.frame(Index = new_col_name, R_squared = r_squared))
  }
}

# View the results dataframe
print(results)


write.xlsx(results, "Project_P_PLS-cv20-A11_Normalized_Index.xlsx")




colnames(dt)[149] #here the hyper cols starts 

# Get column names for the relevant columns (149 to 296)
relevant_columns <- names(dt)[149:188]

# Function to calculate the index for a pair of columns
calculate_index <- function(col1, col2) {
  (dt[[col1]]) / (dt[[col2]])
}

# Create a dataframe to hold the names of new indices and their R-squared values
results <- data.frame(Index = character(), R_squared = numeric(), stringsAsFactors = FALSE)

# Iterate over the pairs of columns to create new indices and calculate R-squared values
for (i in 1:(length(relevant_columns) - 1)) {
  for (j in (i + 1):length(relevant_columns)) {
    col1 <- relevant_columns[i]
    col2 <- relevant_columns[j]
    new_col_name <- paste(col1, col2, sep = "_")
    dt[[new_col_name]] <- calculate_index(col1, col2)
    
    # Calculate the R-squared value
    model <- lm(dt[[new_col_name]] ~ dt$Zn_PXRF_mean, data = dt)
    r_squared <- summary(model)$r.squared
    
    # Add the result to the results dataframe
    results <- rbind(results, data.frame(Index = new_col_name, R_squared = r_squared))
  }
}

# View the results dataframe
print(results)


write.xlsx(results, "Project_P_PLS-cv20-A11_Ratio_Index.xlsx")





colnames(dt)[149] #here the hyper cols starts 

# Get column names for the relevant columns (149 to 296)
relevant_columns <- names(dt)[149:188]

# Function to calculate the index for a pair of columns
calculate_index <- function(col1, col2) {
  (dt[[col1]]) - (dt[[col2]])
}

# Create a dataframe to hold the names of new indices and their R-squared values
results <- data.frame(Index = character(), R_squared = numeric(), stringsAsFactors = FALSE)

# Iterate over the pairs of columns to create new indices and calculate R-squared values
for (i in 1:(length(relevant_columns) - 1)) {
  for (j in (i + 1):length(relevant_columns)) {
    col1 <- relevant_columns[i]
    col2 <- relevant_columns[j]
    new_col_name <- paste(col1, col2, sep = "_")
    dt[[new_col_name]] <- calculate_index(col1, col2)
    
    # Calculate the R-squared value
    model <- lm(dt[[new_col_name]] ~ dt$Zn_PXRF_mean, data = dt)
    r_squared <- summary(model)$r.squared
    
    # Add the result to the results dataframe
    results <- rbind(results, data.frame(Index = new_col_name, R_squared = r_squared))
  }
}

# View the results dataframe
print(results)


write.xlsx(results, "Project_P_PLS-cv20-A11_difference_Index.xlsx")


### VIS OF BEST INDICIES



setwd("C:/Users/twlodarczyk/OneDrive - University of Arizona/Desktop/All documents/1 PhD/CNRS + Synch/Hyperspectral Research/1_Experiment/1_Experiment_P/Spreadsheet/PLS")
dt <-read.delim("Project_P_pXRF_HP_Hyper.txt")


dt <- dt %>%
  filter(Zn_PXRF_cv < 0.2)

dt <- dt %>%
  filter(Status == "A")

dt <- dt %>%
  mutate(VI707_708 = (X707 - X708) / (X707 + X708))

# Create the plot

ggplot(dt, aes(x = Zn_PXRF_mean, y = VI707_708, color = Status)) + 
  geom_point(size=3) +  # adds the scatter plot points
  theme_minimal() + 
  labs(title = "",
       x = "Zn conc in leaf",
       y = "VI707_708")


ggplot(dt, aes(x = Zn_PXRF_mean, y = X702, color = Status)) + 
  geom_point(size=3) +  # adds the scatter plot points
  theme_minimal() + 
  scale_y_continuous(limits = c(0, 0.3), breaks = seq(0, 0.3, by = 0.05)) +
  labs(title = "",
       x = "Zn conc in leaf",
       y = "VI707_708")





}



# PLS cv < 20% and Chlorosis only
{

setwd("C:/Users/twlodarczyk/OneDrive - University of Arizona/Desktop/All documents/1 PhD/CNRS + Synch/Hyperspectral Research/1_Experiment/1_Experiment_P/Spreadsheet/PLS")
dt <-read.delim("Project_P_pXRF_HP_Hyper.txt")


dt <- dt %>%
  filter(Zn_PXRF_cv < 0.2)

dt <- dt %>%
  filter(Status == "C")


#write.xlsx(dt, "Project_P_PLS-cv20-C.xlsx")




# Additional columns to remove
additional_columns_to_remove <- c("X1960", "X1922", "X1958", "X1921", "X1918", "X1957", "X1919", "X1370", 
                                  "X1956", "X1923", "X1955", "X1954", "X1924", "X1928", "X1369", "X1949", 
                                  "X1929", "X1930", "X1953", "X1948", "X1950", "X1951", "X1927", "X1952", 
                                  "X1926", "X1925", "X1947", "X1946", "X1931", "X1944", "X1945", "X1932", 
                                  "X1942", "X1943", "X1941", "X1933", "X1934", "X1368", "X1940", "X1937", 
                                  "X1939", "X1938", "X1935", "X1936", "X1367", "X1366", "X1365", "X1364", 
                                  "X1363", "X1362", "X1361", "X1360", "X1359", "X1358", "X1357", "X1356", 
                                  "X1355", "X1354", "X1353", "X1352", "X1351", "X1350", "X1349", "X1348", 
                                  "X1347", "X441", "X1346", "X442", "X440", "X1345", "X438", "X434", "X439", 
                                  "X437", "X435", "X427", "X1344", "X436", "X433", "X1343", "X443", "X423", 
                                  "X1342", "X430", "X446", "X429", "X432", "X444", "X431", "X445", "X1341", 
                                  "X447", "X424", "X428", "X426", "X448", "X1340", "X422", "X449", "X1339", 
                                  "X450", "X1338", "X420", "X1337", "X425", "X416", "X451", "X417", "X1336", 
                                  "X452", "X414", "X419", "X421", "X457", "X1335", "X462", "X453", "X415", 
                                  "X1334", "X461", "X476", "X475", "X472", "X471", "X460", "X458", "X459", 
                                  "X477", "X478", "X1333", "X463", "X456", "X408", "X470", "X481", "X407", 
                                  "X473", "X465", "X1332", "X454", "X464", "X479", "X480", "X469", "X474", 
                                  "X466", "X1331", "X482", "X468", "X486", "X467", "X1330", "X669", "X670", 
                                  "X455", "X418", "X487", "X409", "X668", "X671", "X667", "X483", "X413", 
                                  "X1329", "X485", "X484", "X672", "X652", "X651", "X666", "X653", "X654", 
                                  "X650", "X665", "X1328", "X655", "X649", "X673", "X410", "X656", "X406", 
                                  "X488", "X664", "X401", "X1327", "X657", "X648", "X663", "X658", "X411", 
                                  "X662", "X402", "X659", "X1326", "X661", "X660", "X489", "X647", "X674", 
                                  "X1325", "X490", "X412", "X1324", "X646", "X491", "X1323", "X675", "X403", 
                                  "X1322", "X645", "X492", "X405", "X1321", "X1320", "X404", "X644", "X493", 
                                  "X676", "X1319", "X400", "X643", "X1318", "X494", "X1317", "X1316", "X642", 
                                  "X677", "X1315", "X495", "X1314", "X641", "X1313", "X1312", "X640", "X1311", 
                                  "X496", "X1310", "X678", "X1309", "X639", "X497", "X1308", "X1307", "X638", 
                                  "X498", "X1306", "X1305", "X637", "X602", "X604", "X603", "X601", "X1304", 
                                  "X605", "X600", "X599", "X606", "X1303", "X679", "X636", "X598", "X607", 
                                  "X1302", "X499", "X608", "X597", "X1301", "X596", "X595", "X609", "X635", 
                                  "X1300", "X594", "X610", "X1299", "X611", "X593", "X634", "X1298", "X592", 
                                  "X612", "X500", "X711", "X710", "X591", "X712", "X633", "X709", "X1297", 
                                  "X613", "X713", "X708", "X632", "X1296", "X590", "X589", "X614", "X631", 
                                  "X1193", "X714", "X1192", "X1194", "X1195", "X1196", "X1199", "X615", 
                                  "X1191", "X1200", "X1185", "X1295", "X1184", "X707", "X1190", "X569", 
                                  "X1197", "X1198", "X568", "X1201", "X1189", "X588", "X630", "X1183", 
                                  "X1188", "X570", "X629", "X1186", "X1182", "X1187", "X567", "X1202", 
                                  "X1181", "X571")

# Remove the additional columns from the dataset
dt <- dt %>% select(-all_of(additional_columns_to_remove))


#write.xlsx(dt, "Project_P_PLS-cv20-C2.xlsx")




# Additional columns to remove
additional_columns_to_remove <- c("X2422", "X2005", "X1899", "X2421", "X2425", "X2004", "X2418", "X1380", 
                                  "X2003", "X2429", "X2426", "X2420", "X2002", "X2419", "X2001", "X1900", 
                                  "X2000", "X1999", "X2432", "X1379", "X2430", "X2431", "X1998", "X1901", 
                                  "X2427", "X2428", "X1997", "X1996", "X1995", "X1994", "X1378", "X2433", 
                                  "X1902", "X1993", "X1992", "X2438", "X1903", "X2436", "X1991", "X2439", 
                                  "X2435", "X1990", "X1377", "X2437", "X1989", "X2440", "X1988", "X1904", 
                                  "X2434", "X1987", "X2441", "X1986", "X1905", "X1376", "X1985", "X1984", 
                                  "X1906", "X1983", "X1982", "X2442", "X1981", "X1980", "X2447", "X1375", 
                                  "X2448", "X2443", "X2444", "X1978", "X1979", "X1907", "X2445", "X1977", 
                                  "X1908", "X1374", "X1976", "X1909", "X2446", "X1975", "X1974", "X1910", 
                                  "X1973", "X1972", "X1373", "X1971", "X1911", "X1970", "X1912", "X1969", 
                                  "X1913", "X1372", "X1914", "X1968", "X1915", "X1967", "X2449", "X1916", 
                                  "X1966", "X1965", "X1963", "X1964", "X1371", "X1917", "X1962", "X1961", 
                                  "X1920", "X1959", "X1294", "X1180", "X1179", "X616", "X1178", "X572", 
                                  "X566", "X628", "X1177", "X1203", "X556", "X1176", "X565", "X623", 
                                  "X557", "X573", "X1204", "X619", "X564", "X1175", "X715", "X1205", 
                                  "X563", "X617", "X627", "X1293", "X555", "X618", "X1174", "X587", 
                                  "X620", "X1206", "X706", "X562", "X624", "X558", "X1207", "X680", 
                                  "X560", "X1209", "X1208", "X561", "X586", "X574", "X621", "X559", 
                                  "X1173", "X625", "X1210", "X622", "X1172", "X585", "X554", "X1171", 
                                  "X1170", "X626", "X1292", "X553", "X575", "X1211", "X1169", "X577", 
                                  "X1168", "X584", "X576", "X501", "X1212", "X552", "X1167", "X578", 
                                  "X1213", "X583", "X1291", "X579", "X1214", "X580", "X582", "X1166", 
                                  "X551", "X1215", "X581", "X716", "X705", "X1216", "X1217", "X1218", 
                                  "X1165", "X1290", "X550", "X1219", "X1220", "X1221", "X549", "X1164", 
                                  "X1222", "X548", "X1289", "X1223", "X547", "X1163", "X704", "X1224", 
                                  "X717", "X1162", "X1288", "X1225", "X546", "X1287", "X1226", "X1161", 
                                  "X545", "X1227", "X1228", "X1286", "X502", "X544", "X1229", "X543", 
                                  "X1160", "X1230", "X1232", "X542", "X1231", "X1233", "X1285", "X1234", 
                                  "X541", "X1235", "X540", "X703", "X1236", "X1284", "X539", "X538", 
                                  "X1159", "X1237", "X718", "X1238", "X536", "X537", "X1239", "X535", 
                                  "X1283", "X1240", "X1241", "X1282", "X1242", "X534", "X1281", "X1243", 
                                  "X531", "X532", "X1244", "X503", "X533", "X1280", "X1158", "X1245", 
                                  "X1246", "X1247", "X1279", "X530", "X1248", "X1278", "X1249", "X1277", 
                                  "X1250", "X1275", "X1276", "X1274", "X1273", "X1157", "X1251", "X529", 
                                  "X702", "X681", "X1272", "X1253", "X1252", "X504", "X1254", "X1271", 
                                  "X719", "X1270", "X1255", "X528", "X1256", "X1269", "X1257", "X1258", 
                                  "X1268", "X1259", "X527", "X1260", "X1261", "X1266", "X1262", "X1267", 
                                  "X1265", "X1156", "X1263", "X1264", "X526", "X525", "X1155", "X524", 
                                  "X701", "X1154", "X720", "X523", "X505", "X522", "X1153", "X521", 
                                  "X506", "X700", "X1152", "X721", "X520", "X507", "X1151", "X518", 
                                  "X519", "X682", "X517", "X699", "X1150", "X508", "X509", "X516", 
                                  "X722", "X515", "X510", "X1149", "X514", "X513", "X511", "X512", 
                                  "X1148", "X698", "X723", "X1147", "X683", "X1146", "X697", "X1145", 
                                  "X724", "X1144", "X1143", "X696", "X1142", "X725", "X684", "X1141", 
                                  "X695", "X1140")

# Remove the additional columns from the dataset
dt <- dt %>% select(-all_of(additional_columns_to_remove))




#write.xlsx(dt, "Project_P_PLS-cv20-C3.xlsx")



# Columns to remove
columns_to_remove <- c("X1023", "X1123", "X954", "X1125", "X1124", "X1022", "X1126", "X1021", "X1127", 
                       "X728", "X1020", "X955", "X1128", "X692", "X1019", "X1018", "X1129", "X956", 
                       "X686", "X1017", "X1130", "X998", "X957", "X1016", "X1014", "X997", "X1015", 
                       "X1131", "X1013", "X958", "X1000", "X1012", "X1132", "X1011", "X999", "X959", 
                       "X1010", "X1007", "X1008", "X996", "X1009", "X1133", "X960", "X1006", "X994", 
                       "X993", "X693", "X1005", "X1134", "X995", "X992", "X1004", "X1003", "X964", 
                       "X991", "X963", "X961", "X727", "X1002", "X990", "X962", "X1001", "X1135", 
                       "X985", "X986", "X966", "X967", "X987", "X965", "X984", "X975", "X989", "X1136", 
                       "X972", "X981", "X968", "X988", "X977", "X974", "X982", "X971", "X976", "X978", 
                       "X973", "X980", "X969", "X970", "X1137", "X685", "X983", "X979", "X694", "X1138", 
                       "X726", "X1139", "X2417", "X2006", "X1381", "X2007", "X1898", "X2008", "X2424", 
                       "X2010", "X2009", "X2423", "X2416", "X2011", "X1382", "X2415", "X2012", "X2414", 
                       "X1897", "X2412", "X2013", "X2014", "X2413", "X2016", "X2015", "X2017", "X2411", 
                       "X1383", "X2018", "X1896", "X2019", "X2020", "X2408", "X2407", "X2021", "X1384", 
                       "X2022", "X2023", "X2406", "X2405", "X1895", "X2024", "X2025", "X2410", "X2026", 
                       "X2409", "X1385", "X2396", "X2027", "X2028", "X2401", "X2402", "X2395", "X2029", 
                       "X2404", "X1894", "X2030", "X2031", "X2397", "X2403", "X2398", "X2032", "X2400", 
                       "X1386", "X2033", "X2399", "X1893", "X2034", "X2036", "X2394", "X2035", "X2037", 
                       "X2038", "X2393", "X1387", "X2039", "X2040", "X1892", "X2041", "X1667", "X1668", 
                       "X1669", "X1666", "X1672", "X1670", "X1673", "X1671", "X1665", "X1674", "X1664", 
                       "X2392", "X1675", "X2042", "X1663", "X1662", "X1676", "X1661", "X1657", "X1658", 
                       "X1659", "X1656", "X1660", "X1677", "X1678", "X1679", "X1655", "X1680", "X1654", 
                       "X1681", "X2043", "X1653", "X1682", "X1652", "X1683", "X1651", "X1650", "X1684", 
                       "X1649", "X1685", "X2390", "X1686", "X2384", "X1648", "X1687", "X1688", "X1388", 
                       "X2389", "X2044", "X2383", "X1689", "X1690", "X2045", "X1647", "X1691", "X1692", 
                       "X2391", "X1646", "X1891", "X1693", "X1694", "X1695", "X2046", "X1696", "X1645", 
                       "X1697", "X2388", "X1698", "X2047", "X2382", "X1644", "X1699", "X1642", "X1643", 
                       "X1641", "X1640", "X1700", "X2381", "X1639", "X2048", "X1701", "X2385", "X2386", 
                       "X2387", "X1638", "X1702", "X1637", "X1703", "X2049", "X1636", "X1704", "X1635", 
                       "X1705", "X1634", "X1633", "X2050", "X1706", "X1632", "X1707", "X1631", "X1389", 
                       "X1630", "X2051", "X1629", "X1708", "X2052", "X1628", "X1709", "X1890", "X1710", 
                       "X1627", "X2053", "X1626", "X1711", "X1625", "X2380", "X2054", "X1624", "X1712", 
                       "X1623", "X2055", "X1622", "X1713", "X1620", "X1621", "X2371", "X2378", "X1619", 
                       "X2379", "X2372", "X1618", "X2377", "X1714", "X2374", "X2373", "X2056", "X1617", 
                       "X2057", "X1715", "X1390")

# Remove the columns from the dataset
dt <- dt %>% select(-all_of(columns_to_remove))





#write.xlsx(dt, "Project_P_PLS-cv20-C4.xlsx")






# Additional columns to remove
additional_columns_to_remove <- c("X769", "X770", "X771", "X772", "X773", "X774", "X735", "X775", "X776", "X777",
                                  "X778", "X779", "X780", "X781", "X782", "X783", "X784", "X785", "X786", "X734",
                                  "X787", "X788", "X789", "X790", "X791", "X793", "X792", "X794", "X796", "X795",
                                  "X797", "X803", "X798", "X806", "X804", "X805", "X800", "X802", "X799", "X801",
                                  "X812", "X807", "X809", "X808", "X811", "X813", "X810", "X814", "X815", "X817",
                                  "X816", "X818", "X821", "X822", "X819", "X820", "X823", "X824", "X825", "X826",
                                  "X827", "X828", "X829", "X733", "X830", "X831", "X832", "X833", "X834", "X835",
                                  "X836", "X837", "X838", "X839", "X840", "X843", "X841", "X842", "X844", "X845",
                                  "X846", "X848", "X847", "X849", "X850", "X851", "X852", "X853", "X855", "X854",
                                  "X856", "X857", "X859", "X860", "X858", "X861", "X732", "X863", "X862", "X864",
                                  "X865", "X870", "X866", "X871", "X869", "X867", "X875", "X872", "X876", "X882",
                                  "X868", "X877", "X874", "X878", "X873", "X883", "X879", "X881", "X890", "X880",
                                  "X884", "X894", "X889", "X891", "X886", "X887", "X888", "X885", "X895", "X893",
                                  "X892", "X898", "X897", "X899", "X896", "X905", "X904", "X906", "X903", "X902",
                                  "X900", "X901", "X910", "X909", "X911", "X908", "X907", "X914", "X912", "X918",
                                  "X913", "X917", "X915", "X916", "X919", "X920", "X921", "X922", "X731", "X923",
                                  "X924", "X925", "X926", "X927", "X928", "X929", "X930", "X931", "X932", "X933",
                                  "X934", "X935", "X936", "X937", "X938", "X939", "X940", "X730", "X941", "X942",
                                  "X943", "X944", "X945", "X946", "X947", "X1057", "X1048", "X1047", "X1056", "X1055",
                                  "X1061", "X1054", "X1058", "X1060", "X1062", "X1053", "X1063", "X1071", "X1059",
                                  "X1070", "X1049", "X1064", "X1046", "X1069", "X1050", "X1068", "X1065", "X1045",
                                  "X1077", "X1075", "X1052", "X1051", "X1076", "X948", "X1072", "X1078", "X689", 
                                  "X1074", "X1073", "X1044", "X1079", "X1067", "X1066", "X1043", "X1080", "X1042",
                                  "X949", "X729", "X688", "X1081", "X1041", "X1082", "X690", "X1091", "X1092", "X1085",
                                  "X1086", "X1087", "X1088", "X1083", "X1084", "X950", "X1089", "X1093", "X1090", 
                                  "X1040", "X1094", "X1098", "X1039", "X1095", "X1099", "X1038", "X1096", "X1037", 
                                  "X1097", "X1036", "X1035", "X1102", "X1034", "X1103", "X1100", "X1101", "X1104", 
                                  "X1105", "X1033", "X951", "X1108", "X1106", "X1109", "X1032", "X1107", "X1110", 
                                  "X1031", "X952", "X1111", "X1030", "X1112", "X691", "X1115", "X687", "X1116", 
                                  "X1114", "X1117", "X1029", "X1113", "X1027", "X1118", "X1026", "X1028", "X953", 
                                  "X1119", "X1025", "X1120", "X1024", "X1121", "X1122", "X1616", "X2375", "X2376", 
                                  "X1716", "X1615", "X2058", "X1614", "X1717", "X1613", "X1889", "X1718", "X2059", 
                                  "X1612", "X2370", "X1611", "X1719", "X2060", "X1610", "X1609", "X1720", "X2061", 
                                  "X1608", "X1607", "X1721", "X2365", "X2062", "X1606", "X1722", "X2063", "X1605", 
                                  "X1723", "X1391", "X2064", "X2369", "X2362", "X1604", "X2065", "X1724", "X1603", 
                                  "X2366", "X2364", "X2363", "X1725", "X1602", "X1888", "X1601", "X2368", "X1726", 
                                  "X2066", "X1600", "X1727", "X2359", "X1599", "X1598", "X2067", "X2361", "X1728", 
                                  "X1597", "X2068", "X2367", "X1596", "X1729", "X2360", "X1595", "X1392", "X1730", 
                                  "X1594", "X2069")

# Remove the additional columns from the dataset
dt <- dt %>% select(-all_of(additional_columns_to_remove))


write.xlsx(dt, "Project_P_PLS-cv20-C5.xlsx")



############back to C4 and remove 113 instead of 364

# Columns to remove
columns_to_remove <- c("X946", "X947", "X1057", "X1048", "X1047", "X1056", "X1055", "X1061", "X1054", "X1058", "X1060", 
                       "X1062", "X1053", "X1063", "X1071", "X1059", "X1070", "X1049", "X1064", "X1046", "X1069", "X1050", 
                       "X1068", "X1065", "X1045", "X1077", "X1075", "X1052", "X1051", "X1076", "X948", "X1072", "X1078", 
                       "X689", "X1074", "X1073", "X1044", "X1079", "X1067", "X1066", "X1043", "X1080", "X1042", "X949", 
                       "X729", "X688", "X1081", "X1041", "X1082", "X690", "X1091", "X1092", "X1085", "X1086", "X1087", 
                       "X1088", "X1083", "X1084", "X950", "X1089", "X1093", "X1090", "X1040", "X1094", "X1098", "X1039", 
                       "X1095", "X1099", "X1038", "X1096", "X1037", "X1097", "X1036", "X1035", "X1102", "X1034", "X1103", 
                       "X1100", "X1101", "X1104", "X1105", "X1033", "X951", "X1108", "X1106", "X1109", "X1032", "X1107", 
                       "X1110", "X1031", "X952", "X1111", "X1030", "X1112", "X691", "X1115", "X687", "X1116", "X1114", 
                       "X1117", "X1029", "X1113", "X1027", "X1118", "X1026", "X1028", "X953", "X1119", "X1025", "X1120", 
                       "X1024", "X1121", "X1122")

# Remove the specified columns from the dataset
dt <- dt %>% select(-all_of(columns_to_remove))



write.xlsx(dt, "Project_P_PLS-cv20-C6.xlsx")





setwd("C:/Users/twlodarczyk/OneDrive - University of Arizona/Desktop/All documents/1 PhD/CNRS + Synch/Hyperspectral Research/1_Experiment/1_Experiment_P/Spreadsheet/PLS/cv20-C")
dt <-read.delim("Project_P_PLS-cv20-C4.txt")


colnames(dt)[149] #here the hyper cols starts 

# Get column names for the relevant columns (149 to 296)
relevant_columns <- names(dt)[149:1192]

# Function to calculate the index for a pair of columns
calculate_index <- function(col1, col2) {
  (dt[[col1]] - dt[[col2]]) / (dt[[col1]] + dt[[col2]])
}

# Create a dataframe to hold the names of new indices and their R-squared values
results <- data.frame(Index = character(), R_squared = numeric(), stringsAsFactors = FALSE)

# Iterate over the pairs of columns to create new indices and calculate R-squared values
for (i in 1:(length(relevant_columns) - 1)) {
  for (j in (i + 1):length(relevant_columns)) {
    col1 <- relevant_columns[i]
    col2 <- relevant_columns[j]
    new_col_name <- paste(col1, col2, sep = "_")
    dt[[new_col_name]] <- calculate_index(col1, col2)
    
    # Calculate the R-squared value
    model <- lm(dt[[new_col_name]] ~ dt$Zn_PXRF_mean, data = dt)
    r_squared <- summary(model)$r.squared
    
    # Add the result to the results dataframe
    results <- rbind(results, data.frame(Index = new_col_name, R_squared = r_squared))
  }
}

# View the results dataframe
print(results)


write.xlsx(results, "Project_P_PLS-cv20-C4_Normalized_Index.xlsx")


#############################these are yet to be analyzed below:

colnames(dt)[149] #here the hyper cols starts 

# Get column names for the relevant columns (149 to 296)
relevant_columns <- names(dt)[149:1192]

# Function to calculate the index for a pair of columns
calculate_index <- function(col1, col2) {
  (dt[[col1]]) / (dt[[col2]])
}

# Create a dataframe to hold the names of new indices and their R-squared values
results <- data.frame(Index = character(), R_squared = numeric(), stringsAsFactors = FALSE)

# Iterate over the pairs of columns to create new indices and calculate R-squared values
for (i in 1:(length(relevant_columns) - 1)) {
  for (j in (i + 1):length(relevant_columns)) {
    col1 <- relevant_columns[i]
    col2 <- relevant_columns[j]
    new_col_name <- paste(col1, col2, sep = "_")
    dt[[new_col_name]] <- calculate_index(col1, col2)
    
    # Calculate the R-squared value
    model <- lm(dt[[new_col_name]] ~ dt$Zn_PXRF_mean, data = dt)
    r_squared <- summary(model)$r.squared
    
    # Add the result to the results dataframe
    results <- rbind(results, data.frame(Index = new_col_name, R_squared = r_squared))
  }
}

# View the results dataframe
print(results)


write.xlsx(results, "Project_P_PLS-cv20-C4_Ratio_Index.xlsx")





colnames(dt)[149] #here the hyper cols starts 

# Get column names for the relevant columns (149 to 296)
relevant_columns <- names(dt)[149:1192]

# Function to calculate the index for a pair of columns
calculate_index <- function(col1, col2) {
  (dt[[col1]]) - (dt[[col2]])
}

# Create a dataframe to hold the names of new indices and their R-squared values
results <- data.frame(Index = character(), R_squared = numeric(), stringsAsFactors = FALSE)

# Iterate over the pairs of columns to create new indices and calculate R-squared values
for (i in 1:(length(relevant_columns) - 1)) {
  for (j in (i + 1):length(relevant_columns)) {
    col1 <- relevant_columns[i]
    col2 <- relevant_columns[j]
    new_col_name <- paste(col1, col2, sep = "_")
    dt[[new_col_name]] <- calculate_index(col1, col2)
    
    # Calculate the R-squared value
    model <- lm(dt[[new_col_name]] ~ dt$Zn_PXRF_mean, data = dt)
    r_squared <- summary(model)$r.squared
    
    # Add the result to the results dataframe
    results <- rbind(results, data.frame(Index = new_col_name, R_squared = r_squared))
  }
}

# View the results dataframe
print(results)


write.xlsx(results, "Project_P_PLS-cv20-C4_difference_Index.xlsx")




}



# PLS cv <20 % and Healthy only
{

setwd("C:/Users/twlodarczyk/OneDrive - University of Arizona/Desktop/All documents/1 PhD/CNRS + Synch/Hyperspectral Research/1_Experiment/1_Experiment_P/Spreadsheet/PLS")
dt <-read.delim("Project_P_pXRF_HP_Hyper.txt")


dt <- dt %>%
  filter(Zn_PXRF_cv < 0.2)

dt <- dt %>%
  filter(Status == "H")


write.xlsx(dt, "Project_P_PLS-cv20-H.xlsx")



# Columns to remove
columns_to_remove <- c("X1903", "X1985", "X1984", "X501", "X1983", "X1904", "X1982", "X678", "X1981", "X1980", "X1905", "X662",
                       "X1979", "X1978", "X1906", "X1976", "X1977", "X1975", "X1907", "X1974", "X1973", "X1972", "X1971", 
                       "X1970", "X1908", "X663", "X1969", "X677", "X1909", "X1968", "X500", "X1967", "X1910", "X1966", 
                       "X1965", "X1911", "X1964", "X1912", "X664", "X1963", "X1962", "X1913", "X1961", "X676", "X1960", 
                       "X1959", "X1958", "X1914", "X1957", "X1915", "X1916", "X665", "X1951", "X1952", "X1956", "X1953", 
                       "X1917", "X1955", "X1954", "X675", "X1918", "X499", "X1950", "X1920", "X1919", "X1949", "X1948", 
                       "X1947", "X1921", "X1946", "X1945", "X1922", "X1944", "X1943", "X1927", "X1928", "X1923", "X1925", 
                       "X1942", "X1924", "X1929", "X1939", "X1926", "X674", "X1930", "X666", "X1941", "X1938", "X1937", 
                       "X1931", "X1936", "X1933", "X1940", "X1932", "X1934", "X1935", "X673", "X498", "X667", "X668", 
                       "X672", "X671", "X669", "X670", "X497", "X496", "X495", "X494", "X493", "X492", "X491", "X490", 
                       "X489", "X488", "X487", "X485", "X486", "X482", "X483", "X479", "X484", "X480", "X478", "X404", 
                       "X481", "X477", "X411", "X400", "X476", "X474", "X465", "X403", "X473", "X466", "X475", "X471", 
                       "X470", "X401", "X464", "X405", "X472", "X412", "X469", "X467", "X406", "X402", "X461", "X463", 
                       "X468", "X462", "X407", "X460", "X458", "X459", "X457", "X452", "X453", "X415", "X456", "X413", 
                       "X454", "X418", "X455", "X414", "X451", "X408", "X410", "X425", "X416", "X419", "X450", "X426", 
                       "X428", "X448", "X421", "X417", "X409", "X445", "X431", "X449", "X422", "X427", "X420", "X437", 
                       "X424", "X446", "X432", "X423", "X429", "X447", "X439", "X444", "X430", "X440", "X436", "X438", 
                       "X433", "X443", "X441", "X442", "X434", "X435")

# Remove the specified columns from the dataset
dt <- dt %>% select(-all_of(columns_to_remove))



#write.xlsx(dt, "Project_P_PLS-cv20-H2.xlsx")


# Columns to remove
columns_to_remove <- c("X1986", "X661", "X1987", "X1988", "X679", "X1989", "X1902", "X1990", "X1991", "X502", 
                       "X1992", "X1993", "X1901", "X1994", "X660", "X1995", "X1996", "X1997", "X2447", "X1998", 
                       "X1999", "X1900", "X2000", "X680", "X2001", "X868", "X867", "X863", "X862", "X864", 
                       "X872", "X866", "X869", "X873", "X861", "X2449", "X865", "X1085", "X2448", "X857", 
                       "X860", "X854", "X874", "X856", "X1083", "X859", "X1084", "X858", "X855", "X871", 
                       "X1080", "X1086", "X870", "X875", "X1082", "X853", "X1079", "X879", "X1081", "X880", 
                       "X2002", "X878", "X659", "X876", "X1078", "X877", "X852", "X881", "X883", "X884", 
                       "X1077", "X850", "X851", "X1087", "X882", "X849", "X1076", "X885", "X887", "X1088", 
                       "X888", "X886", "X1089", "X1074", "X848", "X1073", "X1075", "X2003", "X2446", "X1091", 
                       "X890", "X1090", "X889", "X847", "X1092", "X891", "X1072", "X1093", "X892", "X1071", 
                       "X846", "X2004", "X1094", "X1070", "X1095", "X896", "X2005", "X893", "X1096", "X845", 
                       "X897", "X895", "X1899", "X2438", "X1097", "X844", "X894", "X1069", "X843", "X1098", 
                       "X1099", "X1100", "X898", "X1068", "X842", "X2006", "X840", "X1067", "X901", "X841", 
                       "X902", "X900", "X1101", "X1066", "X903", "X839", "X899", "X1065", "X906", "X907", 
                       "X1102", "X908", "X1063", "X1064", "X2439", "X838", "X909", "X1062", "X905", "X904", 
                       "X1103", "X2007", "X837", "X910", "X1061", "X836", "X1104", "X2441", "X913", "X912", 
                       "X1060", "X835", "X2437", "X917", "X911", "X916", "X1059", "X1105", "X2436", "X918", 
                       "X834", "X1106", "X2008", "X915", "X919", "X914", "X920", "X2440", "X1107", "X1058", 
                       "X921", "X922", "X2009", "X833", "X1108", "X2445", "X503", "X1057", "X830", "X832", 
                       "X1056", "X831", "X1109", "X1054", "X923", "X1055", "X829", "X1898", "X658", "X1053", 
                       "X925", "X2010", "X926", "X828", "X1052", "X924", "X2442", "X1110", "X827", "X2011", 
                       "X1051", "X927", "X826", "X825", "X928", "X1111", "X929", "X2444", "X824", "X823", 
                       "X1721", "X1720", "X1050", "X930", "X1112", "X1722", "X2435", "X1719", "X681", "X933", 
                       "X932", "X1113", "X2012", "X822", "X931", "X1723", "X1114", "X1049", "X821", "X1718", 
                       "X820", "X934", "X819", "X1724", "X1115", "X1048", "X1717", "X818", "X2013", "X1047", 
                       "X1725", "X816", "X1116", "X1042", "X817", "X815", "X1037", "X1036", "X1716", "X1039", 
                       "X1038", "X1043", "X1046", "X814", "X1040", "X1035", "X1726", "X1041", "X1044", "X935", 
                       "X1045", "X813", "X2014", "X1034", "X1727", "X789", "X796", "X1715", "X795", "X792", 
                       "X794", "X1117", "X936", "X793", "X1897", "X790", "X791", "X797", "X801", "X798", 
                       "X799", "X1033", "X802", "X800", "X937", "X1728", "X805", "X788", "X1032", "X807", 
                       "X808", "X804", "X806", "X809", "X1714", "X2443", "X810", "X2425", "X803", "X812", 
                       "X1029", "X1729", "X1031", "X1118", "X811", "X1028", "X787", "X938", "X2426", "X1030", 
                       "X784", "X785", "X2015", "X2016", "X786", "X2430", "X783", "X1730", "X941", "X1713", 
                       "X1027", "X1022", "X2017", "X2429", "X1021", "X940", "X1025", "X942", "X1023", "X657", 
                       "X1026", "X1119", "X782", "X1024", "X939", "X1020", "X2432", "X1731", "X1018", "X781", 
                       "X1019")

# Remove the specified columns from the dataset
dt <- dt %>% select(-all_of(columns_to_remove))




#write.xlsx(dt, "Project_P_PLS-cv20-H3.xlsx")


# Columns to remove
columns_to_remove <- c("X1017", "X2431", "X1016", "X1712", "X1015", "X780", "X1732", "X1120", "X2018", "X1014", 
                       "X1011", "X1012", "X1733", "X1013", "X1004", "X943", "X1003", "X779", "X1005", "X1002", 
                       "X944", "X1001", "X1006", "X1734", "X1010", "X1711", "X1735", "X1007", "X945", "X1121", 
                       "X1008", "X1009", "X778", "X2019", "X947", "X946", "X1122", "X1736", "X1710", "X2020", 
                       "X777", "X2433", "X1123", "X2423", "X2424", "X1896", "X2021", "X948", "X1709", "X1124", 
                       "X2022", "X776", "X1737", "X1125", "X1708", "X2434", "X2422", "X775", "X2023", "X949", 
                       "X1126", "X950", "X656", "X1738", "X1707", "X2024", "X774", "X1691", "X1690", "X951", 
                       "X1706", "X1689", "X1692", "X1127", "X1693", "X1694", "X1688", "X1739", "X1705", "X1695", 
                       "X952", "X1685", "X953", "X1687", "X1686", "X1684", "X1683", "X773", "X1704", "X1696", 
                       "X1128", "X954", "X1697", "X1703", "X2428", "X2025", "X2427", "X1701", "X1682", "X1702", 
                       "X1700", "X1698", "X1699", "X1740", "X2415", "X2421", "X1129", "X2026", "X1681", "X955", 
                       "X1741", "X772", "X957", "X1680", "X2416", "X1679", "X956", "X1677", "X1678", "X1895", 
                       "X1130", "X2027", "X1676", "X1742", "X771", "X1131", "X2419", "X962", "X1675", "X2028", 
                       "X2420", "X963", "X958", "X1743", "X655", "X1674", "X1132", "X959", "X960", "X770", 
                       "X682", "X2029", "X1744", "X969", "X1673", "X2030", "X961", "X2414", "X972", "X970", 
                       "X2412", "X971", "X964", "X967", "X1133", "X966", "X1745", "X968", "X1672", "X965", 
                       "X2405", "X2418", "X982", "X2400", "X2399", "X2398", "X769", "X973", "X504", "X1671", 
                       "X2031", "X2413", "X1746", "X2404", "X979", "X974", "X981", "X994", "X2406", "X2411", 
                       "X987", "X975", "X2417", "X1670", "X997", "X2032", "X1134", "X1747", "X999", "X978", 
                       "X654", "X996", "X986", "X990", "X2397", "X1000", "X768", "X1669", "X985", "X2033", 
                       "X984", "X983", "X976", "X995", "X2403", "X998", "X980", "X977", "X1894", "X1748", 
                       "X1135", "X991", "X1668", "X2410", "X989", "X993", "X988", "X1749", "X2035", "X2034", 
                       "X1667", "X2409", "X1136", "X992", "X767", "X2392", "X1750", "X2401", "X1666", "X2402", 
                       "X2036", "X2391", "X2408", "X2037", "X2407", "X1751", "X1665", "X2254", "X1137", "X1752", 
                       "X2255", "X2253", "X653", "X1664", "X2252", "X2038", "X1753", "X2039", "X2256", "X1663", 
                       "X766", "X2040", "X1138", "X2251", "X1754", "X2041", "X2250", "X2394", "X2257", "X2249", 
                       "X1662", "X1755", "X2247", "X2248", "X2043", "X2396", "X2393", "X1893", "X2246", "X1139", 
                       "X2042", "X1661", "X1756", "X765", "X2044", "X2245", "X2258", "X1660", "X2395", "X1757", 
                       "X1659", "X2244", "X1140", "X1658", "X1758", "X2259", "X652", "X2045", "X2243", "X1657", 
                       "X1759", "X2390", "X2047", "X2241", "X1141", "X2242", "X1656", "X2046", "X764", "X2048", 
                       "X2260", "X1760")

# Remove the specified columns from the dataset
dt <- dt %>% select(-all_of(columns_to_remove))



#write.xlsx(dt, "Project_P_PLS-cv20-H4.xlsx")



# Columns to remove
columns_to_remove <- c("X2240", "X2384", "X1655", "X1654", "X2049", "X1761", "X1653", "X1142", "X2050", "X2239", 
                       "X1652", "X2385", "X2261", "X1762", "X2389", "X2383", "X1892", "X1651", "X1763", "X2388", 
                       "X1143", "X2051", "X763", "X1764", "X2386", "X1650", "X2238", "X2053", "X2262", "X2264", 
                       "X1765", "X651", "X1649", "X1766", "X2382", "X2052", "X2263", "X2265", "X2387", "X1144", 
                       "X2266", "X2237", "X2381", "X2054", "X1767", "X1648", "X683", "X2267", "X1647", "X1646", 
                       "X1768", "X1145", "X762", "X2380", "X1645", "X1769", "X2236", "X1770", "X1644", "X1146", 
                       "X2373", "X1771", "X2235", "X1643", "X2234", "X1772", "X2055", "X2268", "X505", "X1891", 
                       "X2057", "X1773", "X1147", "X1642", "X2233", "X2056", "X2379", "X2058", "X1641", "X1774", 
                       "X2059", "X1148", "X2060", "X2061", "X761", "X1775", "X1640", "X650", "X2232", "X2269", 
                       "X2376", "X1304", "X1776", "X1307", "X2377", "X1303", "X1149", "X2378", "X1639", "X1302", 
                       "X1305", "X1306", "X1308", "X1301", "X2231", "X2062", "X2374", "X2270", "X1638", "X2372", 
                       "X1777", "X1300", "X1309", "X1778", "X2230", "X2063", "X2228", "X2362", "X1637", "X2064", 
                       "X2271", "X1299", "X1779", "X1150", "X2227", "X2229", "X2065", "X1310", "X1636", "X1780", 
                       "X1298", "X1297", "X1799", "X2363", "X2273", "X1798", "X2272", "X1296", "X1800", "X1783", 
                       "X1781", "X1797", "X2226", "X1784", "X1635", "X1782", "X2375", "X1785", "X2274", "X1311", 
                       "X2225", "X1786", "X2224", "X1151", "X1295", "X1818", "X1890", "X2066", "X1787", "X1815", 
                       "X1796", "X1294", "X1634", "X2223", "X1312", "X1817", "X1816", "X1819", "X2281", "X1814", 
                       "X2222", "X2364", "X2277", "X1788", "X2278", "X1812", "X2280", "X1813", "X2279", "X1293", 
                       "X2359", "X1795", "X2221", "X1789", "X760", "X1805", "X1313", "X2275", "X2282", "X1633", 
                       "X1806", "X1820", "X1790", "X2276", "X2067", "X1292", "X1794", "X1803", "X1802", "X1811", 
                       "X1804", "X1291", "X1821", "X1791", "X1801", "X1807", "X1152", "X1808", "X2068", "X1793", 
                       "X1314", "X2283", "X1290", "X1792", "X2370", "X1810", "X1809", "X2369", "X1289", "X1632", 
                       "X2358", "X2361", "X1825", "X1826", "X1822", "X2069", "X1824", "X1827", "X2220", "X1828", 
                       "X1829", "X2371", "X1315", "X1288", "X1830", "X2218", "X1823", "X2284", "X2217", "X1287", 
                       "X2219", "X1831", "X1631", "X2216", "X2367", "X1153", "X1832", "X2215", "X1286", "X2214", 
                       "X1630", "X1839", "X2365", "X1316", "X1838", "X2366", "X2368", "X2070", "X1285", "X2213", 
                       "X1840", "X1629", "X1833", "X1154", "X1284", "X2360", "X2354", "X2071", "X1837", "X1836", 
                       "X2207", "X2072", "X2212", "X1841", "X2073", "X2203", "X1281", "X1283", "X2206", "X1628", 
                       "X2285", "X2202", "X1279", "X1282", "X1280", "X2357", "X1278", "X1317", "X1834", "X1835", 
                       "X1155", "X2209", "X1842", "X2208", "X1627", "X2210", "X1269", "X1889", "X1277", "X2289", 
                       "X2211", "X1268", "X2201", "X2286", "X1275", "X1156")

# Remove the specified columns from the dataset
dt <- dt %>% select(-all_of(columns_to_remove))



write.xlsx(dt, "Project_P_PLS-cv20-H5.xlsx")

# Columns to remove
columns_to_remove <- c("X2290", "X1157", "X1159", "X1274", "X1270", "X1271", "X1276", "X2200", "X2287", "X1158", 
                       "X1264", "X1160", "X1272", "X1265", "X1273", "X2288", "X1626", "X1266", "X1267", "X1263", 
                       "X2075", "X2291", "X1318", "X1161", "X2293", "X2292", "X2074", "X759", "X1262", "X1162", 
                       "X1261", "X1260", "X1843", "X2294", "X2356", "X2199", "X2204", "X2076", "X1625", "X2205", 
                       "X1163", "X1259", "X649", "X2355", "X1258", "X1167", "X1165", "X1164", "X1168", "X1166", 
                       "X1319", "X1844", "X2303", "X1169", "X2304", "X1257", "X2353", "X1845", "X1624", "X2295", 
                       "X1170", "X2198", "X2296", "X2197", "X1846", "X2077", "X2196", "X1171", "X1256", "X1847", 
                       "X2297", "X1623", "X2351", "X1172", "X1320", "X2352", "X1255", "X1252", "X1848", "X2078", 
                       "X1251", "X1173", "X1254", "X2195", "X2298", "X1253", "X1849", "X1174", "X1250", "X2350", 
                       "X1175", "X1249", "X2194", "X2299", "X2300", "X1176", "X1321", "X1248", "X2191", "X2193", 
                       "X2349", "X2192", "X2079", "X2348", "X1622", "X2190", "X2347", "X1177", "X1247", "X2302", 
                       "X2341", "X2301", "X2340", "X2343", "X2189", "X2188", "X2307", "X2080", "X1850", "X1246", 
                       "X2187", "X2342", "X2305", "X2081", "X1621", "X1245", "X1178", "X1322", "X1620", "X2306", 
                       "X1888", "X2186", "X1244", "X2308", "X2082", "X1242", "X1243", "X1851", "X2185", "X1179", 
                       "X1241", "X684", "X2184", "X1619", "X2310", "X2346", "X1852", "X2183", "X1240", "X2311", 
                       "X1618", "X758", "X1180", "X2309", "X1323", "X1617", "X1239", "X2182", "X1181", "X1182", 
                       "X2337", "X2339", "X1238", "X2329", "X2083", "X2344", "X1183", "X2181", "X2084", "X1853", 
                       "X2328", "X2336", "X1616", "X1184", "X1237", "X2180", "X2088", "X1324", "X2085", "X1236", 
                       "X1235", "X1185", "X1234", "X2179", "X2086", "X1233", "X1615", "X1854", "X1186", "X1231", 
                       "X1232", "X2338", "X2330", "X1230", "X2176", "X2331", "X2087", "X2345", "X1614", "X506", 
                       "X1325", "X2089", "X1229", "X2175", "X2178", "X1187", "X2335", "X2314", "X2312", "X2325", 
                       "X1855", "X2324", "X1228", "X2177", "X2174", "X1856", "X2323", "X1188", "X1227", "X1613", 
                       "X2173", "X2315", "X1226", "X2322", "X1189", "X2334", "X2313", "X1887", "X1225", "X1326", 
                       "X2327", "X1857", "X2321", "X2172", "X2326", "X1224", "X2169", "X2332", "X1612", "X2171", 
                       "X1190", "X2168", "X2320", "X1223", "X2170", "X1858", "X2333", "X1222", "X2094", "X2095", 
                       "X2092", "X1191", "X1221", "X1192", "X1611", "X2167", "X1220", "X1219", "X2093", "X757", 
                       "X1218", "X1193", "X1859", "X2166", "X1194", "X1327", "X2319", "X2316", "X1217", "X2318", 
                       "X1610", "X2096", "X2098", "X2317", "X1195", "X2090", "X1216", "X2091", "X1196", "X2165", 
                       "X2099", "X1215", "X1609", "X1209", "X1208", "X1210", "X1207", "X1197", "X2097", "X2100", 
                       "X2161", "X1608", "X1214", "X2164", "X1211", "X1199", "X1198", "X1212", "X1206", "X1213", 
                       "X1200", "X1205", "X1201", "X2101", "X1328", "X1202", "X2163", "X1607", "X2160", "X1204", 
                       "X1860", "X2102", "X2162", "X1203", "X648", "X2103", "X1606", "X2104", "X1605", "X2159", 
                       "X1329", "X2105", "X1861", "X2158", "X1604", "X2154", "X2155", "X1886", "X1862", "X2106")

# Remove the specified columns from the dataset
dt <- dt %>% select(-all_of(columns_to_remove))



write.xlsx(dt, "Project_P_PLS-cv20-H6.xlsx")



# Additional columns to remove
additional_columns_to_remove <- c("X1603", "X2107", "X1330", "X2111", "X1602", "X2157", "X2108", "X2109", "X2112", 
                                  "X2153", "X2110", "X2146", "X1601", "X2156", "X1863", "X2152", "X2145", "X1331", 
                                  "X756", "X1600", "X2151", "X2118", "X2117", "X2113", "X2135", "X2147", "X2136", 
                                  "X2114", "X2139", "X2115", "X2134", "X2116", "X2148", "X1599", "X2119", "X2150", 
                                  "X2140", "X2149", "X2125", "X2133", "X2129", "X2124", "X1864", "X2132", "X1598", 
                                  "X2128", "X2144", "X2138", "X2137", "X1332", "X2143", "X2122", "X2123", "X2131", 
                                  "X1885", "X2130", "X1597", "X1865", "X2142", "X2126", "X2121", "X2120", "X2127", 
                                  "X2141", "X1333", "X1596", "X1866", "X1595", "X1884", "X1594", "X1334", "X1592", 
                                  "X1593", "X1591", "X1867", "X1590", "X1589", "X1883", "X1335", "X1868", "X1588", 
                                  "X755", "X1587", "X1882", "X1869", "X1336", "X1586", "X1585", "X1584", "X647", 
                                  "X1583", "X1881", "X1337", "X1870", "X1582", "X685", "X1871", "X1581", "X1338", 
                                  "X1872", "X1580", "X1578", "X1880", "X1579", "X1577", "X1873", "X1874", "X1576", 
                                  "X1339", "X1575", "X1875", "X1574", "X1879", "X1573", "X1340", "X1572", "X507", 
                                  "X1876", "X1571", "X1878", "X754", "X1877", "X1570", "X1341", "X1569", "X1568", 
                                  "X1567", "X1342", "X1566", "X1565", "X1564", "X1343", "X1563", "X1562", "X1344", 
                                  "X1561", "X1560", "X1345", "X1559", "X1558", "X1346", "X1557", "X1347", "X1556", 
                                  "X1555", "X646", "X753", "X1554", "X1348", "X1553", "X1552", "X1349", "X1551", 
                                  "X1550", "X1350", "X1549", "X1548", "X1351", "X1547", "X1352", "X1353", "X1546", 
                                  "X1545", "X1354", "X1544", "X1543", "X1355", "X1542", "X1541", "X1540", "X1356", 
                                  "X1539", "X752", "X1357", "X1538", "X1358", "X1537", "X1359", "X1536", "X1360", 
                                  "X1535", "X645", "X1361", "X1534", "X1533", "X1362", "X1532", "X686", "X1531", 
                                  "X1363", "X1530", "X1529", "X1364", "X1528", "X1527", "X1365", "X1526", "X1525", 
                                  "X1366", "X1524", "X1523", "X1367", "X751", "X1522", "X1368", "X1521", "X1520", 
                                  "X1369", "X1519", "X508", "X1518", "X1517", "X1370", "X1516", "X1371", "X1515", 
                                  "X1514", "X1372", "X1513", "X1512", "X1511", "X1373", "X1510", "X1509", "X1508", 
                                  "X1374", "X644", "X1507", "X1506", "X1375", "X1505", "X1504", "X1502", "X1503", 
                                  "X1501", "X1500", "X1376", "X1499", "X1498", "X1497", "X750", "X1496", "X1494", 
                                  "X1495", "X1377", "X1493", "X1492", "X1491", "X1490", "X1489", "X1488", "X1487", 
                                  "X1378", "X1482", "X1481", "X1486", "X1484", "X1483", "X1480", "X1485", "X1479", 
                                  "X1474", "X1473", "X1476", "X1475", "X1478", "X1477", "X1472", "X1471", "X1470", 
                                  "X1379", "X1469", "X1468", "X1467", "X1464", "X1466", "X1465", "X1462", "X1463", 
                                  "X1461", "X1460", "X1458", "X1459", "X1457", "X1456", "X1380", "X1455", "X1451", 
                                  "X1429", "X1452", "X1454", "X1428", "X1431", "X1449", "X1430", "X1440", "X1453", 
                                  "X1441", "X1433", "X1432")

# Remove the additional specified columns from the dataset
dt <- dt %>% select(-all_of(additional_columns_to_remove))




#write.xlsx(dt, "Project_P_PLS-cv20-H7.xlsx")




# List of columns to remove
columns_to_remove <- c("X1436", "X1450", "X1439", "X1438", "X1434", "X1448", 
                       "X1443", "X1447", "X1446", "X1435", "X1427", "X1437", 
                       "X1442", "X1444", "X1426", "X1445", "X1381", "X1425", 
                       "X1424", "X1423", "X1422", "X1421", "X1420", "X1382", 
                       "X1419", "X1418", "X1383", "X1417", "X1416", "X1415", 
                       "X1384", "X643", "X1414", "X749", "X1385", "X1413", 
                       "X509", "X687", "X1412", "X1386", "X1411", "X1410", 
                       "X1387", "X1409", "X1408", "X1388", "X1407", "X1389", 
                       "X1406", "X1390", "X1405", "X1391", "X1404", "X1392", 
                       "X1403", "X1393", "X1402", "X1398", "X1394", "X1399", 
                       "X1397", "X1401", "X1400", "X1395", "X1396", "X748", 
                       "X642", "X641", "X510", "X747", "X688", "X640", 
                       "X746", "X639", "X511", "X745", "X638", "X689", 
                       "X637", "X744", "X636", "X512", "X635", "X634", 
                       "X633", "X743", "X632", "X631", "X630", "X629", 
                       "X628", "X627", "X626", "X625", "X513", "X690", 
                       "X624", "X623", "X742", "X622")

# Remove the specified columns from the dataset
dt <- dt %>% select(-all_of(columns_to_remove))






write.xlsx(dt, "Project_P_PLS-cv20-H8.xlsx")



# List of columns to remove (new set only)
new_columns_to_remove <- c("X621", "X620", "X619", "X741", "X514", "X618", 
                           "X617", "X691", "X616", "X740", "X615", "X515", 
                           "X614", "X613", "X739", "X612", "X516", "X692", 
                           "X611", "X610", "X609", "X738", "X608", "X517", 
                           "X607", "X606", "X605", "X604", "X693", "X737", 
                           "X603", "X518", "X602", "X601", "X600", "X599", 
                           "X598", "X597", "X596", "X595", "X594", "X736", 
                           "X593", "X519", "X592", "X694", "X591", "X590", 
                           "X589", "X735", "X520", "X588", "X587", "X586", 
                           "X695", "X585", "X521", "X734", "X584", "X583")

# Remove the specified columns from the dataset
dt <- dt %>% select(-all_of(new_columns_to_remove))


#write.xlsx(dt, "Project_P_PLS-cv20-H9.xlsx")



# List of columns to remove (newest set only)
newest_columns_to_remove <- c("X582", "X522", "X581", "X696", "X733", "X580", 
                              "X579", "X523", "X578", "X577", "X732", "X524", 
                              "X697", "X576", "X525", "X575", "X731", "X698", 
                              "X574", "X526", "X573", "X699", "X572", "X527", 
                              "X730", "X571", "X528", "X700", "X570", "X729")

# Remove the specified columns from the dataset
dt <- dt %>% select(-all_of(newest_columns_to_remove))




#write.xlsx(dt, "Project_P_PLS-cv20-H10.xlsx")


# List of columns to remove (latest set only)
latest_columns_to_remove <- c("X529", "X569", "X701", "X530", "X568", "X531", 
                              "X728", "X702", "X567", "X532", "X566", "X533", 
                              "X703", "X727", "X534", "X565", "X704", "X535", 
                              "X564", "X536", "X726", "X537", "X705", "X563", 
                              "X538", "X562", "X539", "X706", "X540", "X725")

# Remove the specified columns from the dataset
dt <- dt %>% select(-all_of(latest_columns_to_remove))


write.xlsx(dt, "Project_P_PLS-cv20-H11.xlsx")





colnames(dt)[149] #here the hyper cols starts 

# Get column names for the relevant columns (149 to 296)
relevant_columns <- names(dt)[149:187]

# Function to calculate the index for a pair of columns
calculate_index <- function(col1, col2) {
  (dt[[col1]] - dt[[col2]]) / (dt[[col1]] + dt[[col2]])
}

# Create a dataframe to hold the names of new indices and their R-squared values
results <- data.frame(Index = character(), R_squared = numeric(), stringsAsFactors = FALSE)

# Iterate over the pairs of columns to create new indices and calculate R-squared values
for (i in 1:(length(relevant_columns) - 1)) {
  for (j in (i + 1):length(relevant_columns)) {
    col1 <- relevant_columns[i]
    col2 <- relevant_columns[j]
    new_col_name <- paste(col1, col2, sep = "_")
    dt[[new_col_name]] <- calculate_index(col1, col2)
    
    # Calculate the R-squared value
    model <- lm(dt[[new_col_name]] ~ dt$Zn_PXRF_mean, data = dt)
    r_squared <- summary(model)$r.squared
    
    # Add the result to the results dataframe
    results <- rbind(results, data.frame(Index = new_col_name, R_squared = r_squared))
  }
}

# View the results dataframe
print(results)


write.xlsx(results, "Project_P_PLS-cv20-H11_Normalized_Index.xlsx")


#############################these are yet to be analyzed below:

colnames(dt)[149] #here the hyper cols starts 

# Get column names for the relevant columns (149 to 296)
relevant_columns <- names(dt)[149:187]

# Function to calculate the index for a pair of columns
calculate_index <- function(col1, col2) {
  (dt[[col1]]) / (dt[[col2]])
}

# Create a dataframe to hold the names of new indices and their R-squared values
results <- data.frame(Index = character(), R_squared = numeric(), stringsAsFactors = FALSE)

# Iterate over the pairs of columns to create new indices and calculate R-squared values
for (i in 1:(length(relevant_columns) - 1)) {
  for (j in (i + 1):length(relevant_columns)) {
    col1 <- relevant_columns[i]
    col2 <- relevant_columns[j]
    new_col_name <- paste(col1, col2, sep = "_")
    dt[[new_col_name]] <- calculate_index(col1, col2)
    
    # Calculate the R-squared value
    model <- lm(dt[[new_col_name]] ~ dt$Zn_PXRF_mean, data = dt)
    r_squared <- summary(model)$r.squared
    
    # Add the result to the results dataframe
    results <- rbind(results, data.frame(Index = new_col_name, R_squared = r_squared))
  }
}

# View the results dataframe
print(results)


write.xlsx(results, "Project_P_PLS-cv20-H11_Ratio_Index.xlsx")





colnames(dt)[149] #here the hyper cols starts 

# Get column names for the relevant columns (149 to 296)
relevant_columns <- names(dt)[149:187]

# Function to calculate the index for a pair of columns
calculate_index <- function(col1, col2) {
  (dt[[col1]]) - (dt[[col2]])
}

# Create a dataframe to hold the names of new indices and their R-squared values
results <- data.frame(Index = character(), R_squared = numeric(), stringsAsFactors = FALSE)

# Iterate over the pairs of columns to create new indices and calculate R-squared values
for (i in 1:(length(relevant_columns) - 1)) {
  for (j in (i + 1):length(relevant_columns)) {
    col1 <- relevant_columns[i]
    col2 <- relevant_columns[j]
    new_col_name <- paste(col1, col2, sep = "_")
    dt[[new_col_name]] <- calculate_index(col1, col2)
    
    # Calculate the R-squared value
    model <- lm(dt[[new_col_name]] ~ dt$Zn_PXRF_mean, data = dt)
    r_squared <- summary(model)$r.squared
    
    # Add the result to the results dataframe
    results <- rbind(results, data.frame(Index = new_col_name, R_squared = r_squared))
  }
}

# View the results dataframe
print(results)


#write.xlsx(results, "Project_P_PLS-cv20-H11_difference_Index.xlsx")

}

